<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>안전한 상품 상세</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-4">
        <div class="alert alert-success" role="alert">
            <h4 class="alert-heading">상품 상세 페이지</h4>
            <p>이 페이지는 안전하게 작동합니다!</p>
        </div>
        
        <div class="card">
            <div class="card-header">
                <h3>상품 정보</h3>
            </div>
            <div class="card-body">
                <h5 class="card-title">
                    상품명: <span th:text="${productName}" th:if="${productName}">기본 상품명</span>
                    <span th:unless="${productName}">상품명 없음</span>
                </h5>
                
                <p class="card-text">
                    상품번호: <span th:text="${productNo}" th:if="${productNo}">0</span>
                    <span th:unless="${productNo}">번호 없음</span>
                </p>
                
                <p class="card-text">
                    가격: <span th:text="${productPrice}" th:if="${productPrice}">0</span>
                    <span th:unless="${productPrice}">0</span>원
                </p>
                
                <p class="card-text">
                    설명: <span th:text="${productDescription}" th:if="${productDescription}">설명 없음</span>
                    <span th:unless="${productDescription}">설명 없음</span>
                </p>
                
                <div class="mt-3">
                    <div class="d-grid gap-2 d-md-flex mb-3">
                        <button type="button" class="btn btn-outline-primary flex-fill" 
                                th:onclick="'addToCart(' + ${productNo} + ')'">
                            <i class="fas fa-shopping-cart me-1"></i>장바구니 담기
                        </button>
                        <!-- <button type="button" class="btn btn-primary flex-fill"
                                th:onclick="'buyNow(' + ${productNo} + ')'">
                            <i class="fas fa-credit-card me-1"></i>바로 구매
                        </button> -->
                    </div>
                    
                    <a href="/products" class="btn btn-secondary me-2">목록으로</a>
                    <a href="/safe/test" class="btn btn-outline-secondary">테스트 페이지</a>
                </div>
            </div>
        </div>
        
        <div class="mt-3">
            <small class="text-muted">안전한 버전의 상품 상세 페이지입니다.</small>
        </div>
    </div>
    
    <script>
        function addToCart(productNo) {
            if (confirm('상품을 장바구니에 추가하시겠습니까?')) {
                window.location.href = '/cart/add?productNo=' + productNo + '&quantity=1';
            }
        }
        
        function buyNow(productNo) {
            if (confirm('상품을 바로 구매하시겠습니까?')) {
                window.location.href = '/cart/add?productNo=' + productNo + '&quantity=1&direct=true';
            }
        }
    </script>
</body>
</html>
