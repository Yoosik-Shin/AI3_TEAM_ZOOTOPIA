<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>글쓰기</title>
    <link rel="stylesheet" th:href="@{/css/create.css}">
</head>
<body>

<div class="container">
    <form th:action="@{/posts/create}" method="post" enctype="multipart/form-data">

        <!-- 카테고리 -->
        <div class="form-group category-buttons">
            <label>카테고리</label><br>
            <input type="radio" id="cate1" name="category" value="질문글" checked>
            <label for="cate1">질문있어요</label>
            <input type="radio" id="cate2" name="category" value="자유글">
            <label for="cate2">자유게시판</label>
        </div>

        <!-- 제목 -->
        <div class="form-group">
            <label for="title">글 제목</label>
            <input type="text" id="title" name="title" placeholder="반려동물 자랑 제목을 입력해 주세요">
        </div>

        <!-- 내용 -->
        <div class="form-group">
            <label for="content">글 작성</label>
            <textarea id="content" name="content" rows="7" placeholder="5글자 이상으로 작성해 주세요"></textarea>
        </div>

        <!-- 사진 업로드 -->
        <div class="form-group">
            <label>사진 업로드</label>
            <div class="upload-box">
                <label for="image">📷 사진첨부</label>
                <input type="file" id="image" name="imageFiles" multiple accept="image/*" onchange="previewImages(event)">
            </div>

            <!-- 썸네일 미리보기 영역 -->
            <div id="imagePreviewContainer" class="preview-container">
                <!-- JS로 이미지 썸네일 + 대표 이미지 선택 라디오 버튼이 들어감 -->
            </div>
        </div>

        <!-- 동영상 업로드 -->
        <div class="form-group">
            <label>동영상 업로드</label>
            <div class="upload-box">
                <label for="video">🎬 동영상 첨부</label>
                <input type="file" id="video" name="videoFile">
            </div>
        </div>

        <!-- 등록 버튼 -->
        <div class="form-group text-right">
            <button type="submit" class="btn-submit">글 등록</button>
        </div>

    </form>
</div>


<script>
function previewImages(event) {
    const container = document.getElementById('imagePreviewContainer');
    container.innerHTML = ''; // 초기화

    const files = event.target.files;

    if (files.length === 0) return;

    [...files].forEach((file, idx) => {
        const reader = new FileReader();
        reader.onload = function (e) {
            const wrapper = document.createElement('div');
            wrapper.classList.add('preview-item');

            wrapper.innerHTML = `
                <img src="${e.target.result}" width="100" height="100" alt="preview">
                <div>
                    <label>
                        <input type="radio" name="thumbnailIndex" value="${idx}" ${idx === 0 ? 'checked' : ''}>
                        대표 이미지
                    </label>
                </div>
            `;
            container.appendChild(wrapper);
        };
        reader.readAsDataURL(file);
    });
}
</script>

</body>
</html>
