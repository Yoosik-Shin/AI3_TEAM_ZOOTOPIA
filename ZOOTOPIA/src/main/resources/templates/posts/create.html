<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>ê¸€ì“°ê¸°</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" th:href="@{/css/create.css}">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@yaireo/tagify/dist/tagify.css">
</head>
<body>

<div class="container">
  <form th:action="@{/posts/create}" method="post" enctype="multipart/form-data">

    <!-- ì¹´í…Œê³ ë¦¬ -->
    <label>ì¹´í…Œê³ ë¦¬</label>
    <div class="form-group category-buttons d-flex gap-3">
      <div class="form-check ps-0">
        <input class="form-check-input" type="radio" id="cate2" name="category" value="ììœ ê¸€" checked>
        <label class="form-check-label" for="cate2">ììœ ê²Œì‹œíŒ</label>
      </div>
      <div class="form-check ps-0">
        <input class="form-check-input" type="radio" id="cate1" name="category" value="ì§ˆë¬¸ê¸€">
        <label class="form-check-label" for="cate1">ì§ˆë¬¸ìˆì–´ìš”</label>
      </div>
    </div>

    <!-- ì œëª© -->
    <div class="form-group">
      <label for="title">ê¸€ ì œëª©</label>
      <input type="text" id="title" name="title" placeholder="ì œëª©ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”" class="form-control">
    </div>

    <!-- ë‚´ìš© -->
    <div class="form-group">
      <label for="content">ê¸€ ì‘ì„±</label>
      <textarea id="content" name="content" rows="7" placeholder="5ê¸€ì ì´ìƒìœ¼ë¡œ ì‘ì„±í•´ ì£¼ì„¸ìš”" class="form-control"></textarea>
    </div>

    <!-- íƒœê·¸ -->
    <div class="form-group">
      <label for="tags">#íƒœê·¸</label>
      <input type="text" id="tags" name="tags" class="form-control"
             placeholder="íƒœê·¸ë¥¼ ì…ë ¥í•˜ê³  Enter ë˜ëŠ” ì‰¼í‘œ(,)ë¡œ êµ¬ë¶„í•˜ì„¸ìš”"
             th:value="${post?.tags}"> <!-- ìˆ˜ì • í™”ë©´ì—ì„œë„ ì‚¬ìš© ê°€ëŠ¥ -->
    </div>

    <!-- ì‚¬ì§„ ì—…ë¡œë“œ -->
    <div class="form-group">
      <label>ì‚¬ì§„ ì—…ë¡œë“œ</label>
      <div class="upload-box">
        <label for="image">ğŸ“· ì‚¬ì§„ì²¨ë¶€</label>
        <input type="file" id="image" name="imageFiles" multiple accept="image/*" onchange="previewImages(event)">
      </div>

      <div id="imagePreviewContainer" class="preview-container">
        <!-- ì¸ë„¤ì¼ ë¯¸ë¦¬ë³´ê¸° -->
      </div>
    </div>

    <!-- ë™ì˜ìƒ ì—…ë¡œë“œ -->
    <div class="form-group">
      <label>ë™ì˜ìƒ ì—…ë¡œë“œ</label>
      <div class="upload-box d-flex align">
        <label for="video">ğŸ¬ ë™ì˜ìƒ ì²¨ë¶€</label>
        <input type="file" id="video" name="videoFile">
      </div>
    </div>

    <!-- ë“±ë¡ ë²„íŠ¼ -->
    <div class="form-group text-right mt-3">
      <button type="submit" class="btn btn-primary">ê¸€ ë“±ë¡</button>
    </div>

  </form>
</div>

<!-- ìŠ¤í¬ë¦½íŠ¸ -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@yaireo/tagify"></script>

<script>
  const input = document.querySelector('#tags');
  const tagify = new Tagify(input, {
    originalInputValueFormat: values => values.map(tag => tag.value).join(',')
  });

  // ê¸°ì¡´ ê°’ ìˆìœ¼ë©´ íƒœê·¸ë¡œ ë³€í™˜ (ì¤‘ë³µ ë°©ì§€)
  if (input.value) {
    tagify.removeAllTags();
    tagify.addTags(input.value.split(',').map(tag => tag.trim()));
  }

  // Enter í‚¤ë¡œ form submit ë˜ëŠ” ë¬¸ì œ ë°©ì§€
  input.addEventListener('keydown', function (e) {
    if (e.key === 'Enter' && !e.isComposing) {
      e.preventDefault(); // ğŸš« Enterë¡œ submit ë°©ì§€
    }
  });

  // ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸°
  function previewImages(event) {
    const container = document.getElementById('imagePreviewContainer');
    container.innerHTML = '';
    const files = event.target.files;

    if (!files || files.length === 0) return;

    [...files].forEach((file, idx) => {
      const reader = new FileReader();
      reader.onload = function (e) {
        const wrapper = document.createElement('div');
        wrapper.classList.add('preview-item');
        wrapper.innerHTML = `
          <img src="${e.target.result}" width="100" height="100" alt="preview">
          <div>
            <label>
              <input type="radio" name="thumbnailIndex" value="${idx}" ${idx === 0 ? 'checked' : ''}>
              ëŒ€í‘œ ì´ë¯¸ì§€
            </label>
          </div>
        `;
        container.appendChild(wrapper);
      };
      reader.readAsDataURL(file);
    });
  }
</script>

</body>
</html>
