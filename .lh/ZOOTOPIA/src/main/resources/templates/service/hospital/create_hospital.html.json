{
    "sourceFile": "ZOOTOPIA/src/main/resources/templates/service/hospital/create_hospital.html",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 33,
            "patches": [
                {
                    "date": 1751903779627,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1751985867377,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,146 +1,306 @@\n-<!DOCTYPE html>\n-<html lang=\"ko\" xmlns:th=\"http://www.thymeleaf.org\" xmlns:sec=\"http://www.thymeleaf.org/thymeleaf-extras-springsecurity5\">\n-<head>\n-    <meta charset=\"UTF-8\">\n-    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n-    <title>병원 등록</title>\n-    <!-- Bootstrap CSS -->\n-    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\">\n-    <!-- Font Awesome CSS -->\n-    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css\">\n-    <link rel=\"stylesheet\" th:href=\"@{/css/hospital_style.css}\">\n-</head>\n-<body>\n-    <th:block th:replace=\"~{/fragments/header :: header}\"></th:block>\n-    <div class=\"hospital-main-container\">\n-        <!-- 상단 로고 -->\n-        <div class=\"logo-container\">\n-            <div class=\"logo\">\n-                <img th:src=\"@{/img/hosp_logo.png}\" alt=\"병원 아이콘\" class=\"logo-icon\">\n-            </div>\n-        </div>\n-\n-        <!-- 메인 컨텐츠 -->\n-        <div class=\"main-content\">\n-            <form th:action=\"${hospitalForm.hospitalId == null ? '/hospitals/new' : '/hospitals/edit'}\" method=\"post\" th:object=\"${hospitalForm}\" enctype=\"multipart/form-data\">\n-                <input type=\"hidden\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" />\n-                <div class=\"form-container\">\n-                    <div class=\"image-upload-section\">\n-                        <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n-                                <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n-                            </div>\n-                            <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" style=\"display: none;\" onchange=\"previewImage(event)\">\n-                    </div>\n-\n-                <div class=\"form-section\">\n-\n-                        <div class=\"form-group\">\n-                            <label for=\"name\">병원 이름</label>\n-                            <input type=\"text\" id=\"name\" th:field=\"*{name}\" placeholder=\"병원 이름을 작성하세요\" required>\n-                        </div>\n-\n-                        <div class=\"form-group\">\n-                            <label>진료 과목</label>\n-                            <div class=\"checkbox-group\">\n-                                <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n-                                    <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\n-                                    <label th:for=\"'spec-' + ${spec.specialtyId}\" th:text=\"${spec.category}\"></label>\n-                                </div>\n-                            </div>\n-                        </div>\n-\n-                        <div class=\"form-group\">\n-                            <label>진료 가능 동물</label>\n-                            <div class=\"checkbox-group\">\n-                                <div th:each=\"animal : ${animalList}\" class=\"checkbox-item\">\n-                                    <input type=\"checkbox\" th:field=\"*{animalIds}\" th:value=\"${animal.animalId}\" th:id=\"'animal-' + ${animal.animalId}\">\n-                                    <label th:for=\"'animal-' + ${animal.animalId}\" th:text=\"${animal.species}\"></label>\n-                                </div>\n-                            </div>\n-                        </div>\n-\n-                        <div class=\"form-group\">\n-                            <label for=\"address\">병원 주소</label>\n-                            <input type=\"text\" id=\"address\" th:field=\"*{address}\" placeholder=\"주소를 입력해 주세요\" required>\n-                        </div>\n-\n-                        <div class=\"form-group\">\n-                            <label for=\"homepage\">홈페이지</label>\n-                            <input type=\"url\" id=\"homepage\" th:field=\"*{homepage}\" placeholder=\"홈페이지 주소를 입력해 주세요\">\n-                        </div>\n-\n-                        <div class=\"form-group\">\n-                            <label for=\"phone\">대표번호</label>\n-                            <input type=\"tel\" id=\"phone\" th:field=\"*{phone}\" placeholder=\"병원 전화번호를 입력하세요\" required>\n-                        </div>\n-\n-                        <div class=\"form-group\">\n-                            <label for=\"email\">이메일</label>\n-                            <input type=\"email\" id=\"email\" th:field=\"*{email}\" placeholder=\"이메일 주소를 입력하세요\">\n-                        </div>\n-\n-                        <div class=\"form-group\">\n-                            <label>카테고리</label>\n-                            <div class=\"category-group\">\n-                                <label class=\"category-item\">\n-                                    <input type=\"checkbox\" name=\"category\" value=\"포유류\">\n-                                    <span>포유류</span>\n-                                </label>\n-                                <label class=\"category-item\">\n-                                    <input type=\"checkbox\" name=\"category\" value=\"파충류\">\n-                                    <span>파충류</span>\n-                                </label>\n-                                <label class=\"category-item\">\n-                                    <input type=\"checkbox\" name=\"category\" value=\"조류\">\n-                                    <span>조류</span>\n-                                </label>\n-                                <label class=\"category-item\">\n-                                    <input type=\"checkbox\" name=\"category\" value=\"절지류\">\n-                                    <span>절지류</span>\n-                                </label>\n-                                <label class=\"category-item\">\n-                                    <input type=\"checkbox\" name=\"category\" value=\"설치류\">\n-                                    <span>설치류</span>\n-                                </label>\n-                            </div>\n-                        </div>\n-\n-                        <div class=\"button-group\">\n-                            <button type=\"button\" class=\"btn btn-cancel\" onclick=\"history.back()\">취소하기</button>\n-                            <button type=\"submit\" class=\"btn btn-submit\" th:text=\"${hospitalForm.hospitalId != null ? '수정하기' : '등록하기'}\"></button>\n-                        </div>\n-                    </form>\n-\n-                    <div sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">\n-                        <form th:action=\"@{/hospitals/delete/{id}(id=${hospitalForm.hospitalId})}\" method=\"post\" onsubmit=\"return confirm('정말로 이 병원을 삭제하시겠습니까?');\" style=\"margin-top: 10px;\">\n-                            <input type=\"hidden\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" />\n-                            <button type=\"submit\" class=\"btn btn-danger\">삭제하기</button>\n-                        </form>\n-                    </div>\n-                </div>\n-            </div>\n-        </div>\n-    </div>\n-\n-\n-<script>\n-  function previewImage(event) {\n-    const input = event.target;\n-    const reader = new FileReader();\n-\n-    reader.onload = function () {\n-      const preview = document.getElementById('preview');\n-      preview.src = reader.result;\n-    };\n-\n-    if (input.files && input.files[0]) {\n-      reader.readAsDataURL(input.files[0]);\n-    }\n-  }\n-</script>\n-\n-\n-    <th:block th:replace=\"~{/fragments/footer :: footer}\"></th:block>\n-    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q\" crossorigin=\"anonymous\"></script>\n-</body>\n+<!DOCTYPE html>\r\n+<html lang=\"ko\" xmlns:th=\"http://www.thymeleaf.org\" xmlns:sec=\"http://www.thymeleaf.org/thymeleaf-extras-springsecurity5\">\r\n+<head>\r\n+    <meta charset=\"UTF-8\">\r\n+    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n+    <meta name=\"_csrf\" th:content=\"${_csrf.token}\" />\r\n+    <meta name=\"_csrf_header\" th:content=\"${_csrf.headerName}\" />\r\n+\r\n+    <title>병원 등록</title>\r\n+    <!-- Bootstrap CSS -->\r\n+    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\">\r\n+    <!-- Font Awesome CSS -->\r\n+    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css\">\r\n+    <link rel=\"stylesheet\" th:href=\"@{/css/hospital_style.css}\">\r\n+</head>\r\n+<body>\r\n+    <th:block th:replace=\"~{/fragments/header :: header}\"></th:block>\r\n+    <div class=\"hospital-main-container\">\r\n+        <!-- 상단 로고 -->\r\n+        <div class=\"logo-container\">\r\n+            <div class=\"logo\">\r\n+                <img th:src=\"@{/img/hosp_logo.png}\" alt=\"병원 아이콘\" class=\"logo-icon\">\r\n+            </div>\r\n+        </div>\r\n+\r\n+        <!-- 메인 컨텐츠 -->\r\n+        <div class=\"main-content\">\r\n+                        <!-- Hidden form for multipart file upload  잼민이버전-->\r\n+            <!-- <form id=\"fileUploadForm\" style=\"display: none;\" enctype=\"multipart/form-data\">\r\n+                <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" onchange=\"previewImage(event)\">\r\n+            </form> -->\r\n+\r\n+            <!-- 채찍피티 버전 -->\r\n+            <div class=\"d-flex justify-content-around align-items-start gap-20\">\r\n+\r\n+                <form id=\"imageForm\" enctype=\"multipart/form-data\">\r\n+                    <div class=\"image-upload-section\">\r\n+                        <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\r\n+                            <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\r\n+                        </div>\r\n+                        <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" style=\"display: none;\" onchange=\"previewImage(event)\">\r\n+                    </div>\r\n+                </form>\r\n+\r\n+\r\n+                <!-- Main form for general data -->\r\n+                <form id=\"generalDataForm\" th:object=\"${hospitalForm}\">\r\n+                    <input type=\"hidden\" id=\"hospitalId\" th:field=\"*{hospitalId}\" />\r\n+                    <!-- <input type=\"hidden\" id=\"csrfTokenGeneral\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" /> -->\r\n+\r\n+                    <div class=\"form-container\">\r\n+                        <!-- <div class=\"image-upload-section\">\r\n+                            <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\r\n+                                <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\r\n+                            </div>\r\n+                        </div> -->\r\n+\r\n+                        <div class=\"form-section\">\r\n+                            <div class=\"form-group\">\r\n+                                <label for=\"name\">병원 이름</label>\r\n+                                <input type=\"text\" id=\"name\" th:field=\"*{name}\" placeholder=\"병원 이름을 작성하세요\" required>\r\n+                            </div>\r\n+\r\n+                            <!-- <div class=\"form-group\">\r\n+                                <label>진료 과목</label>\r\n+                                <div class=\"checkbox-group\">\r\n+                                    <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\r\n+                                        <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\r\n+                                        <label th:for=\"'spec-' + ${spec.specialtyId}\" th:text=\"${spec.category}\"></label>\r\n+                                    </div>\r\n+                                    <input type=\"text\" id=\"specialty\" placeholder=\"진료 과목을 입력하세요\" required>\r\n+                                </div>\r\n+                            </div> -->\r\n+\r\n+                            <div class=\"form-group\">\r\n+                                <label for=\"address\">병원 주소</label>\r\n+                                <input type=\"text\" id=\"address\" th:field=\"*{address}\" placeholder=\"주소를 입력해 주세요\" required>\r\n+                            </div>\r\n+\r\n+                            <div class=\"form-group\">\r\n+                                <label for=\"homepage\">홈페이지</label>\r\n+                                <input type=\"url\" id=\"homepage\" th:field=\"*{homepage}\" placeholder=\"홈페이지 주소를 입력해 주세요\">\r\n+                            </div>\r\n+\r\n+                            <div class=\"form-group\">\r\n+                                <label for=\"phone\">대표번호</label>\r\n+                                <input type=\"tel\" id=\"phone\" th:field=\"*{phone}\" placeholder=\"병원 전화번호를 입력하세요\" required>\r\n+                            </div>\r\n+\r\n+                            <!-- <div class=\"form-group\">\r\n+                                <label for=\"email\">이메일</label>\r\n+                                <input type=\"email\" id=\"email\" th:field=\"*{email}\" placeholder=\"이메일 주소를 입력하세요\">\r\n+                            </div> -->\r\n+                            <div class=\"form-group\">\r\n+                                <label for=\"hosp-introduce\">병원 소개</label>\r\n+                                <input type=\"textarea\" id=\"hosp-introduce\" th:field=\"*{email}\" placeholder=\"간단한 소개글을 작성해 주세요\" required>\r\n+                            </div>\r\n+\r\n+                            <div class=\"form-group\">\r\n+                                <label>카테고리</label>\r\n+                                <div class=\"category-group\">\r\n+                                    <label class=\"category-item\">\r\n+                                        <input type=\"checkbox\" name=\"category\" value=\"포유류\">\r\n+                                        <span>포유류</span>\r\n+                                    </label>\r\n+                                    <label class=\"category-item\">\r\n+                                        <input type=\"checkbox\" name=\"category\" value=\"파충류\">\r\n+                                        <span>파충류</span>\r\n+                                    </label>\r\n+                                    <label class=\"category-item\">\r\n+                                        <input type=\"checkbox\" name=\"category\" value=\"조류\">\r\n+                                        <span>조류</span>\r\n+                                    </label>\r\n+                                    <label class=\"category-item\">\r\n+                                        <input type=\"checkbox\" name=\"category\" value=\"절지류\">\r\n+                                        <span>절지류</span>\r\n+                                    </label>\r\n+                                    <label class=\"category-item\">\r\n+                                        <input type=\"checkbox\" name=\"category\" value=\"설치류\">\r\n+                                        <span>설치류</span>\r\n+                                    </label>\r\n+                                </div>\r\n+                            </div>\r\n+\r\n+                            <div class=\"button-group\">\r\n+                                <button type=\"button\" class=\"btn btn-cancel\" onclick=\"history.back()\">취소하기</button>\r\n+                                <button type=\"button\" id=\"submitAllBtn\" class=\"btn btn-submit\" th:text=\"${hospitalForm.hospitalId != null ? '수정하기' : '등록하기'}\"></button>\r\n+                            </div>\r\n+                        </div>\r\n+                    </div>\r\n+                </form>\r\n+            </div>\r\n+\r\n+                    <div sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">\r\n+                        <form th:action=\"@{/hospitals/delete/{id}(id=${hospitalForm.hospitalId})}\" method=\"post\" onsubmit=\"return confirm('정말로 이 병원을 삭제하시겠습니까?');\" style=\"margin-top: 10px;\">\r\n+                            <input type=\"hidden\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" />\r\n+                            <button type=\"submit\" class=\"btn btn-danger\">삭제하기</button>\r\n+                        </form>\r\n+                    </div>\r\n+                </div>\r\n+            </div>\r\n+        </div>\r\n+    </div>\r\n+\r\n+\r\n+<script>\r\n+  function previewImage(event) {\r\n+    const input = event.target;\r\n+    const reader = new FileReader();\r\n+\r\n+    reader.onload = function () {\r\n+      const preview = document.getElementById('preview');\r\n+      preview.src = reader.result;\r\n+    };\r\n+\r\n+    if (input.files && input.files[0]) {\r\n+      reader.readAsDataURL(input.files[0]);\r\n+    }\r\n+  }\r\n+\r\n+\r\n+  // 채찍피티 버전\r\n+    document.addEventListener('DOMContentLoaded', function () {\r\n+        const submitAllBtn = document.getElementById('submitAllBtn');\r\n+        const imageForm = document.getElementById('imageForm');\r\n+        const generalDataForm = document.getElementById('generalDataForm');\r\n+        // const hospitalId = '[[${hospitalForm.hospitalId}]]';\r\n+        const hospitalId = document.getElementById('hospitalId')?.value;\r\n+        const isNew = !hospitalId || hospitalId === 'null' || hospitalId === '';\r\n+\r\n+        const csrfToken = document.querySelector('meta[name=\"_csrf\"]').content;\r\n+        const csrfHeader = document.querySelector('meta[name=\"_csrf_header\"]').content;\r\n+\r\n+        submitAllBtn.addEventListener('click', async function (event) {\r\n+            event.preventDefault();\r\n+\r\n+            const formData = new FormData();\r\n+\r\n+            // 1. 일반 입력값 병합\r\n+            const generalFormData = new FormData(generalDataForm);\r\n+            for (const [key, value] of generalFormData.entries()) {\r\n+                formData.append(key, value);\r\n+            }\r\n+\r\n+            // 2. 이미지 파일 업로드 및 URL 병합\r\n+            const imageFileInput = imageForm.querySelector('#fileInput');\r\n+            if (imageFileInput && imageFileInput.files.length > 0) {\r\n+                const imageUploadFormData = new FormData();\r\n+                imageUploadFormData.append('image', imageFileInput.files[0]);\r\n+\r\n+                try {\r\n+                    const uploadResponse = await fetch('/upload/image', {\r\n+                        method: 'POST',\r\n+                        headers: {\r\n+                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\r\n+                        },\r\n+                        body: imageUploadFormData\r\n+                    });\r\n+\r\n+                    if (uploadResponse.ok) {\r\n+                        const uploadResult = await uploadResponse.json();\r\n+                        if (uploadResult.success === 1) {\r\n+                            formData.append('thumbnailImageUrl', uploadResult.imageUrl);\r\n+                        } else {\r\n+                            alert('이미지 업로드 실패: ' + uploadResult.message);\r\n+                            return; // 이미지 업로드 실패 시 전체 제출 중단\r\n+                        }\r\n+                    } else {\r\n+                        const errorText = await uploadResponse.text();\r\n+                        console.error('이미지 업로드 실패:', errorText);\r\n+                        alert('이미지 업로드를 실패하였습니다.');\r\n+                        return; // 이미지 업로드 실패 시 전체 제출 중단\r\n+                    }\r\n+                } catch (error) {\r\n+                    console.error('이미지 업로드 중 오류:', error);\r\n+                    alert('이미지 업로드 중 오류가 발생했습니다.');\r\n+                    return; // 이미지 업로드 실패 시 전체 제출 중단\r\n+                }\r\n+            }\r\n+\r\n+            // 3. 전송\r\n+            const actionUrl = isNew ? '/hospitals/new' : '/hospitals/edit';\r\n+\r\n+            try {\r\n+                const response = await fetch(actionUrl, {\r\n+                    method: 'POST',\r\n+                    headers: {\r\n+                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\r\n+                        },\r\n+                    body: formData\r\n+                });\r\n+\r\n+                if (response.ok) {\r\n+                    const result = await response.json();\r\n+                    alert('병원 정보가 성공적으로 제출되었습니다!');\r\n+                    window.location.href = '/hospitals';\r\n+                } else {\r\n+                    const errorText = await response.text();\r\n+                    console.error('제출 실패:', errorText);\r\n+                    alert('제출에 실패했습니다: ' + errorText);\r\n+                }\r\n+            } catch (error) {\r\n+                console.error('제출 중 오류:', error);\r\n+                alert('제출 중 오류가 발생했습니다.');\r\n+            }\r\n+        });\r\n+    });\r\n+\r\n+\r\n+\r\n+\r\n+\r\n+\r\n+\r\n+\r\n+\r\n+\r\n+  // 잼민이 버전\r\n+//   document.addEventListener('DOMContentLoaded', function() {\r\n+//     const submitAllBtn = document.getElementById('submitAllBtn');\r\n+//     const generalDataForm = document.getElementById('generalDataForm');\r\n+//     const fileUploadForm = document.getElementById('fileUploadForm'); // fileUploadForm 참조 추가\r\n+//     const hospitalId = '[[${hospitalForm.hospitalId}]]'; // Thymeleaf 변수 사용\r\n+\r\n+//     submitAllBtn.addEventListener('click', async function(event) {\r\n+//       event.preventDefault(); // 기본 폼 제출 방지\r\n+\r\n+//       const formData = new FormData(generalDataForm); // generalDataForm의 데이터로 FormData 초기화\r\n+//       const fileInput = fileUploadForm.querySelector('#fileInput'); // fileUploadForm에서 fileInput 가져오기\r\n+//       if (fileInput && fileInput.files && fileInput.files[0]) {\r\n+//         formData.append('thumbnailImageFile', fileInput.files[0]);\r\n+//       }\r\n+\r\n+//       // 폼 액션 URL 결정\r\n+//       const actionUrl = hospitalId === 'null' ? '/hospitals/new' : '/hospitals/edit';\r\n+\r\n+//       try {\r\n+//         const response = await fetch(actionUrl, {\r\n+//                                                     method: 'POST',\r\n+//                                                     body: formData\r\n+//                                                 });\r\n+\r\n+//         if (response.ok) {\r\n+//           const result = await response.json(); // 또는 response.text()\r\n+//           console.log('Submission successful:', result);\r\n+//           alert('병원 정보가 성공적으로 제출되었습니다!');\r\n+//           // 성공 후 리다이렉트 또는 다른 작업 수행\r\n+//           window.location.href = '/hospitals'; // 예시: 병원 목록 페이지로 이동\r\n+//         } else {\r\n+//           const errorText = await response.text();\r\n+//           console.error('Submission failed:', response.status, errorText);\r\n+//           alert('병원 정보 제출에 실패했습니다: ' + errorText);\r\n+//         }\r\n+//       } catch (error) {\r\n+//         console.error('Error during submission:', error);\r\n+//         alert('병원 정보 제출 중 오류가 발생했습니다.');\r\n+//       }\r\n+//     });\r\n+//   });\r\n+</script>\r\n+\r\n+\r\n+    <th:block th:replace=\"~{/fragments/footer :: footer}\"></th:block>\r\n+    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q\" crossorigin=\"anonymous\"></script>\r\n+</body>\r\n </html>\n\\ No newline at end of file\n"
                },
                {
                    "date": 1751986335455,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,306 +1,307 @@\n-<!DOCTYPE html>\r\n-<html lang=\"ko\" xmlns:th=\"http://www.thymeleaf.org\" xmlns:sec=\"http://www.thymeleaf.org/thymeleaf-extras-springsecurity5\">\r\n-<head>\r\n-    <meta charset=\"UTF-8\">\r\n-    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n-    <meta name=\"_csrf\" th:content=\"${_csrf.token}\" />\r\n-    <meta name=\"_csrf_header\" th:content=\"${_csrf.headerName}\" />\r\n-\r\n-    <title>병원 등록</title>\r\n-    <!-- Bootstrap CSS -->\r\n-    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\">\r\n-    <!-- Font Awesome CSS -->\r\n-    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css\">\r\n-    <link rel=\"stylesheet\" th:href=\"@{/css/hospital_style.css}\">\r\n-</head>\r\n-<body>\r\n-    <th:block th:replace=\"~{/fragments/header :: header}\"></th:block>\r\n-    <div class=\"hospital-main-container\">\r\n-        <!-- 상단 로고 -->\r\n-        <div class=\"logo-container\">\r\n-            <div class=\"logo\">\r\n-                <img th:src=\"@{/img/hosp_logo.png}\" alt=\"병원 아이콘\" class=\"logo-icon\">\r\n-            </div>\r\n-        </div>\r\n-\r\n-        <!-- 메인 컨텐츠 -->\r\n-        <div class=\"main-content\">\r\n-                        <!-- Hidden form for multipart file upload  잼민이버전-->\r\n-            <!-- <form id=\"fileUploadForm\" style=\"display: none;\" enctype=\"multipart/form-data\">\r\n-                <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" onchange=\"previewImage(event)\">\r\n-            </form> -->\r\n-\r\n-            <!-- 채찍피티 버전 -->\r\n-            <div class=\"d-flex justify-content-around align-items-start gap-20\">\r\n-\r\n-                <form id=\"imageForm\" enctype=\"multipart/form-data\">\r\n-                    <div class=\"image-upload-section\">\r\n-                        <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\r\n-                            <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\r\n-                        </div>\r\n-                        <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" style=\"display: none;\" onchange=\"previewImage(event)\">\r\n-                    </div>\r\n-                </form>\r\n-\r\n-\r\n-                <!-- Main form for general data -->\r\n-                <form id=\"generalDataForm\" th:object=\"${hospitalForm}\">\r\n-                    <input type=\"hidden\" id=\"hospitalId\" th:field=\"*{hospitalId}\" />\r\n-                    <!-- <input type=\"hidden\" id=\"csrfTokenGeneral\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" /> -->\r\n-\r\n-                    <div class=\"form-container\">\r\n-                        <!-- <div class=\"image-upload-section\">\r\n-                            <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\r\n-                                <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\r\n-                            </div>\r\n-                        </div> -->\r\n-\r\n-                        <div class=\"form-section\">\r\n-                            <div class=\"form-group\">\r\n-                                <label for=\"name\">병원 이름</label>\r\n-                                <input type=\"text\" id=\"name\" th:field=\"*{name}\" placeholder=\"병원 이름을 작성하세요\" required>\r\n-                            </div>\r\n-\r\n-                            <!-- <div class=\"form-group\">\r\n-                                <label>진료 과목</label>\r\n-                                <div class=\"checkbox-group\">\r\n-                                    <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\r\n-                                        <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\r\n-                                        <label th:for=\"'spec-' + ${spec.specialtyId}\" th:text=\"${spec.category}\"></label>\r\n-                                    </div>\r\n-                                    <input type=\"text\" id=\"specialty\" placeholder=\"진료 과목을 입력하세요\" required>\r\n-                                </div>\r\n-                            </div> -->\r\n-\r\n-                            <div class=\"form-group\">\r\n-                                <label for=\"address\">병원 주소</label>\r\n-                                <input type=\"text\" id=\"address\" th:field=\"*{address}\" placeholder=\"주소를 입력해 주세요\" required>\r\n-                            </div>\r\n-\r\n-                            <div class=\"form-group\">\r\n-                                <label for=\"homepage\">홈페이지</label>\r\n-                                <input type=\"url\" id=\"homepage\" th:field=\"*{homepage}\" placeholder=\"홈페이지 주소를 입력해 주세요\">\r\n-                            </div>\r\n-\r\n-                            <div class=\"form-group\">\r\n-                                <label for=\"phone\">대표번호</label>\r\n-                                <input type=\"tel\" id=\"phone\" th:field=\"*{phone}\" placeholder=\"병원 전화번호를 입력하세요\" required>\r\n-                            </div>\r\n-\r\n-                            <!-- <div class=\"form-group\">\r\n-                                <label for=\"email\">이메일</label>\r\n-                                <input type=\"email\" id=\"email\" th:field=\"*{email}\" placeholder=\"이메일 주소를 입력하세요\">\r\n-                            </div> -->\r\n-                            <div class=\"form-group\">\r\n-                                <label for=\"hosp-introduce\">병원 소개</label>\r\n-                                <input type=\"textarea\" id=\"hosp-introduce\" th:field=\"*{email}\" placeholder=\"간단한 소개글을 작성해 주세요\" required>\r\n-                            </div>\r\n-\r\n-                            <div class=\"form-group\">\r\n-                                <label>카테고리</label>\r\n-                                <div class=\"category-group\">\r\n-                                    <label class=\"category-item\">\r\n-                                        <input type=\"checkbox\" name=\"category\" value=\"포유류\">\r\n-                                        <span>포유류</span>\r\n-                                    </label>\r\n-                                    <label class=\"category-item\">\r\n-                                        <input type=\"checkbox\" name=\"category\" value=\"파충류\">\r\n-                                        <span>파충류</span>\r\n-                                    </label>\r\n-                                    <label class=\"category-item\">\r\n-                                        <input type=\"checkbox\" name=\"category\" value=\"조류\">\r\n-                                        <span>조류</span>\r\n-                                    </label>\r\n-                                    <label class=\"category-item\">\r\n-                                        <input type=\"checkbox\" name=\"category\" value=\"절지류\">\r\n-                                        <span>절지류</span>\r\n-                                    </label>\r\n-                                    <label class=\"category-item\">\r\n-                                        <input type=\"checkbox\" name=\"category\" value=\"설치류\">\r\n-                                        <span>설치류</span>\r\n-                                    </label>\r\n-                                </div>\r\n-                            </div>\r\n-\r\n-                            <div class=\"button-group\">\r\n-                                <button type=\"button\" class=\"btn btn-cancel\" onclick=\"history.back()\">취소하기</button>\r\n-                                <button type=\"button\" id=\"submitAllBtn\" class=\"btn btn-submit\" th:text=\"${hospitalForm.hospitalId != null ? '수정하기' : '등록하기'}\"></button>\r\n-                            </div>\r\n-                        </div>\r\n-                    </div>\r\n-                </form>\r\n-            </div>\r\n-\r\n-                    <div sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">\r\n-                        <form th:action=\"@{/hospitals/delete/{id}(id=${hospitalForm.hospitalId})}\" method=\"post\" onsubmit=\"return confirm('정말로 이 병원을 삭제하시겠습니까?');\" style=\"margin-top: 10px;\">\r\n-                            <input type=\"hidden\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" />\r\n-                            <button type=\"submit\" class=\"btn btn-danger\">삭제하기</button>\r\n-                        </form>\r\n-                    </div>\r\n-                </div>\r\n-            </div>\r\n-        </div>\r\n-    </div>\r\n-\r\n-\r\n-<script>\r\n-  function previewImage(event) {\r\n-    const input = event.target;\r\n-    const reader = new FileReader();\r\n-\r\n-    reader.onload = function () {\r\n-      const preview = document.getElementById('preview');\r\n-      preview.src = reader.result;\r\n-    };\r\n-\r\n-    if (input.files && input.files[0]) {\r\n-      reader.readAsDataURL(input.files[0]);\r\n-    }\r\n-  }\r\n-\r\n-\r\n-  // 채찍피티 버전\r\n-    document.addEventListener('DOMContentLoaded', function () {\r\n-        const submitAllBtn = document.getElementById('submitAllBtn');\r\n-        const imageForm = document.getElementById('imageForm');\r\n-        const generalDataForm = document.getElementById('generalDataForm');\r\n-        // const hospitalId = '[[${hospitalForm.hospitalId}]]';\r\n-        const hospitalId = document.getElementById('hospitalId')?.value;\r\n-        const isNew = !hospitalId || hospitalId === 'null' || hospitalId === '';\r\n-\r\n-        const csrfToken = document.querySelector('meta[name=\"_csrf\"]').content;\r\n-        const csrfHeader = document.querySelector('meta[name=\"_csrf_header\"]').content;\r\n-\r\n-        submitAllBtn.addEventListener('click', async function (event) {\r\n-            event.preventDefault();\r\n-\r\n-            const formData = new FormData();\r\n-\r\n-            // 1. 일반 입력값 병합\r\n-            const generalFormData = new FormData(generalDataForm);\r\n-            for (const [key, value] of generalFormData.entries()) {\r\n-                formData.append(key, value);\r\n-            }\r\n-\r\n-            // 2. 이미지 파일 업로드 및 URL 병합\r\n-            const imageFileInput = imageForm.querySelector('#fileInput');\r\n-            if (imageFileInput && imageFileInput.files.length > 0) {\r\n-                const imageUploadFormData = new FormData();\r\n-                imageUploadFormData.append('image', imageFileInput.files[0]);\r\n-\r\n-                try {\r\n-                    const uploadResponse = await fetch('/upload/image', {\r\n-                        method: 'POST',\r\n-                        headers: {\r\n-                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\r\n-                        },\r\n-                        body: imageUploadFormData\r\n-                    });\r\n-\r\n-                    if (uploadResponse.ok) {\r\n-                        const uploadResult = await uploadResponse.json();\r\n-                        if (uploadResult.success === 1) {\r\n-                            formData.append('thumbnailImageUrl', uploadResult.imageUrl);\r\n-                        } else {\r\n-                            alert('이미지 업로드 실패: ' + uploadResult.message);\r\n-                            return; // 이미지 업로드 실패 시 전체 제출 중단\r\n-                        }\r\n-                    } else {\r\n-                        const errorText = await uploadResponse.text();\r\n-                        console.error('이미지 업로드 실패:', errorText);\r\n-                        alert('이미지 업로드를 실패하였습니다.');\r\n-                        return; // 이미지 업로드 실패 시 전체 제출 중단\r\n-                    }\r\n-                } catch (error) {\r\n-                    console.error('이미지 업로드 중 오류:', error);\r\n-                    alert('이미지 업로드 중 오류가 발생했습니다.');\r\n-                    return; // 이미지 업로드 실패 시 전체 제출 중단\r\n-                }\r\n-            }\r\n-\r\n-            // 3. 전송\r\n-            const actionUrl = isNew ? '/hospitals/new' : '/hospitals/edit';\r\n-\r\n-            try {\r\n-                const response = await fetch(actionUrl, {\r\n-                    method: 'POST',\r\n-                    headers: {\r\n-                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\r\n-                        },\r\n-                    body: formData\r\n-                });\r\n-\r\n-                if (response.ok) {\r\n-                    const result = await response.json();\r\n-                    alert('병원 정보가 성공적으로 제출되었습니다!');\r\n-                    window.location.href = '/hospitals';\r\n-                } else {\r\n-                    const errorText = await response.text();\r\n-                    console.error('제출 실패:', errorText);\r\n-                    alert('제출에 실패했습니다: ' + errorText);\r\n-                }\r\n-            } catch (error) {\r\n-                console.error('제출 중 오류:', error);\r\n-                alert('제출 중 오류가 발생했습니다.');\r\n-            }\r\n-        });\r\n-    });\r\n-\r\n-\r\n-\r\n-\r\n-\r\n-\r\n-\r\n-\r\n-\r\n-\r\n-  // 잼민이 버전\r\n-//   document.addEventListener('DOMContentLoaded', function() {\r\n-//     const submitAllBtn = document.getElementById('submitAllBtn');\r\n-//     const generalDataForm = document.getElementById('generalDataForm');\r\n-//     const fileUploadForm = document.getElementById('fileUploadForm'); // fileUploadForm 참조 추가\r\n-//     const hospitalId = '[[${hospitalForm.hospitalId}]]'; // Thymeleaf 변수 사용\r\n-\r\n-//     submitAllBtn.addEventListener('click', async function(event) {\r\n-//       event.preventDefault(); // 기본 폼 제출 방지\r\n-\r\n-//       const formData = new FormData(generalDataForm); // generalDataForm의 데이터로 FormData 초기화\r\n-//       const fileInput = fileUploadForm.querySelector('#fileInput'); // fileUploadForm에서 fileInput 가져오기\r\n-//       if (fileInput && fileInput.files && fileInput.files[0]) {\r\n-//         formData.append('thumbnailImageFile', fileInput.files[0]);\r\n-//       }\r\n-\r\n-//       // 폼 액션 URL 결정\r\n-//       const actionUrl = hospitalId === 'null' ? '/hospitals/new' : '/hospitals/edit';\r\n-\r\n-//       try {\r\n-//         const response = await fetch(actionUrl, {\r\n-//                                                     method: 'POST',\r\n-//                                                     body: formData\r\n-//                                                 });\r\n-\r\n-//         if (response.ok) {\r\n-//           const result = await response.json(); // 또는 response.text()\r\n-//           console.log('Submission successful:', result);\r\n-//           alert('병원 정보가 성공적으로 제출되었습니다!');\r\n-//           // 성공 후 리다이렉트 또는 다른 작업 수행\r\n-//           window.location.href = '/hospitals'; // 예시: 병원 목록 페이지로 이동\r\n-//         } else {\r\n-//           const errorText = await response.text();\r\n-//           console.error('Submission failed:', response.status, errorText);\r\n-//           alert('병원 정보 제출에 실패했습니다: ' + errorText);\r\n-//         }\r\n-//       } catch (error) {\r\n-//         console.error('Error during submission:', error);\r\n-//         alert('병원 정보 제출 중 오류가 발생했습니다.');\r\n-//       }\r\n-//     });\r\n-//   });\r\n-</script>\r\n-\r\n-\r\n-    <th:block th:replace=\"~{/fragments/footer :: footer}\"></th:block>\r\n-    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q\" crossorigin=\"anonymous\"></script>\r\n-</body>\r\n+<!DOCTYPE html>\n+<html lang=\"ko\" xmlns:th=\"http://www.thymeleaf.org\" xmlns:sec=\"http://www.thymeleaf.org/thymeleaf-extras-springsecurity5\">\n+<head>\n+    <meta charset=\"UTF-8\">\n+    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n+    <meta name=\"_csrf\" th:content=\"${_csrf.token}\" />\n+    <meta name=\"_csrf_header\" th:content=\"${_csrf.headerName}\" />\n+\n+    <title>병원 등록</title>\n+    <!-- Bootstrap CSS -->\n+    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\">\n+    <!-- Font Awesome CSS -->\n+    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css\">\n+    <link rel=\"stylesheet\" th:href=\"@{/css/hospital_style.css}\">\n+</head>\n+<body>\n+    <th:block th:replace=\"~{/fragments/header :: header}\"></th:block>\n+    <div class=\"hospital-main-container\">\n+        <!-- 상단 로고 -->\n+        <div class=\"logo-container\">\n+            <div class=\"logo\">\n+                <img th:src=\"@{/img/hosp_logo.png}\" alt=\"병원 아이콘\" class=\"logo-icon\">\n+            </div>\n+        </div>\n+\n+        <!-- 메인 컨텐츠 -->\n+        <div class=\"main-content\">\n+                        <!-- Hidden form for multipart file upload  잼민이버전-->\n+            <!-- <form id=\"fileUploadForm\" style=\"display: none;\" enctype=\"multipart/form-data\">\n+                <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" onchange=\"previewImage(event)\">\n+            </form> -->\n+\n+            <!-- 채찍피티 버전 -->\n+            <div class=\"d-flex justify-content-around align-items-start gap-20\">\n+\n+                <form id=\"imageForm\" enctype=\"multipart/form-data\">\n+                    <div class=\"image-upload-section\">\n+                        <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n+                            <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n+                        </div>\n+                        <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" style=\"display: none;\" onchange=\"previewImage(event)\">\n+                    </div>\n+                </form>\n+\n+\n+                <!-- Main form for general data -->\n+                <form id=\"generalDataForm\" th:object=\"${hospitalForm}\">\n+                    <input type=\"hidden\" id=\"hospitalId\" th:field=\"*{hospitalId}\" />\n+                    <!-- <input type=\"hidden\" id=\"csrfTokenGeneral\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" /> -->\n+\n+                    <div class=\"form-container\">\n+                        <!-- <div class=\"image-upload-section\">\n+                            <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n+                                <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n+                            </div>\n+                        </div> -->\n+\n+                        <div class=\"form-section\">\n+                            <div class=\"form-group\">\n+                                <label for=\"name\">병원 이름</label>\n+                                <input type=\"text\" id=\"name\" th:field=\"*{name}\" placeholder=\"병원 이름을 작성하세요\" required>\n+                            </div>\n+\n+                            <!-- <div class=\"form-group\">\n+                                <label>진료 과목</label>\n+                                <div class=\"checkbox-group\">\n+                                    <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n+                                        <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\n+                                        <label th:for=\"'spec-' + ${spec.specialtyId}\" th:text=\"${spec.category}\"></label>\n+                                    </div>\n+                                    <input type=\"text\" id=\"specialty\" placeholder=\"진료 과목을 입력하세요\" required>\n+                                </div>\n+                            </div> -->\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"address\">병원 주소</label>\n+                                <input type=\"text\" id=\"address\" th:field=\"*{address}\" placeholder=\"주소를 입력해 주세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"homepage\">홈페이지</label>\n+                                <input type=\"url\" id=\"homepage\" th:field=\"*{homepage}\" placeholder=\"홈페이지 주소를 입력해 주세요\">\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"phone\">대표번호</label>\n+                                <input type=\"tel\" id=\"phone\" th:field=\"*{phone}\" placeholder=\"병원 전화번호를 입력하세요\" required>\n+                            </div>\n+\n+                            <!-- <div class=\"form-group\">\n+                                <label for=\"email\">이메일</label>\n+                                <input type=\"email\" id=\"email\" th:field=\"*{email}\" placeholder=\"이메일 주소를 입력하세요\">\n+                            </div> -->\n+                            <div class=\"form-group\">\n+                                <label for=\"hosp-introduce\">병원 소개</label>\n+                                <input type=\"textarea\" id=\"hosp-introduce\" th:field=\"*{email}\" placeholder=\"간단한 소개글을 작성해 주세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label>카테고리</label>\n+                                <div class=\"category-group\">\n+                                    <label class=\"category-item\">\n+                                        <input type=\"checkbox\" name=\"category\" value=\"포유류\">\n+                                        <span>포유류</span>\n+                                    </label>\n+                                    <label class=\"category-item\">\n+                                        <input type=\"checkbox\" name=\"category\" value=\"파충류\">\n+                                        <span>파충류</span>\n+                                    </label>\n+                                    <label class=\"category-item\">\n+                                        <input type=\"checkbox\" name=\"category\" value=\"조류\">\n+                                        <span>조류</span>\n+                                    </label>\n+                                    <label class=\"category-item\">\n+                                        <input type=\"checkbox\" name=\"category\" value=\"절지류\">\n+                                        <span>절지류</span>\n+                                    </label>\n+                                    <label class=\"category-item\">\n+                                        <input type=\"checkbox\" name=\"category\" value=\"설치류\">\n+                                        <span>설치류</span>\n+                                    </label>\n+                                </div>\n+                            </div>\n+\n+                            </div>\n+                        </div>\n+                    </div>\n+                </form>\n+            </div>\n+\n+                <!-- 삭제 form -->\n+                <div sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">\n+                    <form id=\"deleteForm\" th:action=\"@{/hospitals/delete/{id}(id=${hospitalForm.hospitalId})}\" method=\"post\" style=\"display: none;\">\n+                        <input type=\"hidden\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" />\n+                    </form>\n+                </div>\n+\n+                <!-- 버튼 그룹 -->\n+                <div class=\"button-group\" style=\"text-align: center; margin-top: 20px;\">\n+                    <button type=\"button\" class=\"btn btn-cancel\" onclick=\"history.back()\">취소하기</button>\n+                    <button type=\"button\" id=\"submitAllBtn\" class=\"btn btn-submit\" th:text=\"${hospitalForm.hospitalId != null ? '수정하기' : '등록하기'}\"></button>\n+                    <button sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\" type=\"button\" id=\"deleteBtn\" class=\"btn btn-danger\">삭제하기</button>\n+                </div>\n+            </div>\n+\n+\n+<script>\n+  function previewImage(event) {\n+    const input = event.target;\n+    const reader = new FileReader();\n+\n+    reader.onload = function () {\n+      const preview = document.getElementById('preview');\n+      preview.src = reader.result;\n+    };\n+\n+    if (input.files && input.files[0]) {\n+      reader.readAsDataURL(input.files[0]);\n+    }\n+  }\n+\n+\n+  // 채찍피티 버전\n+    document.addEventListener('DOMContentLoaded', function () {\n+        const submitAllBtn = document.getElementById('submitAllBtn');\n+        const imageForm = document.getElementById('imageForm');\n+        const generalDataForm = document.getElementById('generalDataForm');\n+        // const hospitalId = '[[${hospitalForm.hospitalId}]]';\n+        const hospitalId = document.getElementById('hospitalId')?.value;\n+        const isNew = !hospitalId || hospitalId === 'null' || hospitalId === '';\n+\n+        const csrfToken = document.querySelector('meta[name=\"_csrf\"]').content;\n+        const csrfHeader = document.querySelector('meta[name=\"_csrf_header\"]').content;\n+\n+        submitAllBtn.addEventListener('click', async function (event) {\n+            event.preventDefault();\n+\n+            const formData = new FormData();\n+\n+            // 1. 일반 입력값 병합\n+            const generalFormData = new FormData(generalDataForm);\n+            for (const [key, value] of generalFormData.entries()) {\n+                formData.append(key, value);\n+            }\n+\n+            // 2. 이미지 파일 업로드 및 URL 병합\n+            const imageFileInput = imageForm.querySelector('#fileInput');\n+            if (imageFileInput && imageFileInput.files.length > 0) {\n+                const imageUploadFormData = new FormData();\n+                imageUploadFormData.append('image', imageFileInput.files[0]);\n+\n+                try {\n+                    const uploadResponse = await fetch('/upload/image', {\n+                        method: 'POST',\n+                        headers: {\n+                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n+                        },\n+                        body: imageUploadFormData\n+                    });\n+\n+                    if (uploadResponse.ok) {\n+                        const uploadResult = await uploadResponse.json();\n+                        if (uploadResult.success === 1) {\n+                            formData.append('thumbnailImageUrl', uploadResult.imageUrl);\n+                        } else {\n+                            alert('이미지 업로드 실패: ' + uploadResult.message);\n+                            return; // 이미지 업로드 실패 시 전체 제출 중단\n+                        }\n+                    } else {\n+                        const errorText = await uploadResponse.text();\n+                        console.error('이미지 업로드 실패:', errorText);\n+                        alert('이미지 업로드를 실패하였습니다.');\n+                        return; // 이미지 업로드 실패 시 전체 제출 중단\n+                    }\n+                } catch (error) {\n+                    console.error('이미지 업로드 중 오류:', error);\n+                    alert('이미지 업로드 중 오류가 발생했습니다.');\n+                    return; // 이미지 업로드 실패 시 전체 제출 중단\n+                }\n+            }\n+\n+            // 3. 전송\n+            const actionUrl = isNew ? '/hospitals/new' : '/hospitals/edit';\n+\n+            try {\n+                const response = await fetch(actionUrl, {\n+                    method: 'POST',\n+                    headers: {\n+                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n+                        },\n+                    body: formData\n+                });\n+\n+                if (response.ok) {\n+                    const result = await response.json();\n+                    alert('병원 정보가 성공적으로 제출되었습니다!');\n+                    window.location.href = '/hospitals';\n+                } else {\n+                    const errorText = await response.text();\n+                    console.error('제출 실패:', errorText);\n+                    alert('제출에 실패했습니다: ' + errorText);\n+                }\n+            } catch (error) {\n+                console.error('제출 중 오류:', error);\n+                alert('제출 중 오류가 발생했습니다.');\n+            }\n+        });\n+    });\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+  // 잼민이 버전\n+//   document.addEventListener('DOMContentLoaded', function() {\n+//     const submitAllBtn = document.getElementById('submitAllBtn');\n+//     const generalDataForm = document.getElementById('generalDataForm');\n+//     const fileUploadForm = document.getElementById('fileUploadForm'); // fileUploadForm 참조 추가\n+//     const hospitalId = '[[${hospitalForm.hospitalId}]]'; // Thymeleaf 변수 사용\n+\n+//     submitAllBtn.addEventListener('click', async function(event) {\n+//       event.preventDefault(); // 기본 폼 제출 방지\n+\n+//       const formData = new FormData(generalDataForm); // generalDataForm의 데이터로 FormData 초기화\n+//       const fileInput = fileUploadForm.querySelector('#fileInput'); // fileUploadForm에서 fileInput 가져오기\n+//       if (fileInput && fileInput.files && fileInput.files[0]) {\n+//         formData.append('thumbnailImageFile', fileInput.files[0]);\n+//       }\n+\n+//       // 폼 액션 URL 결정\n+//       const actionUrl = hospitalId === 'null' ? '/hospitals/new' : '/hospitals/edit';\n+\n+//       try {\n+//         const response = await fetch(actionUrl, {\n+//                                                     method: 'POST',\n+//                                                     body: formData\n+//                                                 });\n+\n+//         if (response.ok) {\n+//           const result = await response.json(); // 또는 response.text()\n+//           console.log('Submission successful:', result);\n+//           alert('병원 정보가 성공적으로 제출되었습니다!');\n+//           // 성공 후 리다이렉트 또는 다른 작업 수행\n+//           window.location.href = '/hospitals'; // 예시: 병원 목록 페이지로 이동\n+//         } else {\n+//           const errorText = await response.text();\n+//           console.error('Submission failed:', response.status, errorText);\n+//           alert('병원 정보 제출에 실패했습니다: ' + errorText);\n+//         }\n+//       } catch (error) {\n+//         console.error('Error during submission:', error);\n+//         alert('병원 정보 제출 중 오류가 발생했습니다.');\n+//       }\n+//     });\n+//   });\n+</script>\n+\n+\n+    <th:block th:replace=\"~{/fragments/footer :: footer}\"></th:block>\n+    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q\" crossorigin=\"anonymous\"></script>\n+</body>\n </html>\n\\ No newline at end of file\n"
                },
                {
                    "date": 1751986476484,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -92,9 +92,9 @@\n                                 <input type=\"email\" id=\"email\" th:field=\"*{email}\" placeholder=\"이메일 주소를 입력하세요\">\n                             </div> -->\n                             <div class=\"form-group\">\n                                 <label for=\"hosp-introduce\">병원 소개</label>\n-                                <input type=\"textarea\" id=\"hosp-introduce\" th:field=\"*{email}\" placeholder=\"간단한 소개글을 작성해 주세요\" required>\n+                                <textarea type=\"textarea\" id=\"hosp-introduce\" th:field=\"*{email}\" placeholder=\"간단한 소개글을 작성해 주세요\" required rows=\"4\" style=\"resize: none;\"></textarea>\n                             </div>\n \n                             <div class=\"form-group\">\n                                 <label>카테고리</label>\n@@ -127,22 +127,22 @@\n                     </div>\n                 </form>\n             </div>\n \n-                <!-- 삭제 form -->\n-                <div sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">\n-                    <form id=\"deleteForm\" th:action=\"@{/hospitals/delete/{id}(id=${hospitalForm.hospitalId})}\" method=\"post\" style=\"display: none;\">\n-                        <input type=\"hidden\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" />\n-                    </form>\n-                </div>\n+            <!-- 삭제 form -->\n+            <div sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">\n+                <form id=\"deleteForm\" th:action=\"@{/hospitals/delete/{id}(id=${hospitalForm.hospitalId})}\" method=\"post\" style=\"display: none;\">\n+                    <input type=\"hidden\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" />\n+                </form>\n+            </div>\n \n-                <!-- 버튼 그룹 -->\n-                <div class=\"button-group\" style=\"text-align: center; margin-top: 20px;\">\n-                    <button type=\"button\" class=\"btn btn-cancel\" onclick=\"history.back()\">취소하기</button>\n-                    <button type=\"button\" id=\"submitAllBtn\" class=\"btn btn-submit\" th:text=\"${hospitalForm.hospitalId != null ? '수정하기' : '등록하기'}\"></button>\n-                    <button sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\" type=\"button\" id=\"deleteBtn\" class=\"btn btn-danger\">삭제하기</button>\n-                </div>\n+            <!-- 버튼 그룹 -->\n+            <div class=\"button-group\" style=\"text-align: center; margin-top: 20px;\">\n+                <button type=\"button\" class=\"btn btn-cancel\" onclick=\"history.back()\">취소하기</button>\n+                <button type=\"button\" id=\"submitAllBtn\" class=\"btn btn-submit\" th:text=\"${hospitalForm.hospitalId != null ? '수정하기' : '등록하기'}\"></button>\n+                <button sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\" type=\"button\" id=\"deleteBtn\" class=\"btn btn-danger\">삭제하기</button>\n             </div>\n+        </div>\n \n \n <script>\n   function previewImage(event) {\n"
                },
                {
                    "date": 1751987143116,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -134,13 +134,12 @@\n                     <input type=\"hidden\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" />\n                 </form>\n             </div>\n \n-            <!-- 버튼 그룹 -->\n-            <div class=\"button-group\" style=\"text-align: center; margin-top: 20px;\">\n-                <button type=\"button\" class=\"btn btn-cancel\" onclick=\"history.back()\">취소하기</button>\n-                <button type=\"button\" id=\"submitAllBtn\" class=\"btn btn-submit\" th:text=\"${hospitalForm.hospitalId != null ? '수정하기' : '등록하기'}\"></button>\n-                <button sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\" type=\"button\" id=\"deleteBtn\" class=\"btn btn-danger\">삭제하기</button>\n+            <div class=\"d-flex justify-content-center gap-2 mt-4\">\n+                <button type=\"button\" class=\"btn btn-secondary\" onclick=\"history.back()\">취소</button>\n+                <button type=\"button\" id=\"submitAllBtn\" class=\"btn btn-primary\" th:text=\"${hospitalForm.hospitalId != null ? '수정' : '등록'}\"></button>\n+                <button type=\"button\" id=\"deleteBtn\" class=\"btn btn-danger\" sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">삭제</button>\n             </div>\n         </div>\n \n \n@@ -171,8 +170,17 @@\n \n         const csrfToken = document.querySelector('meta[name=\"_csrf\"]').content;\n         const csrfHeader = document.querySelector('meta[name=\"_csrf_header\"]').content;\n \n+        const deleteBtn = document.getElementById('deleteBtn');\n+        if (deleteBtn) {\n+            deleteBtn.addEventListener('click', function() {\n+                if (confirm('정말로 이 병원을 삭제하시겠습니까?')) {\n+                    document.getElementById('deleteForm').submit();\n+                }\n+            });\n+        }\n+\n         submitAllBtn.addEventListener('click', async function (event) {\n             event.preventDefault();\n \n             const formData = new FormData();\n"
                },
                {
                    "date": 1751987255014,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -92,9 +92,9 @@\n                                 <input type=\"email\" id=\"email\" th:field=\"*{email}\" placeholder=\"이메일 주소를 입력하세요\">\n                             </div> -->\n                             <div class=\"form-group\">\n                                 <label for=\"hosp-introduce\">병원 소개</label>\n-                                <textarea type=\"textarea\" id=\"hosp-introduce\" th:field=\"*{email}\" placeholder=\"간단한 소개글을 작성해 주세요\" required rows=\"4\" style=\"resize: none;\"></textarea>\n+                                <textarea type=\"text\" id=\"hosp-introduce\" th:field=\"*{email}\" placeholder=\"간단한 소개글을 작성해 주세요\" required rows=\"4\" style=\"resize: none;\"></textarea>\n                             </div>\n \n                             <div class=\"form-group\">\n                                 <label>카테고리</label>\n"
                },
                {
                    "date": 1751987575723,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -60,19 +60,8 @@\n                                 <label for=\"name\">병원 이름</label>\n                                 <input type=\"text\" id=\"name\" th:field=\"*{name}\" placeholder=\"병원 이름을 작성하세요\" required>\n                             </div>\n \n-                            <!-- <div class=\"form-group\">\n-                                <label>진료 과목</label>\n-                                <div class=\"checkbox-group\">\n-                                    <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n-                                        <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\n-                                        <label th:for=\"'spec-' + ${spec.specialtyId}\" th:text=\"${spec.category}\"></label>\n-                                    </div>\n-                                    <input type=\"text\" id=\"specialty\" placeholder=\"진료 과목을 입력하세요\" required>\n-                                </div>\n-                            </div> -->\n-\n                             <div class=\"form-group\">\n                                 <label for=\"address\">병원 주소</label>\n                                 <input type=\"text\" id=\"address\" th:field=\"*{address}\" placeholder=\"주소를 입력해 주세요\" required>\n                             </div>\n@@ -95,8 +84,19 @@\n                                 <label for=\"hosp-introduce\">병원 소개</label>\n                                 <textarea type=\"text\" id=\"hosp-introduce\" th:field=\"*{email}\" placeholder=\"간단한 소개글을 작성해 주세요\" required rows=\"4\" style=\"resize: none;\"></textarea>\n                             </div>\n \n+                            <!-- <div class=\"form-group\">\n+                                <label>진료 과목</label>\n+                                <div class=\"checkbox-group\">\n+                                    <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n+                                        <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\n+                                        <label th:for=\"'spec-' + ${spec.specialtyId}\" th:text=\"${spec.category}\"></label>\n+                                    </div>\n+                                    <input type=\"text\" id=\"specialty\" placeholder=\"진료 과목을 입력하세요\" required>\n+                                </div>\n+                            </div> -->\n+\n                             <div class=\"form-group\">\n                                 <label>카테고리</label>\n                                 <div class=\"category-group\">\n                                     <label class=\"category-item\">\n"
                },
                {
                    "date": 1751987960352,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -83,50 +83,61 @@\n                             <div class=\"form-group\">\n                                 <label for=\"hosp-introduce\">병원 소개</label>\n                                 <textarea type=\"text\" id=\"hosp-introduce\" th:field=\"*{email}\" placeholder=\"간단한 소개글을 작성해 주세요\" required rows=\"4\" style=\"resize: none;\"></textarea>\n                             </div>\n-\n-                            <!-- <div class=\"form-group\">\n-                                <label>진료 과목</label>\n-                                <div class=\"checkbox-group\">\n-                                    <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n-                                        <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\n-                                        <label th:for=\"'spec-' + ${spec.specialtyId}\" th:text=\"${spec.category}\"></label>\n-                                    </div>\n-                                    <input type=\"text\" id=\"specialty\" placeholder=\"진료 과목을 입력하세요\" required>\n-                                </div>\n-                            </div> -->\n-\n-                            <div class=\"form-group\">\n-                                <label>카테고리</label>\n-                                <div class=\"category-group\">\n-                                    <label class=\"category-item\">\n-                                        <input type=\"checkbox\" name=\"category\" value=\"포유류\">\n-                                        <span>포유류</span>\n-                                    </label>\n-                                    <label class=\"category-item\">\n-                                        <input type=\"checkbox\" name=\"category\" value=\"파충류\">\n-                                        <span>파충류</span>\n-                                    </label>\n-                                    <label class=\"category-item\">\n-                                        <input type=\"checkbox\" name=\"category\" value=\"조류\">\n-                                        <span>조류</span>\n-                                    </label>\n-                                    <label class=\"category-item\">\n-                                        <input type=\"checkbox\" name=\"category\" value=\"절지류\">\n-                                        <span>절지류</span>\n-                                    </label>\n-                                    <label class=\"category-item\">\n-                                        <input type=\"checkbox\" name=\"category\" value=\"설치류\">\n-                                        <span>설치류</span>\n-                                    </label>\n-                                </div>\n+                        </div>\n+                    </div>\n+                </form>\n+                <form id=\"checkboxForm\" th:object=\"${hospitalForm}\">\n+                    <div class=\"form-group\">\n+                        <label>진료 과목</label>\n+                        <div class=\"checkbox-group\">\n+                            <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n+                                <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\n+                                <label th:for=\"'spec-' + ${spec.specialtyId}\" th:text=\"${spec.category}\"></label>\n                             </div>\n-\n+                            <input type=\"text\" id=\"specialty\" placeholder=\"진료 과목을 입력하세요\" required>\n+                        </div>\n+                    </div>\n+                    <div>\n+                        <label>진료 가능 동물</label>\n+                        <div class=\"checkbox-group\">\n+                            <div th:each=\"animal : ${animalList}\" class=\"checkbox-item\">\n+                                <input type=\"checkbox\" th:field=\"*{animalIds}\" th:value=\"${animal.animalId}\" th:id=\"'animal-' + ${animal.animalId}\">\n+                                <label th:for=\"'animal-' + ${animal.animalId}\" th:text=\"${animal.species}\"></label>\n                             </div>\n                         </div>\n                     </div>\n+                    <div class=\"form-group\">\n+                        <label>카테고리</label>\n+                        <div class=\"category-group\">\n+                            <label class=\"category-item\">\n+                                <input type=\"checkbox\" name=\"category\" value=\"포유류\">\n+                                <span>포유류</span>\n+                            </label>\n+                            <label class=\"category-item\">\n+                                <input type=\"checkbox\" name=\"category\" value=\"파충류\">\n+                                <span>파충류</span>\n+                            </label>\n+                            <label class=\"category-item\">\n+                                <input type=\"checkbox\" name=\"category\" value=\"조류\">\n+                                <span>조류</span>\n+                            </label>\n+                            <label class=\"category-item\">\n+                                <input type=\"checkbox\" name=\"category\" value=\"절지류\">\n+                                <span>절지류</span>\n+                            </label>\n+                            <label class=\"category-item\">\n+                                <input type=\"checkbox\" name=\"category\" value=\"설치류\">\n+                                <span>설치류</span>\n+                            </label>\n+                        </div>\n+                    </div>\n+                        </div>\n                 </form>\n+                        </div>\n+                    </div>\n+                </form>\n             </div>\n \n             <!-- 삭제 form -->\n             <div sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">\n"
                },
                {
                    "date": 1751988163093,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -100,10 +100,10 @@\n                     </div>\n                     <div>\n                         <label>진료 가능 동물</label>\n                         <div class=\"checkbox-group\">\n-                            <div th:each=\"animal : ${animalList}\" class=\"checkbox-item\">\n-                                <input type=\"checkbox\" th:field=\"*{animalIds}\" th:value=\"${animal.animalId}\" th:id=\"'animal-' + ${animal.animalId}\">\n+                            <div th:each=\"animal : ${animalList}\" class=\"category-item\">\n+                                <input type=\"checkbox\" name=\"category\" th:field=\"*{animalIds}\" th:value=\"${animal.animalId}\" th:id=\"'animal-' + ${animal.animalId}\">\n                                 <label th:for=\"'animal-' + ${animal.animalId}\" th:text=\"${animal.species}\"></label>\n                             </div>\n                         </div>\n                     </div>\n"
                },
                {
                    "date": 1751988203101,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -100,12 +100,12 @@\n                     </div>\n                     <div>\n                         <label>진료 가능 동물</label>\n                         <div class=\"checkbox-group\">\n-                            <div th:each=\"animal : ${animalList}\" class=\"category-item\">\n+                            <label th:each=\"animal : ${animalList}\" class=\"category-item\">\n                                 <input type=\"checkbox\" name=\"category\" th:field=\"*{animalIds}\" th:value=\"${animal.animalId}\" th:id=\"'animal-' + ${animal.animalId}\">\n                                 <label th:for=\"'animal-' + ${animal.animalId}\" th:text=\"${animal.species}\"></label>\n-                            </div>\n+                            </label>\n                         </div>\n                     </div>\n                     <div class=\"form-group\">\n                         <label>카테고리</label>\n"
                },
                {
                    "date": 1751988302181,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -102,9 +102,9 @@\n                         <label>진료 가능 동물</label>\n                         <div class=\"checkbox-group\">\n                             <label th:each=\"animal : ${animalList}\" class=\"category-item\">\n                                 <input type=\"checkbox\" name=\"category\" th:field=\"*{animalIds}\" th:value=\"${animal.animalId}\" th:id=\"'animal-' + ${animal.animalId}\">\n-                                <label th:for=\"'animal-' + ${animal.animalId}\" th:text=\"${animal.species}\"></label>\n+                                <span th:for=\"'animal-' + ${animal.animalId}\" th:text=\"${animal.species}\"></span>\n                             </label>\n                         </div>\n                     </div>\n                     <div class=\"form-group\">\n"
                },
                {
                    "date": 1751988369471,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,326 @@\n+<!DOCTYPE html>\n+<html lang=\"ko\" xmlns:th=\"http://www.thymeleaf.org\" xmlns:sec=\"http://www.thymeleaf.org/thymeleaf-extras-springsecurity5\">\n+<head>\n+    <meta charset=\"UTF-8\">\n+    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n+    <meta name=\"_csrf\" th:content=\"${_csrf.token}\" />\n+    <meta name=\"_csrf_header\" th:content=\"${_csrf.headerName}\" />\n+\n+    <title>병원 등록</title>\n+    <!-- Bootstrap CSS -->\n+    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\">\n+    <!-- Font Awesome CSS -->\n+    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css\">\n+    <link rel=\"stylesheet\" th:href=\"@{/css/hospital_style.css}\">\n+</head>\n+<body>\n+    <th:block th:replace=\"~{/fragments/header :: header}\"></th:block>\n+    <div class=\"hospital-main-container\">\n+        <!-- 상단 로고 -->\n+        <div class=\"logo-container\">\n+            <div class=\"logo\">\n+                <img th:src=\"@{/img/hosp_logo.png}\" alt=\"병원 아이콘\" class=\"logo-icon\">\n+            </div>\n+        </div>\n+\n+        <!-- 메인 컨텐츠 -->\n+        <div class=\"main-content\">\n+                        <!-- Hidden form for multipart file upload  잼민이버전-->\n+            <!-- <form id=\"fileUploadForm\" style=\"display: none;\" enctype=\"multipart/form-data\">\n+                <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" onchange=\"previewImage(event)\">\n+            </form> -->\n+\n+            <!-- 채찍피티 버전 -->\n+            <div class=\"d-flex justify-content-around align-items-start gap-20\">\n+\n+                <form id=\"imageForm\" enctype=\"multipart/form-data\">\n+                    <div class=\"image-upload-section\">\n+                        <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n+                            <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n+                        </div>\n+                        <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" style=\"display: none;\" onchange=\"previewImage(event)\">\n+                    </div>\n+                </form>\n+\n+\n+                <!-- Main form for general data -->\n+                <form id=\"generalDataForm\" th:object=\"${hospitalForm}\">\n+                    <input type=\"hidden\" id=\"hospitalId\" th:field=\"*{hospitalId}\" />\n+                    <!-- <input type=\"hidden\" id=\"csrfTokenGeneral\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" /> -->\n+\n+                    <div class=\"form-container\">\n+                        <!-- <div class=\"image-upload-section\">\n+                            <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n+                                <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n+                            </div>\n+                        </div> -->\n+\n+                        <div class=\"form-section\">\n+                            <div class=\"form-group\">\n+                                <label for=\"name\">병원 이름</label>\n+                                <input type=\"text\" id=\"name\" th:field=\"*{name}\" placeholder=\"병원 이름을 작성하세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"address\">병원 주소</label>\n+                                <input type=\"text\" id=\"address\" th:field=\"*{address}\" placeholder=\"주소를 입력해 주세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"homepage\">홈페이지</label>\n+                                <input type=\"url\" id=\"homepage\" th:field=\"*{homepage}\" placeholder=\"홈페이지 주소를 입력해 주세요\">\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"phone\">대표번호</label>\n+                                <input type=\"tel\" id=\"phone\" th:field=\"*{phone}\" placeholder=\"병원 전화번호를 입력하세요\" required>\n+                            </div>\n+\n+                            <!-- <div class=\"form-group\">\n+                                <label for=\"email\">이메일</label>\n+                                <input type=\"email\" id=\"email\" th:field=\"*{email}\" placeholder=\"이메일 주소를 입력하세요\">\n+                            </div> -->\n+                            <div class=\"form-group\">\n+                                <label for=\"hosp-introduce\">병원 소개</label>\n+                                <textarea type=\"text\" id=\"hosp-introduce\" th:field=\"*{email}\" placeholder=\"간단한 소개글을 작성해 주세요\" required rows=\"4\" style=\"resize: none;\"></textarea>\n+                            </div>\n+                        </div>\n+                    </div>\n+                </form>\n+                <form id=\"checkboxForm\" th:object=\"${hospitalForm}\">\n+                    <div class=\"form-group\">\n+                        <label>진료 과목</label>\n+                        <div class=\"checkbox-group\">\n+                            <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n+                                <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\n+                                <label th:for=\"'spec-' + ${spec.specialtyId}\" th:text=\"${spec.category}\"></label>\n+                            </div>\n+                            <input type=\"text\" id=\"specialty\" placeholder=\"진료 과목을 입력하세요\" required>\n+                        </div>\n+                    </div>\n+                    <div class=\"form-group\">\n+                        <label>진료 가능 동물</label>\n+                        <div class=\"checkbox-group\">\n+                            <label th:each=\"animal : ${animalList}\" class=\"category-item\">\n+                                <input type=\"checkbox\" name=\"category\" th:field=\"*{animalIds}\" th:value=\"${animal.animalId}\" th:id=\"'animal-' + ${animal.animalId}\">\n+                                <span th:for=\"'animal-' + ${animal.animalId}\" th:text=\"${animal.species}\"></span>\n+                            </label>\n+                        </div>\n+                    </div>\n+                    <div class=\"form-group\">\n+                        <label>카테고리</label>\n+                        <div class=\"category-group\">\n+                            <label class=\"category-item\">\n+                                <input type=\"checkbox\" name=\"category\" value=\"포유류\">\n+                                <span>포유류</span>\n+                            </label>\n+                            <label class=\"category-item\">\n+                                <input type=\"checkbox\" name=\"category\" value=\"파충류\">\n+                                <span>파충류</span>\n+                            </label>\n+                            <label class=\"category-item\">\n+                                <input type=\"checkbox\" name=\"category\" value=\"조류\">\n+                                <span>조류</span>\n+                            </label>\n+                            <label class=\"category-item\">\n+                                <input type=\"checkbox\" name=\"category\" value=\"절지류\">\n+                                <span>절지류</span>\n+                            </label>\n+                            <label class=\"category-item\">\n+                                <input type=\"checkbox\" name=\"category\" value=\"설치류\">\n+                                <span>설치류</span>\n+                            </label>\n+                        </div>\n+                    </div>\n+                        </div>\n+                </form>\n+                        </div>\n+                    </div>\n+                </form>\n+            </div>\n+\n+            <!-- 삭제 form -->\n+            <div sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">\n+                <form id=\"deleteForm\" th:action=\"@{/hospitals/delete/{id}(id=${hospitalForm.hospitalId})}\" method=\"post\" style=\"display: none;\">\n+                    <input type=\"hidden\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" />\n+                </form>\n+            </div>\n+\n+            <div class=\"d-flex justify-content-center gap-2 mt-4\">\n+                <button type=\"button\" class=\"btn btn-secondary\" onclick=\"history.back()\">취소</button>\n+                <button type=\"button\" id=\"submitAllBtn\" class=\"btn btn-primary\" th:text=\"${hospitalForm.hospitalId != null ? '수정' : '등록'}\"></button>\n+                <button type=\"button\" id=\"deleteBtn\" class=\"btn btn-danger\" sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">삭제</button>\n+            </div>\n+        </div>\n+\n+\n+<script>\n+  function previewImage(event) {\n+    const input = event.target;\n+    const reader = new FileReader();\n+\n+    reader.onload = function () {\n+      const preview = document.getElementById('preview');\n+      preview.src = reader.result;\n+    };\n+\n+    if (input.files && input.files[0]) {\n+      reader.readAsDataURL(input.files[0]);\n+    }\n+  }\n+\n+\n+  // 채찍피티 버전\n+    document.addEventListener('DOMContentLoaded', function () {\n+        const submitAllBtn = document.getElementById('submitAllBtn');\n+        const imageForm = document.getElementById('imageForm');\n+        const generalDataForm = document.getElementById('generalDataForm');\n+        // const hospitalId = '[[${hospitalForm.hospitalId}]]';\n+        const hospitalId = document.getElementById('hospitalId')?.value;\n+        const isNew = !hospitalId || hospitalId === 'null' || hospitalId === '';\n+\n+        const csrfToken = document.querySelector('meta[name=\"_csrf\"]').content;\n+        const csrfHeader = document.querySelector('meta[name=\"_csrf_header\"]').content;\n+\n+        const deleteBtn = document.getElementById('deleteBtn');\n+        if (deleteBtn) {\n+            deleteBtn.addEventListener('click', function() {\n+                if (confirm('정말로 이 병원을 삭제하시겠습니까?')) {\n+                    document.getElementById('deleteForm').submit();\n+                }\n+            });\n+        }\n+\n+        submitAllBtn.addEventListener('click', async function (event) {\n+            event.preventDefault();\n+\n+            const formData = new FormData();\n+\n+            // 1. 일반 입력값 병합\n+            const generalFormData = new FormData(generalDataForm);\n+            for (const [key, value] of generalFormData.entries()) {\n+                formData.append(key, value);\n+            }\n+\n+            // 2. 이미지 파일 업로드 및 URL 병합\n+            const imageFileInput = imageForm.querySelector('#fileInput');\n+            if (imageFileInput && imageFileInput.files.length > 0) {\n+                const imageUploadFormData = new FormData();\n+                imageUploadFormData.append('image', imageFileInput.files[0]);\n+\n+                try {\n+                    const uploadResponse = await fetch('/upload/image', {\n+                        method: 'POST',\n+                        headers: {\n+                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n+                        },\n+                        body: imageUploadFormData\n+                    });\n+\n+                    if (uploadResponse.ok) {\n+                        const uploadResult = await uploadResponse.json();\n+                        if (uploadResult.success === 1) {\n+                            formData.append('thumbnailImageUrl', uploadResult.imageUrl);\n+                        } else {\n+                            alert('이미지 업로드 실패: ' + uploadResult.message);\n+                            return; // 이미지 업로드 실패 시 전체 제출 중단\n+                        }\n+                    } else {\n+                        const errorText = await uploadResponse.text();\n+                        console.error('이미지 업로드 실패:', errorText);\n+                        alert('이미지 업로드를 실패하였습니다.');\n+                        return; // 이미지 업로드 실패 시 전체 제출 중단\n+                    }\n+                } catch (error) {\n+                    console.error('이미지 업로드 중 오류:', error);\n+                    alert('이미지 업로드 중 오류가 발생했습니다.');\n+                    return; // 이미지 업로드 실패 시 전체 제출 중단\n+                }\n+            }\n+\n+            // 3. 전송\n+            const actionUrl = isNew ? '/hospitals/new' : '/hospitals/edit';\n+\n+            try {\n+                const response = await fetch(actionUrl, {\n+                    method: 'POST',\n+                    headers: {\n+                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n+                        },\n+                    body: formData\n+                });\n+\n+                if (response.ok) {\n+                    const result = await response.json();\n+                    alert('병원 정보가 성공적으로 제출되었습니다!');\n+                    window.location.href = '/hospitals';\n+                } else {\n+                    const errorText = await response.text();\n+                    console.error('제출 실패:', errorText);\n+                    alert('제출에 실패했습니다: ' + errorText);\n+                }\n+            } catch (error) {\n+                console.error('제출 중 오류:', error);\n+                alert('제출 중 오류가 발생했습니다.');\n+            }\n+        });\n+    });\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+  // 잼민이 버전\n+//   document.addEventListener('DOMContentLoaded', function() {\n+//     const submitAllBtn = document.getElementById('submitAllBtn');\n+//     const generalDataForm = document.getElementById('generalDataForm');\n+//     const fileUploadForm = document.getElementById('fileUploadForm'); // fileUploadForm 참조 추가\n+//     const hospitalId = '[[${hospitalForm.hospitalId}]]'; // Thymeleaf 변수 사용\n+\n+//     submitAllBtn.addEventListener('click', async function(event) {\n+//       event.preventDefault(); // 기본 폼 제출 방지\n+\n+//       const formData = new FormData(generalDataForm); // generalDataForm의 데이터로 FormData 초기화\n+//       const fileInput = fileUploadForm.querySelector('#fileInput'); // fileUploadForm에서 fileInput 가져오기\n+//       if (fileInput && fileInput.files && fileInput.files[0]) {\n+//         formData.append('thumbnailImageFile', fileInput.files[0]);\n+//       }\n+\n+//       // 폼 액션 URL 결정\n+//       const actionUrl = hospitalId === 'null' ? '/hospitals/new' : '/hospitals/edit';\n+\n+//       try {\n+//         const response = await fetch(actionUrl, {\n+//                                                     method: 'POST',\n+//                                                     body: formData\n+//                                                 });\n+\n+//         if (response.ok) {\n+//           const result = await response.json(); // 또는 response.text()\n+//           console.log('Submission successful:', result);\n+//           alert('병원 정보가 성공적으로 제출되었습니다!');\n+//           // 성공 후 리다이렉트 또는 다른 작업 수행\n+//           window.location.href = '/hospitals'; // 예시: 병원 목록 페이지로 이동\n+//         } else {\n+//           const errorText = await response.text();\n+//           console.error('Submission failed:', response.status, errorText);\n+//           alert('병원 정보 제출에 실패했습니다: ' + errorText);\n+//         }\n+//       } catch (error) {\n+//         console.error('Error during submission:', error);\n+//         alert('병원 정보 제출 중 오류가 발생했습니다.');\n+//       }\n+//     });\n+//   });\n+</script>\n+\n+\n+    <th:block th:replace=\"~{/fragments/footer :: footer}\"></th:block>\n+    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q\" crossorigin=\"anonymous\"></script>\n+</body>\n+</html>\n\\ No newline at end of file\n"
                },
                {
                    "date": 1751988456648,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -99,9 +99,9 @@\n                         </div>\n                     </div>\n                     <div class=\"form-group\">\n                         <label>진료 가능 동물</label>\n-                        <div class=\"checkbox-group\">\n+                        <div class=\"category-group\">\n                             <label th:each=\"animal : ${animalList}\" class=\"category-item\">\n                                 <input type=\"checkbox\" name=\"category\" th:field=\"*{animalIds}\" th:value=\"${animal.animalId}\" th:id=\"'animal-' + ${animal.animalId}\">\n                                 <span th:for=\"'animal-' + ${animal.animalId}\" th:text=\"${animal.species}\"></span>\n                             </label>\n"
                },
                {
                    "date": 1751988749673,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,326 @@\n+<!DOCTYPE html>\n+<html lang=\"ko\" xmlns:th=\"http://www.thymeleaf.org\" xmlns:sec=\"http://www.thymeleaf.org/thymeleaf-extras-springsecurity5\">\n+<head>\n+    <meta charset=\"UTF-8\">\n+    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n+    <meta name=\"_csrf\" th:content=\"${_csrf.token}\" />\n+    <meta name=\"_csrf_header\" th:content=\"${_csrf.headerName}\" />\n+\n+    <title>병원 등록</title>\n+    <!-- Bootstrap CSS -->\n+    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\">\n+    <!-- Font Awesome CSS -->\n+    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css\">\n+    <link rel=\"stylesheet\" th:href=\"@{/css/hospital_style.css}\">\n+</head>\n+<body>\n+    <th:block th:replace=\"~{/fragments/header :: header}\"></th:block>\n+    <div class=\"hospital-main-container\">\n+        <!-- 상단 로고 -->\n+        <div class=\"logo-container\">\n+            <div class=\"logo\">\n+                <img th:src=\"@{/img/hosp_logo.png}\" alt=\"병원 아이콘\" class=\"logo-icon\">\n+            </div>\n+        </div>\n+\n+        <!-- 메인 컨텐츠 -->\n+        <div class=\"main-content\">\n+                        <!-- Hidden form for multipart file upload  잼민이버전-->\n+            <!-- <form id=\"fileUploadForm\" style=\"display: none;\" enctype=\"multipart/form-data\">\n+                <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" onchange=\"previewImage(event)\">\n+            </form> -->\n+\n+            <!-- 채찍피티 버전 -->\n+            <div class=\"d-flex justify-content-around align-items-start gap-20\">\n+\n+                <form id=\"imageForm\" enctype=\"multipart/form-data\">\n+                    <div class=\"image-upload-section\">\n+                        <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n+                            <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n+                        </div>\n+                        <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" style=\"display: none;\" onchange=\"previewImage(event)\">\n+                    </div>\n+                </form>\n+\n+\n+                <!-- Main form for general data -->\n+                <form id=\"generalDataForm\" th:object=\"${hospitalForm}\">\n+                    <input type=\"hidden\" id=\"hospitalId\" th:field=\"*{hospitalId}\" />\n+                    <!-- <input type=\"hidden\" id=\"csrfTokenGeneral\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" /> -->\n+\n+                    <div class=\"form-container\">\n+                        <!-- <div class=\"image-upload-section\">\n+                            <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n+                                <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n+                            </div>\n+                        </div> -->\n+\n+                        <div class=\"form-section\">\n+                            <div class=\"form-group\">\n+                                <label for=\"name\">병원 이름</label>\n+                                <input type=\"text\" id=\"name\" th:field=\"*{name}\" placeholder=\"병원 이름을 작성하세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"address\">병원 주소</label>\n+                                <input type=\"text\" id=\"address\" th:field=\"*{address}\" placeholder=\"주소를 입력해 주세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"homepage\">홈페이지</label>\n+                                <input type=\"url\" id=\"homepage\" th:field=\"*{homepage}\" placeholder=\"홈페이지 주소를 입력해 주세요\">\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"phone\">대표번호</label>\n+                                <input type=\"tel\" id=\"phone\" th:field=\"*{phone}\" placeholder=\"병원 전화번호를 입력하세요\" required>\n+                            </div>\n+\n+                            <!-- <div class=\"form-group\">\n+                                <label for=\"email\">이메일</label>\n+                                <input type=\"email\" id=\"email\" th:field=\"*{email}\" placeholder=\"이메일 주소를 입력하세요\">\n+                            </div> -->\n+                            <div class=\"form-group\">\n+                                <label for=\"hosp-introduce\">병원 소개</label>\n+                                <textarea type=\"text\" id=\"hosp-introduce\" th:field=\"*{email}\" placeholder=\"간단한 소개글을 작성해 주세요\" required rows=\"4\" style=\"resize: none;\"></textarea>\n+                            </div>\n+                        </div>\n+                    </div>\n+                </form>\n+                <form id=\"checkboxForm\" th:object=\"${hospitalForm}\">\n+                    <div class=\"form-group\">\n+                        <label>진료 과목</label>\n+                        <div class=\"checkbox-group\">\n+                            <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n+                                <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\n+                                <label th:for=\"'spec-' + ${spec.specialtyId}\" th:text=\"${spec.category}\"></label>\n+                            </div>\n+                            <input type=\"text\" id=\"specialty\" placeholder=\"진료 과목을 입력하세요\" required>\n+                        </div>\n+                    </div>\n+                    <div class=\"form-group\">\n+                        <label>진료 가능 동물</label>\n+                        <div class=\"category-group\">\n+                            <label th:each=\"animal : ${animalList}\" class=\"category-item\">\n+                                <input type=\"checkbox\" name=\"category\" th:field=\"*{animalIds}\" th:value=\"${animal.animalId}\" th:id=\"'animal-' + ${animal.animalId}\">\n+                                <span th:for=\"'animal-' + ${animal.animalId}\" th:text=\"${animal.species}\"></span>\n+                            </label>\n+                        </div>\n+                    </div>\n+                    <!-- <div class=\"form-group\">\n+                        <label>카테고리</label>\n+                        <div class=\"category-group\">\n+                            <label class=\"category-item\">\n+                                <input type=\"checkbox\" name=\"category\" value=\"포유류\">\n+                                <span>포유류</span>\n+                            </label>\n+                            <label class=\"category-item\">\n+                                <input type=\"checkbox\" name=\"category\" value=\"파충류\">\n+                                <span>파충류</span>\n+                            </label>\n+                            <label class=\"category-item\">\n+                                <input type=\"checkbox\" name=\"category\" value=\"조류\">\n+                                <span>조류</span>\n+                            </label>\n+                            <label class=\"category-item\">\n+                                <input type=\"checkbox\" name=\"category\" value=\"절지류\">\n+                                <span>절지류</span>\n+                            </label>\n+                            <label class=\"category-item\">\n+                                <input type=\"checkbox\" name=\"category\" value=\"설치류\">\n+                                <span>설치류</span>\n+                            </label>\n+                        </div>\n+                    </div> -->\n+                        </div>\n+                </form>\n+                        </div>\n+                    </div>\n+                </form>\n+            </div>\n+\n+            <!-- 삭제 form -->\n+            <div sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">\n+                <form id=\"deleteForm\" th:action=\"@{/hospitals/delete/{id}(id=${hospitalForm.hospitalId})}\" method=\"post\" style=\"display: none;\">\n+                    <input type=\"hidden\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" />\n+                </form>\n+            </div>\n+\n+            <div class=\"d-flex justify-content-center gap-2 mt-4\">\n+                <button type=\"button\" class=\"btn btn-secondary\" onclick=\"history.back()\">취소</button>\n+                <button type=\"button\" id=\"submitAllBtn\" class=\"btn btn-primary\" th:text=\"${hospitalForm.hospitalId != null ? '수정' : '등록'}\"></button>\n+                <button type=\"button\" id=\"deleteBtn\" class=\"btn btn-danger\" sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">삭제</button>\n+            </div>\n+        </div>\n+\n+\n+<script>\n+  function previewImage(event) {\n+    const input = event.target;\n+    const reader = new FileReader();\n+\n+    reader.onload = function () {\n+      const preview = document.getElementById('preview');\n+      preview.src = reader.result;\n+    };\n+\n+    if (input.files && input.files[0]) {\n+      reader.readAsDataURL(input.files[0]);\n+    }\n+  }\n+\n+\n+  // 채찍피티 버전\n+    document.addEventListener('DOMContentLoaded', function () {\n+        const submitAllBtn = document.getElementById('submitAllBtn');\n+        const imageForm = document.getElementById('imageForm');\n+        const generalDataForm = document.getElementById('generalDataForm');\n+        // const hospitalId = '[[${hospitalForm.hospitalId}]]';\n+        const hospitalId = document.getElementById('hospitalId')?.value;\n+        const isNew = !hospitalId || hospitalId === 'null' || hospitalId === '';\n+\n+        const csrfToken = document.querySelector('meta[name=\"_csrf\"]').content;\n+        const csrfHeader = document.querySelector('meta[name=\"_csrf_header\"]').content;\n+\n+        const deleteBtn = document.getElementById('deleteBtn');\n+        if (deleteBtn) {\n+            deleteBtn.addEventListener('click', function() {\n+                if (confirm('정말로 이 병원을 삭제하시겠습니까?')) {\n+                    document.getElementById('deleteForm').submit();\n+                }\n+            });\n+        }\n+\n+        submitAllBtn.addEventListener('click', async function (event) {\n+            event.preventDefault();\n+\n+            const formData = new FormData();\n+\n+            // 1. 일반 입력값 병합\n+            const generalFormData = new FormData(generalDataForm);\n+            for (const [key, value] of generalFormData.entries()) {\n+                formData.append(key, value);\n+            }\n+\n+            // 2. 이미지 파일 업로드 및 URL 병합\n+            const imageFileInput = imageForm.querySelector('#fileInput');\n+            if (imageFileInput && imageFileInput.files.length > 0) {\n+                const imageUploadFormData = new FormData();\n+                imageUploadFormData.append('image', imageFileInput.files[0]);\n+\n+                try {\n+                    const uploadResponse = await fetch('/upload/image', {\n+                        method: 'POST',\n+                        headers: {\n+                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n+                        },\n+                        body: imageUploadFormData\n+                    });\n+\n+                    if (uploadResponse.ok) {\n+                        const uploadResult = await uploadResponse.json();\n+                        if (uploadResult.success === 1) {\n+                            formData.append('thumbnailImageUrl', uploadResult.imageUrl);\n+                        } else {\n+                            alert('이미지 업로드 실패: ' + uploadResult.message);\n+                            return; // 이미지 업로드 실패 시 전체 제출 중단\n+                        }\n+                    } else {\n+                        const errorText = await uploadResponse.text();\n+                        console.error('이미지 업로드 실패:', errorText);\n+                        alert('이미지 업로드를 실패하였습니다.');\n+                        return; // 이미지 업로드 실패 시 전체 제출 중단\n+                    }\n+                } catch (error) {\n+                    console.error('이미지 업로드 중 오류:', error);\n+                    alert('이미지 업로드 중 오류가 발생했습니다.');\n+                    return; // 이미지 업로드 실패 시 전체 제출 중단\n+                }\n+            }\n+\n+            // 3. 전송\n+            const actionUrl = isNew ? '/hospitals/new' : '/hospitals/edit';\n+\n+            try {\n+                const response = await fetch(actionUrl, {\n+                    method: 'POST',\n+                    headers: {\n+                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n+                        },\n+                    body: formData\n+                });\n+\n+                if (response.ok) {\n+                    const result = await response.json();\n+                    alert('병원 정보가 성공적으로 제출되었습니다!');\n+                    window.location.href = '/hospitals';\n+                } else {\n+                    const errorText = await response.text();\n+                    console.error('제출 실패:', errorText);\n+                    alert('제출에 실패했습니다: ' + errorText);\n+                }\n+            } catch (error) {\n+                console.error('제출 중 오류:', error);\n+                alert('제출 중 오류가 발생했습니다.');\n+            }\n+        });\n+    });\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+  // 잼민이 버전\n+//   document.addEventListener('DOMContentLoaded', function() {\n+//     const submitAllBtn = document.getElementById('submitAllBtn');\n+//     const generalDataForm = document.getElementById('generalDataForm');\n+//     const fileUploadForm = document.getElementById('fileUploadForm'); // fileUploadForm 참조 추가\n+//     const hospitalId = '[[${hospitalForm.hospitalId}]]'; // Thymeleaf 변수 사용\n+\n+//     submitAllBtn.addEventListener('click', async function(event) {\n+//       event.preventDefault(); // 기본 폼 제출 방지\n+\n+//       const formData = new FormData(generalDataForm); // generalDataForm의 데이터로 FormData 초기화\n+//       const fileInput = fileUploadForm.querySelector('#fileInput'); // fileUploadForm에서 fileInput 가져오기\n+//       if (fileInput && fileInput.files && fileInput.files[0]) {\n+//         formData.append('thumbnailImageFile', fileInput.files[0]);\n+//       }\n+\n+//       // 폼 액션 URL 결정\n+//       const actionUrl = hospitalId === 'null' ? '/hospitals/new' : '/hospitals/edit';\n+\n+//       try {\n+//         const response = await fetch(actionUrl, {\n+//                                                     method: 'POST',\n+//                                                     body: formData\n+//                                                 });\n+\n+//         if (response.ok) {\n+//           const result = await response.json(); // 또는 response.text()\n+//           console.log('Submission successful:', result);\n+//           alert('병원 정보가 성공적으로 제출되었습니다!');\n+//           // 성공 후 리다이렉트 또는 다른 작업 수행\n+//           window.location.href = '/hospitals'; // 예시: 병원 목록 페이지로 이동\n+//         } else {\n+//           const errorText = await response.text();\n+//           console.error('Submission failed:', response.status, errorText);\n+//           alert('병원 정보 제출에 실패했습니다: ' + errorText);\n+//         }\n+//       } catch (error) {\n+//         console.error('Error during submission:', error);\n+//         alert('병원 정보 제출 중 오류가 발생했습니다.');\n+//       }\n+//     });\n+//   });\n+</script>\n+\n+\n+    <th:block th:replace=\"~{/fragments/footer :: footer}\"></th:block>\n+    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q\" crossorigin=\"anonymous\"></script>\n+</body>\n+</html>\n\\ No newline at end of file\n"
                },
                {
                    "date": 1751988936995,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -75,12 +75,12 @@\n                                 <label for=\"phone\">대표번호</label>\n                                 <input type=\"tel\" id=\"phone\" th:field=\"*{phone}\" placeholder=\"병원 전화번호를 입력하세요\" required>\n                             </div>\n \n-                            <!-- <div class=\"form-group\">\n+                            <div class=\"form-group\">\n                                 <label for=\"email\">이메일</label>\n                                 <input type=\"email\" id=\"email\" th:field=\"*{email}\" placeholder=\"이메일 주소를 입력하세요\">\n-                            </div> -->\n+                            </div>\n                             <div class=\"form-group\">\n                                 <label for=\"hosp-introduce\">병원 소개</label>\n                                 <textarea type=\"text\" id=\"hosp-introduce\" th:field=\"*{email}\" placeholder=\"간단한 소개글을 작성해 주세요\" required rows=\"4\" style=\"resize: none;\"></textarea>\n                             </div>\n@@ -106,34 +106,9 @@\n                                 <span th:for=\"'animal-' + ${animal.animalId}\" th:text=\"${animal.species}\"></span>\n                             </label>\n                         </div>\n                     </div>\n-                    <!-- <div class=\"form-group\">\n-                        <label>카테고리</label>\n-                        <div class=\"category-group\">\n-                            <label class=\"category-item\">\n-                                <input type=\"checkbox\" name=\"category\" value=\"포유류\">\n-                                <span>포유류</span>\n-                            </label>\n-                            <label class=\"category-item\">\n-                                <input type=\"checkbox\" name=\"category\" value=\"파충류\">\n-                                <span>파충류</span>\n-                            </label>\n-                            <label class=\"category-item\">\n-                                <input type=\"checkbox\" name=\"category\" value=\"조류\">\n-                                <span>조류</span>\n-                            </label>\n-                            <label class=\"category-item\">\n-                                <input type=\"checkbox\" name=\"category\" value=\"절지류\">\n-                                <span>절지류</span>\n-                            </label>\n-                            <label class=\"category-item\">\n-                                <input type=\"checkbox\" name=\"category\" value=\"설치류\">\n-                                <span>설치류</span>\n-                            </label>\n                         </div>\n-                    </div> -->\n-                        </div>\n                 </form>\n                         </div>\n                     </div>\n                 </form>\n"
                },
                {
                    "date": 1751989157423,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,300 @@\n+<!DOCTYPE html>\n+<html lang=\"ko\" xmlns:th=\"http://www.thymeleaf.org\" xmlns:sec=\"http://www.thymeleaf.org/thymeleaf-extras-springsecurity5\">\n+<head>\n+    <meta charset=\"UTF-8\">\n+    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n+    <meta name=\"_csrf\" th:content=\"${_csrf.token}\" />\n+    <meta name=\"_csrf_header\" th:content=\"${_csrf.headerName}\" />\n+\n+    <title>병원 등록</title>\n+    <!-- Bootstrap CSS -->\n+    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\">\n+    <!-- Font Awesome CSS -->\n+    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css\">\n+    <link rel=\"stylesheet\" th:href=\"@{/css/hospital_style.css}\">\n+</head>\n+<body>\n+    <th:block th:replace=\"~{/fragments/header :: header}\"></th:block>\n+    <div class=\"hospital-main-container\">\n+        <!-- 상단 로고 -->\n+        <div class=\"logo-container\">\n+            <div class=\"logo\">\n+                <img th:src=\"@{/img/hosp_logo.png}\" alt=\"병원 아이콘\" class=\"logo-icon\">\n+            </div>\n+        </div>\n+\n+        <!-- 메인 컨텐츠 -->\n+        <div class=\"main-content\">\n+                        <!-- Hidden form for multipart file upload  잼민이버전-->\n+            <!-- <form id=\"fileUploadForm\" style=\"display: none;\" enctype=\"multipart/form-data\">\n+                <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" onchange=\"previewImage(event)\">\n+            </form> -->\n+\n+            <!-- 채찍피티 버전 -->\n+            <div class=\"d-flex justify-content-around align-items-start gap-20\">\n+\n+                <form id=\"imageForm\" enctype=\"multipart/form-data\">\n+                    <div class=\"image-upload-section\">\n+                        <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n+                            <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n+                        </div>\n+                        <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" style=\"display: none;\" onchange=\"previewImage(event)\">\n+                    </div>\n+                </form>\n+\n+\n+                <!-- Main form for general data -->\n+                <form id=\"generalDataForm\" th:object=\"${hospitalForm}\">\n+                    <input type=\"hidden\" id=\"hospitalId\" th:field=\"*{hospitalId}\" />\n+                    <!-- <input type=\"hidden\" id=\"csrfTokenGeneral\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" /> -->\n+\n+                    <div class=\"form-container\">\n+                        <!-- <div class=\"image-upload-section\">\n+                            <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n+                                <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n+                            </div>\n+                        </div> -->\n+\n+                        <div class=\"form-section\">\n+                            <div class=\"form-group\">\n+                                <label for=\"name\">병원 이름</label>\n+                                <input type=\"text\" id=\"name\" th:field=\"*{name}\" placeholder=\"병원 이름을 작성하세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"address\">병원 주소</label>\n+                                <input type=\"text\" id=\"address\" th:field=\"*{address}\" placeholder=\"주소를 입력해 주세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"homepage\">홈페이지</label>\n+                                <input type=\"url\" id=\"homepage\" th:field=\"*{homepage}\" placeholder=\"홈페이지 주소를 입력해 주세요\">\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"phone\">대표번호</label>\n+                                <input type=\"tel\" id=\"phone\" th:field=\"*{phone}\" placeholder=\"병원 전화번호를 입력하세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"email\">이메일</label>\n+                                <input type=\"email\" id=\"email\" th:field=\"*{email}\" placeholder=\"이메일 주소를 입력하세요\">\n+                            </div>\n+                            <div class=\"form-group\">\n+                                <label for=\"hosp-introduce\">병원 소개</label>\n+                                <textarea type=\"text\" id=\"hosp-introduce\" th:field=\"*{email}\" placeholder=\"간단한 소개글을 작성해 주세요\" required rows=\"4\" style=\"resize: none;\"></textarea>\n+                            </div>\n+                        </div>\n+                    </div>\n+                </form>\n+                <form id=\"checkboxForm\" th:object=\"${hospitalForm}\">\n+                    <div class=\"form-group\">\n+                        <label>진료 과목</label>\n+                        <div class=\"checkbox-group\">\n+                            <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n+                                <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\n+                                <label th:for=\"'spec-' + ${spec.specialtyId}\" th:text=\"${spec.category}\"></label>\n+                            </div>\n+                            <input type=\"text\" id=\"specialty\" placeholder=\"진료 과목을 입력하세요\" required>\n+                        </div>\n+                    </div>\n+                </form>\n+                <form id=\"checkboxForm\" th:object=\"${hospitalForm}\">\n+                    <div class=\"form-group\">\n+                        <label>진료 가능 동물</label>\n+                        <div class=\"category-group\">\n+                            <label th:each=\"animal : ${animalList}\" class=\"category-item\">\n+                                <input type=\"checkbox\" name=\"category\" th:field=\"*{animalIds}\" th:value=\"${animal.animalId}\" th:id=\"'animal-' + ${animal.animalId}\">\n+                                <span th:for=\"'animal-' + ${animal.animalId}\" th:text=\"${animal.species}\"></span>\n+                            </label>\n+                        </div>\n+                    </div>\n+                </form>\n+            </div>\n+        </div>\n+\n+            <!-- 삭제 form -->\n+            <div sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">\n+                <form id=\"deleteForm\" th:action=\"@{/hospitals/delete/{id}(id=${hospitalForm.hospitalId})}\" method=\"post\" style=\"display: none;\">\n+                    <input type=\"hidden\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" />\n+                </form>\n+            </div>\n+\n+            <div class=\"d-flex justify-content-center gap-2 mt-4\">\n+                <button type=\"button\" class=\"btn btn-secondary\" onclick=\"history.back()\">취소</button>\n+                <button type=\"button\" id=\"submitAllBtn\" class=\"btn btn-primary\" th:text=\"${hospitalForm.hospitalId != null ? '수정' : '등록'}\"></button>\n+                <button type=\"button\" id=\"deleteBtn\" class=\"btn btn-danger\" sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">삭제</button>\n+            </div>\n+        </div>\n+\n+\n+<script>\n+  function previewImage(event) {\n+    const input = event.target;\n+    const reader = new FileReader();\n+\n+    reader.onload = function () {\n+      const preview = document.getElementById('preview');\n+      preview.src = reader.result;\n+    };\n+\n+    if (input.files && input.files[0]) {\n+      reader.readAsDataURL(input.files[0]);\n+    }\n+  }\n+\n+\n+  // 채찍피티 버전\n+    document.addEventListener('DOMContentLoaded', function () {\n+        const submitAllBtn = document.getElementById('submitAllBtn');\n+        const imageForm = document.getElementById('imageForm');\n+        const generalDataForm = document.getElementById('generalDataForm');\n+        // const hospitalId = '[[${hospitalForm.hospitalId}]]';\n+        const hospitalId = document.getElementById('hospitalId')?.value;\n+        const isNew = !hospitalId || hospitalId === 'null' || hospitalId === '';\n+\n+        const csrfToken = document.querySelector('meta[name=\"_csrf\"]').content;\n+        const csrfHeader = document.querySelector('meta[name=\"_csrf_header\"]').content;\n+\n+        const deleteBtn = document.getElementById('deleteBtn');\n+        if (deleteBtn) {\n+            deleteBtn.addEventListener('click', function() {\n+                if (confirm('정말로 이 병원을 삭제하시겠습니까?')) {\n+                    document.getElementById('deleteForm').submit();\n+                }\n+            });\n+        }\n+\n+        submitAllBtn.addEventListener('click', async function (event) {\n+            event.preventDefault();\n+\n+            const formData = new FormData();\n+\n+            // 1. 일반 입력값 병합\n+            const generalFormData = new FormData(generalDataForm);\n+            for (const [key, value] of generalFormData.entries()) {\n+                formData.append(key, value);\n+            }\n+\n+            // 2. 이미지 파일 업로드 및 URL 병합\n+            const imageFileInput = imageForm.querySelector('#fileInput');\n+            if (imageFileInput && imageFileInput.files.length > 0) {\n+                const imageUploadFormData = new FormData();\n+                imageUploadFormData.append('image', imageFileInput.files[0]);\n+\n+                try {\n+                    const uploadResponse = await fetch('/upload/image', {\n+                        method: 'POST',\n+                        headers: {\n+                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n+                        },\n+                        body: imageUploadFormData\n+                    });\n+\n+                    if (uploadResponse.ok) {\n+                        const uploadResult = await uploadResponse.json();\n+                        if (uploadResult.success === 1) {\n+                            formData.append('thumbnailImageUrl', uploadResult.imageUrl);\n+                        } else {\n+                            alert('이미지 업로드 실패: ' + uploadResult.message);\n+                            return; // 이미지 업로드 실패 시 전체 제출 중단\n+                        }\n+                    } else {\n+                        const errorText = await uploadResponse.text();\n+                        console.error('이미지 업로드 실패:', errorText);\n+                        alert('이미지 업로드를 실패하였습니다.');\n+                        return; // 이미지 업로드 실패 시 전체 제출 중단\n+                    }\n+                } catch (error) {\n+                    console.error('이미지 업로드 중 오류:', error);\n+                    alert('이미지 업로드 중 오류가 발생했습니다.');\n+                    return; // 이미지 업로드 실패 시 전체 제출 중단\n+                }\n+            }\n+\n+            // 3. 전송\n+            const actionUrl = isNew ? '/hospitals/new' : '/hospitals/edit';\n+\n+            try {\n+                const response = await fetch(actionUrl, {\n+                    method: 'POST',\n+                    headers: {\n+                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n+                        },\n+                    body: formData\n+                });\n+\n+                if (response.ok) {\n+                    const result = await response.json();\n+                    alert('병원 정보가 성공적으로 제출되었습니다!');\n+                    window.location.href = '/hospitals';\n+                } else {\n+                    const errorText = await response.text();\n+                    console.error('제출 실패:', errorText);\n+                    alert('제출에 실패했습니다: ' + errorText);\n+                }\n+            } catch (error) {\n+                console.error('제출 중 오류:', error);\n+                alert('제출 중 오류가 발생했습니다.');\n+            }\n+        });\n+    });\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+  // 잼민이 버전\n+//   document.addEventListener('DOMContentLoaded', function() {\n+//     const submitAllBtn = document.getElementById('submitAllBtn');\n+//     const generalDataForm = document.getElementById('generalDataForm');\n+//     const fileUploadForm = document.getElementById('fileUploadForm'); // fileUploadForm 참조 추가\n+//     const hospitalId = '[[${hospitalForm.hospitalId}]]'; // Thymeleaf 변수 사용\n+\n+//     submitAllBtn.addEventListener('click', async function(event) {\n+//       event.preventDefault(); // 기본 폼 제출 방지\n+\n+//       const formData = new FormData(generalDataForm); // generalDataForm의 데이터로 FormData 초기화\n+//       const fileInput = fileUploadForm.querySelector('#fileInput'); // fileUploadForm에서 fileInput 가져오기\n+//       if (fileInput && fileInput.files && fileInput.files[0]) {\n+//         formData.append('thumbnailImageFile', fileInput.files[0]);\n+//       }\n+\n+//       // 폼 액션 URL 결정\n+//       const actionUrl = hospitalId === 'null' ? '/hospitals/new' : '/hospitals/edit';\n+\n+//       try {\n+//         const response = await fetch(actionUrl, {\n+//                                                     method: 'POST',\n+//                                                     body: formData\n+//                                                 });\n+\n+//         if (response.ok) {\n+//           const result = await response.json(); // 또는 response.text()\n+//           console.log('Submission successful:', result);\n+//           alert('병원 정보가 성공적으로 제출되었습니다!');\n+//           // 성공 후 리다이렉트 또는 다른 작업 수행\n+//           window.location.href = '/hospitals'; // 예시: 병원 목록 페이지로 이동\n+//         } else {\n+//           const errorText = await response.text();\n+//           console.error('Submission failed:', response.status, errorText);\n+//           alert('병원 정보 제출에 실패했습니다: ' + errorText);\n+//         }\n+//       } catch (error) {\n+//         console.error('Error during submission:', error);\n+//         alert('병원 정보 제출 중 오류가 발생했습니다.');\n+//       }\n+//     });\n+//   });\n+</script>\n+\n+\n+    <th:block th:replace=\"~{/fragments/footer :: footer}\"></th:block>\n+    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q\" crossorigin=\"anonymous\"></script>\n+</body>\n+</html>\n\\ No newline at end of file\n"
                },
                {
                    "date": 1751989248211,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,300 @@\n+<!DOCTYPE html>\n+<html lang=\"ko\" xmlns:th=\"http://www.thymeleaf.org\" xmlns:sec=\"http://www.thymeleaf.org/thymeleaf-extras-springsecurity5\">\n+<head>\n+    <meta charset=\"UTF-8\">\n+    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n+    <meta name=\"_csrf\" th:content=\"${_csrf.token}\" />\n+    <meta name=\"_csrf_header\" th:content=\"${_csrf.headerName}\" />\n+\n+    <title>병원 등록</title>\n+    <!-- Bootstrap CSS -->\n+    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\">\n+    <!-- Font Awesome CSS -->\n+    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css\">\n+    <link rel=\"stylesheet\" th:href=\"@{/css/hospital_style.css}\">\n+</head>\n+<body>\n+    <th:block th:replace=\"~{/fragments/header :: header}\"></th:block>\n+    <div class=\"hospital-main-container\">\n+        <!-- 상단 로고 -->\n+        <div class=\"logo-container\">\n+            <div class=\"logo\">\n+                <img th:src=\"@{/img/hosp_logo.png}\" alt=\"병원 아이콘\" class=\"logo-icon\">\n+            </div>\n+        </div>\n+\n+        <!-- 메인 컨텐츠 -->\n+        <div class=\"main-content\">\n+                        <!-- Hidden form for multipart file upload  잼민이버전-->\n+            <!-- <form id=\"fileUploadForm\" style=\"display: none;\" enctype=\"multipart/form-data\">\n+                <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" onchange=\"previewImage(event)\">\n+            </form> -->\n+\n+            <!-- 채찍피티 버전 -->\n+            <div class=\"d-flex justify-content-around align-items-start gap-20\">\n+\n+                <form id=\"imageForm\" enctype=\"multipart/form-data\">\n+                    <div class=\"image-upload-section\">\n+                        <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n+                            <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n+                        </div>\n+                        <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" style=\"display: none;\" onchange=\"previewImage(event)\">\n+                    </div>\n+                </form>\n+\n+\n+                <!-- Main form for general data -->\n+                <form id=\"generalDataForm\" th:object=\"${hospitalForm}\">\n+                    <input type=\"hidden\" id=\"hospitalId\" th:field=\"*{hospitalId}\" />\n+                    <!-- <input type=\"hidden\" id=\"csrfTokenGeneral\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" /> -->\n+\n+                    <div class=\"form-container\">\n+                        <!-- <div class=\"image-upload-section\">\n+                            <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n+                                <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n+                            </div>\n+                        </div> -->\n+\n+                        <div class=\"form-section\">\n+                            <div class=\"form-group\">\n+                                <label for=\"name\">병원 이름</label>\n+                                <input type=\"text\" id=\"name\" th:field=\"*{name}\" placeholder=\"병원 이름을 작성하세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"address\">병원 주소</label>\n+                                <input type=\"text\" id=\"address\" th:field=\"*{address}\" placeholder=\"주소를 입력해 주세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"homepage\">홈페이지</label>\n+                                <input type=\"url\" id=\"homepage\" th:field=\"*{homepage}\" placeholder=\"홈페이지 주소를 입력해 주세요\">\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"phone\">대표번호</label>\n+                                <input type=\"tel\" id=\"phone\" th:field=\"*{phone}\" placeholder=\"병원 전화번호를 입력하세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"email\">이메일</label>\n+                                <input type=\"email\" id=\"email\" th:field=\"*{email}\" placeholder=\"이메일 주소를 입력하세요\">\n+                            </div>\n+                            <div class=\"form-group\">\n+                                <label for=\"hosp-introduce\">병원 소개</label>\n+                                <textarea type=\"text\" id=\"hosp-introduce\" th:field=\"*{email}\" placeholder=\"간단한 소개글을 작성해 주세요\" required rows=\"4\" style=\"resize: none;\"></textarea>\n+                            </div>\n+                        </div>\n+                    </div>\n+                </form>\n+                <form id=\"checkSpecialForm\" th:object=\"${hospitalForm}\">\n+                    <div class=\"form-group\">\n+                        <label>진료 과목</label>\n+                        <div class=\"checkbox-group\">\n+                            <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n+                                <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\n+                                <label th:for=\"'spec-' + ${spec.specialtyId}\" th:text=\"${spec.category}\"></label>\n+                            </div>\n+                            <input type=\"text\" id=\"specialty\" placeholder=\"진료 과목을 입력하세요\" required>\n+                        </div>\n+                    </div>\n+                </form>\n+                <form id=\"checkAnimalForm\" th:object=\"${hospitalForm}\">\n+                    <div class=\"form-group\">\n+                        <label>진료 가능 동물</label>\n+                        <div class=\"category-group\">\n+                            <label th:each=\"animal : ${animalList}\" class=\"category-item\">\n+                                <input type=\"checkbox\" name=\"category\" th:field=\"*{animalIds}\" th:value=\"${animal.animalId}\" th:id=\"'animal-' + ${animal.animalId}\">\n+                                <span th:for=\"'animal-' + ${animal.animalId}\" th:text=\"${animal.species}\"></span>\n+                            </label>\n+                        </div>\n+                    </div>\n+                </form>\n+            </div>\n+        </div>\n+\n+            <!-- 삭제 form -->\n+            <div sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">\n+                <form id=\"deleteForm\" th:action=\"@{/hospitals/delete/{id}(id=${hospitalForm.hospitalId})}\" method=\"post\" style=\"display: none;\">\n+                    <input type=\"hidden\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" />\n+                </form>\n+            </div>\n+\n+            <div class=\"d-flex justify-content-center gap-2 mt-4\">\n+                <button type=\"button\" class=\"btn btn-secondary\" onclick=\"history.back()\">취소</button>\n+                <button type=\"button\" id=\"submitAllBtn\" class=\"btn btn-primary\" th:text=\"${hospitalForm.hospitalId != null ? '수정' : '등록'}\"></button>\n+                <button type=\"button\" id=\"deleteBtn\" class=\"btn btn-danger\" sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">삭제</button>\n+            </div>\n+        </div>\n+\n+\n+<script>\n+  function previewImage(event) {\n+    const input = event.target;\n+    const reader = new FileReader();\n+\n+    reader.onload = function () {\n+      const preview = document.getElementById('preview');\n+      preview.src = reader.result;\n+    };\n+\n+    if (input.files && input.files[0]) {\n+      reader.readAsDataURL(input.files[0]);\n+    }\n+  }\n+\n+\n+  // 채찍피티 버전\n+    document.addEventListener('DOMContentLoaded', function () {\n+        const submitAllBtn = document.getElementById('submitAllBtn');\n+        const imageForm = document.getElementById('imageForm');\n+        const generalDataForm = document.getElementById('generalDataForm');\n+        // const hospitalId = '[[${hospitalForm.hospitalId}]]';\n+        const hospitalId = document.getElementById('hospitalId')?.value;\n+        const isNew = !hospitalId || hospitalId === 'null' || hospitalId === '';\n+\n+        const csrfToken = document.querySelector('meta[name=\"_csrf\"]').content;\n+        const csrfHeader = document.querySelector('meta[name=\"_csrf_header\"]').content;\n+\n+        const deleteBtn = document.getElementById('deleteBtn');\n+        if (deleteBtn) {\n+            deleteBtn.addEventListener('click', function() {\n+                if (confirm('정말로 이 병원을 삭제하시겠습니까?')) {\n+                    document.getElementById('deleteForm').submit();\n+                }\n+            });\n+        }\n+\n+        submitAllBtn.addEventListener('click', async function (event) {\n+            event.preventDefault();\n+\n+            const formData = new FormData();\n+\n+            // 1. 일반 입력값 병합\n+            const generalFormData = new FormData(generalDataForm);\n+            for (const [key, value] of generalFormData.entries()) {\n+                formData.append(key, value);\n+            }\n+\n+            // 2. 이미지 파일 업로드 및 URL 병합\n+            const imageFileInput = imageForm.querySelector('#fileInput');\n+            if (imageFileInput && imageFileInput.files.length > 0) {\n+                const imageUploadFormData = new FormData();\n+                imageUploadFormData.append('image', imageFileInput.files[0]);\n+\n+                try {\n+                    const uploadResponse = await fetch('/upload/image', {\n+                        method: 'POST',\n+                        headers: {\n+                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n+                        },\n+                        body: imageUploadFormData\n+                    });\n+\n+                    if (uploadResponse.ok) {\n+                        const uploadResult = await uploadResponse.json();\n+                        if (uploadResult.success === 1) {\n+                            formData.append('thumbnailImageUrl', uploadResult.imageUrl);\n+                        } else {\n+                            alert('이미지 업로드 실패: ' + uploadResult.message);\n+                            return; // 이미지 업로드 실패 시 전체 제출 중단\n+                        }\n+                    } else {\n+                        const errorText = await uploadResponse.text();\n+                        console.error('이미지 업로드 실패:', errorText);\n+                        alert('이미지 업로드를 실패하였습니다.');\n+                        return; // 이미지 업로드 실패 시 전체 제출 중단\n+                    }\n+                } catch (error) {\n+                    console.error('이미지 업로드 중 오류:', error);\n+                    alert('이미지 업로드 중 오류가 발생했습니다.');\n+                    return; // 이미지 업로드 실패 시 전체 제출 중단\n+                }\n+            }\n+\n+            // 3. 전송\n+            const actionUrl = isNew ? '/hospitals/new' : '/hospitals/edit';\n+\n+            try {\n+                const response = await fetch(actionUrl, {\n+                    method: 'POST',\n+                    headers: {\n+                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n+                        },\n+                    body: formData\n+                });\n+\n+                if (response.ok) {\n+                    const result = await response.json();\n+                    alert('병원 정보가 성공적으로 제출되었습니다!');\n+                    window.location.href = '/hospitals';\n+                } else {\n+                    const errorText = await response.text();\n+                    console.error('제출 실패:', errorText);\n+                    alert('제출에 실패했습니다: ' + errorText);\n+                }\n+            } catch (error) {\n+                console.error('제출 중 오류:', error);\n+                alert('제출 중 오류가 발생했습니다.');\n+            }\n+        });\n+    });\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+  // 잼민이 버전\n+//   document.addEventListener('DOMContentLoaded', function() {\n+//     const submitAllBtn = document.getElementById('submitAllBtn');\n+//     const generalDataForm = document.getElementById('generalDataForm');\n+//     const fileUploadForm = document.getElementById('fileUploadForm'); // fileUploadForm 참조 추가\n+//     const hospitalId = '[[${hospitalForm.hospitalId}]]'; // Thymeleaf 변수 사용\n+\n+//     submitAllBtn.addEventListener('click', async function(event) {\n+//       event.preventDefault(); // 기본 폼 제출 방지\n+\n+//       const formData = new FormData(generalDataForm); // generalDataForm의 데이터로 FormData 초기화\n+//       const fileInput = fileUploadForm.querySelector('#fileInput'); // fileUploadForm에서 fileInput 가져오기\n+//       if (fileInput && fileInput.files && fileInput.files[0]) {\n+//         formData.append('thumbnailImageFile', fileInput.files[0]);\n+//       }\n+\n+//       // 폼 액션 URL 결정\n+//       const actionUrl = hospitalId === 'null' ? '/hospitals/new' : '/hospitals/edit';\n+\n+//       try {\n+//         const response = await fetch(actionUrl, {\n+//                                                     method: 'POST',\n+//                                                     body: formData\n+//                                                 });\n+\n+//         if (response.ok) {\n+//           const result = await response.json(); // 또는 response.text()\n+//           console.log('Submission successful:', result);\n+//           alert('병원 정보가 성공적으로 제출되었습니다!');\n+//           // 성공 후 리다이렉트 또는 다른 작업 수행\n+//           window.location.href = '/hospitals'; // 예시: 병원 목록 페이지로 이동\n+//         } else {\n+//           const errorText = await response.text();\n+//           console.error('Submission failed:', response.status, errorText);\n+//           alert('병원 정보 제출에 실패했습니다: ' + errorText);\n+//         }\n+//       } catch (error) {\n+//         console.error('Error during submission:', error);\n+//         alert('병원 정보 제출 중 오류가 발생했습니다.');\n+//       }\n+//     });\n+//   });\n+</script>\n+\n+\n+    <th:block th:replace=\"~{/fragments/footer :: footer}\"></th:block>\n+    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q\" crossorigin=\"anonymous\"></script>\n+</body>\n+</html>\n\\ No newline at end of file\n"
                },
                {
                    "date": 1751989342264,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,300 @@\n+<!DOCTYPE html>\n+<html lang=\"ko\" xmlns:th=\"http://www.thymeleaf.org\" xmlns:sec=\"http://www.thymeleaf.org/thymeleaf-extras-springsecurity5\">\n+<head>\n+    <meta charset=\"UTF-8\">\n+    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n+    <meta name=\"_csrf\" th:content=\"${_csrf.token}\" />\n+    <meta name=\"_csrf_header\" th:content=\"${_csrf.headerName}\" />\n+\n+    <title>병원 등록</title>\n+    <!-- Bootstrap CSS -->\n+    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\">\n+    <!-- Font Awesome CSS -->\n+    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css\">\n+    <link rel=\"stylesheet\" th:href=\"@{/css/hospital_style.css}\">\n+</head>\n+<body>\n+    <th:block th:replace=\"~{/fragments/header :: header}\"></th:block>\n+    <div class=\"hospital-main-container\">\n+        <!-- 상단 로고 -->\n+        <div class=\"logo-container\">\n+            <div class=\"logo\">\n+                <img th:src=\"@{/img/hosp_logo.png}\" alt=\"병원 아이콘\" class=\"logo-icon\">\n+            </div>\n+        </div>\n+\n+        <!-- 메인 컨텐츠 -->\n+        <div class=\"main-content d-flex flex-column align-items-center\">\n+                        <!-- Hidden form for multipart file upload  잼민이버전-->\n+            <!-- <form id=\"fileUploadForm\" style=\"display: none;\" enctype=\"multipart/form-data\">\n+                <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" onchange=\"previewImage(event)\">\n+            </form> -->\n+\n+            <!-- 채찍피티 버전 -->\n+            <div class=\"d-flex justify-content-around align-items-start gap-20\">\n+\n+                <form id=\"imageForm\" enctype=\"multipart/form-data\">\n+                    <div class=\"image-upload-section\">\n+                        <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n+                            <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n+                        </div>\n+                        <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" style=\"display: none;\" onchange=\"previewImage(event)\">\n+                    </div>\n+                </form>\n+\n+\n+                <!-- Main form for general data -->\n+                <form id=\"generalDataForm\" th:object=\"${hospitalForm}\">\n+                    <input type=\"hidden\" id=\"hospitalId\" th:field=\"*{hospitalId}\" />\n+                    <!-- <input type=\"hidden\" id=\"csrfTokenGeneral\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" /> -->\n+\n+                    <div class=\"form-container\">\n+                        <!-- <div class=\"image-upload-section\">\n+                            <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n+                                <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n+                            </div>\n+                        </div> -->\n+\n+                        <div class=\"form-section\">\n+                            <div class=\"form-group\">\n+                                <label for=\"name\">병원 이름</label>\n+                                <input type=\"text\" id=\"name\" th:field=\"*{name}\" placeholder=\"병원 이름을 작성하세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"address\">병원 주소</label>\n+                                <input type=\"text\" id=\"address\" th:field=\"*{address}\" placeholder=\"주소를 입력해 주세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"homepage\">홈페이지</label>\n+                                <input type=\"url\" id=\"homepage\" th:field=\"*{homepage}\" placeholder=\"홈페이지 주소를 입력해 주세요\">\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"phone\">대표번호</label>\n+                                <input type=\"tel\" id=\"phone\" th:field=\"*{phone}\" placeholder=\"병원 전화번호를 입력하세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"email\">이메일</label>\n+                                <input type=\"email\" id=\"email\" th:field=\"*{email}\" placeholder=\"이메일 주소를 입력하세요\">\n+                            </div>\n+                            <div class=\"form-group\">\n+                                <label for=\"hosp-introduce\">병원 소개</label>\n+                                <textarea type=\"text\" id=\"hosp-introduce\" th:field=\"*{email}\" placeholder=\"간단한 소개글을 작성해 주세요\" required rows=\"4\" style=\"resize: none;\"></textarea>\n+                            </div>\n+                        </div>\n+                    </div>\n+                </form>\n+                <form id=\"checkSpecialForm\" th:object=\"${hospitalForm}\">\n+                    <div class=\"form-group\">\n+                        <label>진료 과목</label>\n+                        <div class=\"checkbox-group\">\n+                            <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n+                                <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\n+                                <label th:for=\"'spec-' + ${spec.specialtyId}\" th:text=\"${spec.category}\"></label>\n+                            </div>\n+                            <input type=\"text\" id=\"specialty\" placeholder=\"진료 과목을 입력하세요\" required>\n+                        </div>\n+                    </div>\n+                </form>\n+                <form id=\"checkAnimalForm\" th:object=\"${hospitalForm}\">\n+                    <div class=\"form-group\">\n+                        <label>진료 가능 동물</label>\n+                        <div class=\"category-group\">\n+                            <label th:each=\"animal : ${animalList}\" class=\"category-item\">\n+                                <input type=\"checkbox\" name=\"category\" th:field=\"*{animalIds}\" th:value=\"${animal.animalId}\" th:id=\"'animal-' + ${animal.animalId}\">\n+                                <span th:for=\"'animal-' + ${animal.animalId}\" th:text=\"${animal.species}\"></span>\n+                            </label>\n+                        </div>\n+                    </div>\n+                </form>\n+            </div>\n+        </div>\n+\n+            <!-- 삭제 form -->\n+            <div sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">\n+                <form id=\"deleteForm\" th:action=\"@{/hospitals/delete/{id}(id=${hospitalForm.hospitalId})}\" method=\"post\" style=\"display: none;\">\n+                    <input type=\"hidden\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" />\n+                </form>\n+            </div>\n+\n+            <div class=\"d-flex justify-content-center gap-2 mt-4\">\n+                <button type=\"button\" class=\"btn btn-secondary\" onclick=\"history.back()\">취소</button>\n+                <button type=\"button\" id=\"submitAllBtn\" class=\"btn btn-primary\" th:text=\"${hospitalForm.hospitalId != null ? '수정' : '등록'}\"></button>\n+                <button type=\"button\" id=\"deleteBtn\" class=\"btn btn-danger\" sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">삭제</button>\n+            </div>\n+        </div>\n+\n+\n+<script>\n+  function previewImage(event) {\n+    const input = event.target;\n+    const reader = new FileReader();\n+\n+    reader.onload = function () {\n+      const preview = document.getElementById('preview');\n+      preview.src = reader.result;\n+    };\n+\n+    if (input.files && input.files[0]) {\n+      reader.readAsDataURL(input.files[0]);\n+    }\n+  }\n+\n+\n+  // 채찍피티 버전\n+    document.addEventListener('DOMContentLoaded', function () {\n+        const submitAllBtn = document.getElementById('submitAllBtn');\n+        const imageForm = document.getElementById('imageForm');\n+        const generalDataForm = document.getElementById('generalDataForm');\n+        // const hospitalId = '[[${hospitalForm.hospitalId}]]';\n+        const hospitalId = document.getElementById('hospitalId')?.value;\n+        const isNew = !hospitalId || hospitalId === 'null' || hospitalId === '';\n+\n+        const csrfToken = document.querySelector('meta[name=\"_csrf\"]').content;\n+        const csrfHeader = document.querySelector('meta[name=\"_csrf_header\"]').content;\n+\n+        const deleteBtn = document.getElementById('deleteBtn');\n+        if (deleteBtn) {\n+            deleteBtn.addEventListener('click', function() {\n+                if (confirm('정말로 이 병원을 삭제하시겠습니까?')) {\n+                    document.getElementById('deleteForm').submit();\n+                }\n+            });\n+        }\n+\n+        submitAllBtn.addEventListener('click', async function (event) {\n+            event.preventDefault();\n+\n+            const formData = new FormData();\n+\n+            // 1. 일반 입력값 병합\n+            const generalFormData = new FormData(generalDataForm);\n+            for (const [key, value] of generalFormData.entries()) {\n+                formData.append(key, value);\n+            }\n+\n+            // 2. 이미지 파일 업로드 및 URL 병합\n+            const imageFileInput = imageForm.querySelector('#fileInput');\n+            if (imageFileInput && imageFileInput.files.length > 0) {\n+                const imageUploadFormData = new FormData();\n+                imageUploadFormData.append('image', imageFileInput.files[0]);\n+\n+                try {\n+                    const uploadResponse = await fetch('/upload/image', {\n+                        method: 'POST',\n+                        headers: {\n+                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n+                        },\n+                        body: imageUploadFormData\n+                    });\n+\n+                    if (uploadResponse.ok) {\n+                        const uploadResult = await uploadResponse.json();\n+                        if (uploadResult.success === 1) {\n+                            formData.append('thumbnailImageUrl', uploadResult.imageUrl);\n+                        } else {\n+                            alert('이미지 업로드 실패: ' + uploadResult.message);\n+                            return; // 이미지 업로드 실패 시 전체 제출 중단\n+                        }\n+                    } else {\n+                        const errorText = await uploadResponse.text();\n+                        console.error('이미지 업로드 실패:', errorText);\n+                        alert('이미지 업로드를 실패하였습니다.');\n+                        return; // 이미지 업로드 실패 시 전체 제출 중단\n+                    }\n+                } catch (error) {\n+                    console.error('이미지 업로드 중 오류:', error);\n+                    alert('이미지 업로드 중 오류가 발생했습니다.');\n+                    return; // 이미지 업로드 실패 시 전체 제출 중단\n+                }\n+            }\n+\n+            // 3. 전송\n+            const actionUrl = isNew ? '/hospitals/new' : '/hospitals/edit';\n+\n+            try {\n+                const response = await fetch(actionUrl, {\n+                    method: 'POST',\n+                    headers: {\n+                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n+                        },\n+                    body: formData\n+                });\n+\n+                if (response.ok) {\n+                    const result = await response.json();\n+                    alert('병원 정보가 성공적으로 제출되었습니다!');\n+                    window.location.href = '/hospitals';\n+                } else {\n+                    const errorText = await response.text();\n+                    console.error('제출 실패:', errorText);\n+                    alert('제출에 실패했습니다: ' + errorText);\n+                }\n+            } catch (error) {\n+                console.error('제출 중 오류:', error);\n+                alert('제출 중 오류가 발생했습니다.');\n+            }\n+        });\n+    });\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+  // 잼민이 버전\n+//   document.addEventListener('DOMContentLoaded', function() {\n+//     const submitAllBtn = document.getElementById('submitAllBtn');\n+//     const generalDataForm = document.getElementById('generalDataForm');\n+//     const fileUploadForm = document.getElementById('fileUploadForm'); // fileUploadForm 참조 추가\n+//     const hospitalId = '[[${hospitalForm.hospitalId}]]'; // Thymeleaf 변수 사용\n+\n+//     submitAllBtn.addEventListener('click', async function(event) {\n+//       event.preventDefault(); // 기본 폼 제출 방지\n+\n+//       const formData = new FormData(generalDataForm); // generalDataForm의 데이터로 FormData 초기화\n+//       const fileInput = fileUploadForm.querySelector('#fileInput'); // fileUploadForm에서 fileInput 가져오기\n+//       if (fileInput && fileInput.files && fileInput.files[0]) {\n+//         formData.append('thumbnailImageFile', fileInput.files[0]);\n+//       }\n+\n+//       // 폼 액션 URL 결정\n+//       const actionUrl = hospitalId === 'null' ? '/hospitals/new' : '/hospitals/edit';\n+\n+//       try {\n+//         const response = await fetch(actionUrl, {\n+//                                                     method: 'POST',\n+//                                                     body: formData\n+//                                                 });\n+\n+//         if (response.ok) {\n+//           const result = await response.json(); // 또는 response.text()\n+//           console.log('Submission successful:', result);\n+//           alert('병원 정보가 성공적으로 제출되었습니다!');\n+//           // 성공 후 리다이렉트 또는 다른 작업 수행\n+//           window.location.href = '/hospitals'; // 예시: 병원 목록 페이지로 이동\n+//         } else {\n+//           const errorText = await response.text();\n+//           console.error('Submission failed:', response.status, errorText);\n+//           alert('병원 정보 제출에 실패했습니다: ' + errorText);\n+//         }\n+//       } catch (error) {\n+//         console.error('Error during submission:', error);\n+//         alert('병원 정보 제출 중 오류가 발생했습니다.');\n+//       }\n+//     });\n+//   });\n+</script>\n+\n+\n+    <th:block th:replace=\"~{/fragments/footer :: footer}\"></th:block>\n+    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q\" crossorigin=\"anonymous\"></script>\n+</body>\n+</html>\n\\ No newline at end of file\n"
                },
                {
                    "date": 1751989373915,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,299 @@\n+<!DOCTYPE html>\n+<html lang=\"ko\" xmlns:th=\"http://www.thymeleaf.org\" xmlns:sec=\"http://www.thymeleaf.org/thymeleaf-extras-springsecurity5\">\n+<head>\n+    <meta charset=\"UTF-8\">\n+    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n+    <meta name=\"_csrf\" th:content=\"${_csrf.token}\" />\n+    <meta name=\"_csrf_header\" th:content=\"${_csrf.headerName}\" />\n+\n+    <title>병원 등록</title>\n+    <!-- Bootstrap CSS -->\n+    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\">\n+    <!-- Font Awesome CSS -->\n+    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css\">\n+    <link rel=\"stylesheet\" th:href=\"@{/css/hospital_style.css}\">\n+</head>\n+<body>\n+    <th:block th:replace=\"~{/fragments/header :: header}\"></th:block>\n+    <div class=\"hospital-main-container\">\n+        <!-- 상단 로고 -->\n+        <div class=\"logo-container\">\n+            <div class=\"logo\">\n+                <img th:src=\"@{/img/hosp_logo.png}\" alt=\"병원 아이콘\" class=\"logo-icon\">\n+            </div>\n+        </div>\n+\n+        <!-- 메인 컨텐츠 -->\n+        <div class=\"main-content d-flex flex-column align-items-center\">\n+                        <!-- Hidden form for multipart file upload  잼민이버전-->\n+            <!-- <form id=\"fileUploadForm\" style=\"display: none;\" enctype=\"multipart/form-data\">\n+                <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" onchange=\"previewImage(event)\">\n+            </form> -->\n+\n+            <!-- 채찍피티 버전 -->\n+            <div class=\"d-flex justify-content-around align-items-start gap-20\">\n+\n+                <form id=\"imageForm\" enctype=\"multipart/form-data\">\n+                    <div class=\"image-upload-section\">\n+                        <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n+                            <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n+                        </div>\n+                        <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" style=\"display: none;\" onchange=\"previewImage(event)\">\n+                    </div>\n+                </form>\n+\n+\n+                <!-- Main form for general data -->\n+                <form id=\"generalDataForm\" th:object=\"${hospitalForm}\">\n+                    <input type=\"hidden\" id=\"hospitalId\" th:field=\"*{hospitalId}\" />\n+                    <!-- <input type=\"hidden\" id=\"csrfTokenGeneral\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" /> -->\n+\n+                    <div class=\"form-container\">\n+                        <!-- <div class=\"image-upload-section\">\n+                            <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n+                                <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n+                            </div>\n+                        </div> -->\n+\n+                        <div class=\"form-section\">\n+                            <div class=\"form-group\">\n+                                <label for=\"name\">병원 이름</label>\n+                                <input type=\"text\" id=\"name\" th:field=\"*{name}\" placeholder=\"병원 이름을 작성하세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"address\">병원 주소</label>\n+                                <input type=\"text\" id=\"address\" th:field=\"*{address}\" placeholder=\"주소를 입력해 주세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"homepage\">홈페이지</label>\n+                                <input type=\"url\" id=\"homepage\" th:field=\"*{homepage}\" placeholder=\"홈페이지 주소를 입력해 주세요\">\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"phone\">대표번호</label>\n+                                <input type=\"tel\" id=\"phone\" th:field=\"*{phone}\" placeholder=\"병원 전화번호를 입력하세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"email\">이메일</label>\n+                                <input type=\"email\" id=\"email\" th:field=\"*{email}\" placeholder=\"이메일 주소를 입력하세요\">\n+                            </div>\n+                            <div class=\"form-group\">\n+                                <label for=\"hosp-introduce\">병원 소개</label>\n+                                <textarea type=\"text\" id=\"hosp-introduce\" th:field=\"*{email}\" placeholder=\"간단한 소개글을 작성해 주세요\" required rows=\"4\" style=\"resize: none;\"></textarea>\n+                            </div>\n+                        </div>\n+                    </div>\n+                </form>\n+                <form id=\"checkSpecialForm\" th:object=\"${hospitalForm}\">\n+                    <div class=\"form-group\">\n+                        <label>진료 과목</label>\n+                        <div class=\"checkbox-group\">\n+                            <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n+                                <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\n+                                <label th:for=\"'spec-' + ${spec.specialtyId}\" th:text=\"${spec.category}\"></label>\n+                            </div>\n+                        </div>\n+                    </div>\n+                </form>\n+                <form id=\"checkAnimalForm\" th:object=\"${hospitalForm}\">\n+                    <div class=\"form-group\">\n+                        <label>진료 가능 동물</label>\n+                        <div class=\"category-group\">\n+                            <label th:each=\"animal : ${animalList}\" class=\"category-item\">\n+                                <input type=\"checkbox\" name=\"category\" th:field=\"*{animalIds}\" th:value=\"${animal.animalId}\" th:id=\"'animal-' + ${animal.animalId}\">\n+                                <span th:for=\"'animal-' + ${animal.animalId}\" th:text=\"${animal.species}\"></span>\n+                            </label>\n+                        </div>\n+                    </div>\n+                </form>\n+            </div>\n+        </div>\n+\n+            <!-- 삭제 form -->\n+            <div sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">\n+                <form id=\"deleteForm\" th:action=\"@{/hospitals/delete/{id}(id=${hospitalForm.hospitalId})}\" method=\"post\" style=\"display: none;\">\n+                    <input type=\"hidden\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" />\n+                </form>\n+            </div>\n+\n+            <div class=\"d-flex justify-content-center gap-2 mt-4\">\n+                <button type=\"button\" class=\"btn btn-secondary\" onclick=\"history.back()\">취소</button>\n+                <button type=\"button\" id=\"submitAllBtn\" class=\"btn btn-primary\" th:text=\"${hospitalForm.hospitalId != null ? '수정' : '등록'}\"></button>\n+                <button type=\"button\" id=\"deleteBtn\" class=\"btn btn-danger\" sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">삭제</button>\n+            </div>\n+        </div>\n+\n+\n+<script>\n+  function previewImage(event) {\n+    const input = event.target;\n+    const reader = new FileReader();\n+\n+    reader.onload = function () {\n+      const preview = document.getElementById('preview');\n+      preview.src = reader.result;\n+    };\n+\n+    if (input.files && input.files[0]) {\n+      reader.readAsDataURL(input.files[0]);\n+    }\n+  }\n+\n+\n+  // 채찍피티 버전\n+    document.addEventListener('DOMContentLoaded', function () {\n+        const submitAllBtn = document.getElementById('submitAllBtn');\n+        const imageForm = document.getElementById('imageForm');\n+        const generalDataForm = document.getElementById('generalDataForm');\n+        // const hospitalId = '[[${hospitalForm.hospitalId}]]';\n+        const hospitalId = document.getElementById('hospitalId')?.value;\n+        const isNew = !hospitalId || hospitalId === 'null' || hospitalId === '';\n+\n+        const csrfToken = document.querySelector('meta[name=\"_csrf\"]').content;\n+        const csrfHeader = document.querySelector('meta[name=\"_csrf_header\"]').content;\n+\n+        const deleteBtn = document.getElementById('deleteBtn');\n+        if (deleteBtn) {\n+            deleteBtn.addEventListener('click', function() {\n+                if (confirm('정말로 이 병원을 삭제하시겠습니까?')) {\n+                    document.getElementById('deleteForm').submit();\n+                }\n+            });\n+        }\n+\n+        submitAllBtn.addEventListener('click', async function (event) {\n+            event.preventDefault();\n+\n+            const formData = new FormData();\n+\n+            // 1. 일반 입력값 병합\n+            const generalFormData = new FormData(generalDataForm);\n+            for (const [key, value] of generalFormData.entries()) {\n+                formData.append(key, value);\n+            }\n+\n+            // 2. 이미지 파일 업로드 및 URL 병합\n+            const imageFileInput = imageForm.querySelector('#fileInput');\n+            if (imageFileInput && imageFileInput.files.length > 0) {\n+                const imageUploadFormData = new FormData();\n+                imageUploadFormData.append('image', imageFileInput.files[0]);\n+\n+                try {\n+                    const uploadResponse = await fetch('/upload/image', {\n+                        method: 'POST',\n+                        headers: {\n+                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n+                        },\n+                        body: imageUploadFormData\n+                    });\n+\n+                    if (uploadResponse.ok) {\n+                        const uploadResult = await uploadResponse.json();\n+                        if (uploadResult.success === 1) {\n+                            formData.append('thumbnailImageUrl', uploadResult.imageUrl);\n+                        } else {\n+                            alert('이미지 업로드 실패: ' + uploadResult.message);\n+                            return; // 이미지 업로드 실패 시 전체 제출 중단\n+                        }\n+                    } else {\n+                        const errorText = await uploadResponse.text();\n+                        console.error('이미지 업로드 실패:', errorText);\n+                        alert('이미지 업로드를 실패하였습니다.');\n+                        return; // 이미지 업로드 실패 시 전체 제출 중단\n+                    }\n+                } catch (error) {\n+                    console.error('이미지 업로드 중 오류:', error);\n+                    alert('이미지 업로드 중 오류가 발생했습니다.');\n+                    return; // 이미지 업로드 실패 시 전체 제출 중단\n+                }\n+            }\n+\n+            // 3. 전송\n+            const actionUrl = isNew ? '/hospitals/new' : '/hospitals/edit';\n+\n+            try {\n+                const response = await fetch(actionUrl, {\n+                    method: 'POST',\n+                    headers: {\n+                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n+                        },\n+                    body: formData\n+                });\n+\n+                if (response.ok) {\n+                    const result = await response.json();\n+                    alert('병원 정보가 성공적으로 제출되었습니다!');\n+                    window.location.href = '/hospitals';\n+                } else {\n+                    const errorText = await response.text();\n+                    console.error('제출 실패:', errorText);\n+                    alert('제출에 실패했습니다: ' + errorText);\n+                }\n+            } catch (error) {\n+                console.error('제출 중 오류:', error);\n+                alert('제출 중 오류가 발생했습니다.');\n+            }\n+        });\n+    });\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+  // 잼민이 버전\n+//   document.addEventListener('DOMContentLoaded', function() {\n+//     const submitAllBtn = document.getElementById('submitAllBtn');\n+//     const generalDataForm = document.getElementById('generalDataForm');\n+//     const fileUploadForm = document.getElementById('fileUploadForm'); // fileUploadForm 참조 추가\n+//     const hospitalId = '[[${hospitalForm.hospitalId}]]'; // Thymeleaf 변수 사용\n+\n+//     submitAllBtn.addEventListener('click', async function(event) {\n+//       event.preventDefault(); // 기본 폼 제출 방지\n+\n+//       const formData = new FormData(generalDataForm); // generalDataForm의 데이터로 FormData 초기화\n+//       const fileInput = fileUploadForm.querySelector('#fileInput'); // fileUploadForm에서 fileInput 가져오기\n+//       if (fileInput && fileInput.files && fileInput.files[0]) {\n+//         formData.append('thumbnailImageFile', fileInput.files[0]);\n+//       }\n+\n+//       // 폼 액션 URL 결정\n+//       const actionUrl = hospitalId === 'null' ? '/hospitals/new' : '/hospitals/edit';\n+\n+//       try {\n+//         const response = await fetch(actionUrl, {\n+//                                                     method: 'POST',\n+//                                                     body: formData\n+//                                                 });\n+\n+//         if (response.ok) {\n+//           const result = await response.json(); // 또는 response.text()\n+//           console.log('Submission successful:', result);\n+//           alert('병원 정보가 성공적으로 제출되었습니다!');\n+//           // 성공 후 리다이렉트 또는 다른 작업 수행\n+//           window.location.href = '/hospitals'; // 예시: 병원 목록 페이지로 이동\n+//         } else {\n+//           const errorText = await response.text();\n+//           console.error('Submission failed:', response.status, errorText);\n+//           alert('병원 정보 제출에 실패했습니다: ' + errorText);\n+//         }\n+//       } catch (error) {\n+//         console.error('Error during submission:', error);\n+//         alert('병원 정보 제출 중 오류가 발생했습니다.');\n+//       }\n+//     });\n+//   });\n+</script>\n+\n+\n+    <th:block th:replace=\"~{/fragments/footer :: footer}\"></th:block>\n+    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q\" crossorigin=\"anonymous\"></script>\n+</body>\n+</html>\n\\ No newline at end of file\n"
                },
                {
                    "date": 1751989472927,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -86,9 +86,9 @@\n                             </div>\n                         </div>\n                     </div>\n                 </form>\n-                <form id=\"checkSpecialForm\" th:object=\"${hospitalForm}\">\n+                <form id=\"checkSpecialForm\" th:object=\"${hospitalForm}\" class=\"d-flex flex-nowrap\">\n                     <div class=\"form-group\">\n                         <label>진료 과목</label>\n                         <div class=\"checkbox-group\">\n                             <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n"
                },
                {
                    "date": 1751989509721,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,299 @@\n+<!DOCTYPE html>\n+<html lang=\"ko\" xmlns:th=\"http://www.thymeleaf.org\" xmlns:sec=\"http://www.thymeleaf.org/thymeleaf-extras-springsecurity5\">\n+<head>\n+    <meta charset=\"UTF-8\">\n+    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n+    <meta name=\"_csrf\" th:content=\"${_csrf.token}\" />\n+    <meta name=\"_csrf_header\" th:content=\"${_csrf.headerName}\" />\n+\n+    <title>병원 등록</title>\n+    <!-- Bootstrap CSS -->\n+    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\">\n+    <!-- Font Awesome CSS -->\n+    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css\">\n+    <link rel=\"stylesheet\" th:href=\"@{/css/hospital_style.css}\">\n+</head>\n+<body>\n+    <th:block th:replace=\"~{/fragments/header :: header}\"></th:block>\n+    <div class=\"hospital-main-container\">\n+        <!-- 상단 로고 -->\n+        <div class=\"logo-container\">\n+            <div class=\"logo\">\n+                <img th:src=\"@{/img/hosp_logo.png}\" alt=\"병원 아이콘\" class=\"logo-icon\">\n+            </div>\n+        </div>\n+\n+        <!-- 메인 컨텐츠 -->\n+        <div class=\"main-content d-flex flex-column align-items-center\">\n+                        <!-- Hidden form for multipart file upload  잼민이버전-->\n+            <!-- <form id=\"fileUploadForm\" style=\"display: none;\" enctype=\"multipart/form-data\">\n+                <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" onchange=\"previewImage(event)\">\n+            </form> -->\n+\n+            <!-- 채찍피티 버전 -->\n+            <div class=\"d-flex flex-column justify-content-around align-items-start gap-20\">\n+\n+                <form id=\"imageForm\" enctype=\"multipart/form-data\">\n+                    <div class=\"image-upload-section\">\n+                        <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n+                            <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n+                        </div>\n+                        <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" style=\"display: none;\" onchange=\"previewImage(event)\">\n+                    </div>\n+                </form>\n+\n+\n+                <!-- Main form for general data -->\n+                <form id=\"generalDataForm\" th:object=\"${hospitalForm}\">\n+                    <input type=\"hidden\" id=\"hospitalId\" th:field=\"*{hospitalId}\" />\n+                    <!-- <input type=\"hidden\" id=\"csrfTokenGeneral\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" /> -->\n+\n+                    <div class=\"form-container\">\n+                        <!-- <div class=\"image-upload-section\">\n+                            <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n+                                <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n+                            </div>\n+                        </div> -->\n+\n+                        <div class=\"form-section\">\n+                            <div class=\"form-group\">\n+                                <label for=\"name\">병원 이름</label>\n+                                <input type=\"text\" id=\"name\" th:field=\"*{name}\" placeholder=\"병원 이름을 작성하세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"address\">병원 주소</label>\n+                                <input type=\"text\" id=\"address\" th:field=\"*{address}\" placeholder=\"주소를 입력해 주세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"homepage\">홈페이지</label>\n+                                <input type=\"url\" id=\"homepage\" th:field=\"*{homepage}\" placeholder=\"홈페이지 주소를 입력해 주세요\">\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"phone\">대표번호</label>\n+                                <input type=\"tel\" id=\"phone\" th:field=\"*{phone}\" placeholder=\"병원 전화번호를 입력하세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"email\">이메일</label>\n+                                <input type=\"email\" id=\"email\" th:field=\"*{email}\" placeholder=\"이메일 주소를 입력하세요\">\n+                            </div>\n+                            <div class=\"form-group\">\n+                                <label for=\"hosp-introduce\">병원 소개</label>\n+                                <textarea type=\"text\" id=\"hosp-introduce\" th:field=\"*{email}\" placeholder=\"간단한 소개글을 작성해 주세요\" required rows=\"4\" style=\"resize: none;\"></textarea>\n+                            </div>\n+                        </div>\n+                    </div>\n+                </form>\n+                <form id=\"checkSpecialForm\" th:object=\"${hospitalForm}\" class=\"d-flex flex-nowrap\">\n+                    <div class=\"form-group\">\n+                        <label>진료 과목</label>\n+                        <div class=\"checkbox-group\">\n+                            <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n+                                <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\n+                                <label th:for=\"'spec-' + ${spec.specialtyId}\" th:text=\"${spec.category}\"></label>\n+                            </div>\n+                        </div>\n+                    </div>\n+                </form>\n+                <form id=\"checkAnimalForm\" th:object=\"${hospitalForm}\">\n+                    <div class=\"form-group\">\n+                        <label>진료 가능 동물</label>\n+                        <div class=\"category-group\">\n+                            <label th:each=\"animal : ${animalList}\" class=\"category-item\">\n+                                <input type=\"checkbox\" name=\"category\" th:field=\"*{animalIds}\" th:value=\"${animal.animalId}\" th:id=\"'animal-' + ${animal.animalId}\">\n+                                <span th:for=\"'animal-' + ${animal.animalId}\" th:text=\"${animal.species}\"></span>\n+                            </label>\n+                        </div>\n+                    </div>\n+                </form>\n+            </div>\n+        </div>\n+\n+            <!-- 삭제 form -->\n+            <div sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">\n+                <form id=\"deleteForm\" th:action=\"@{/hospitals/delete/{id}(id=${hospitalForm.hospitalId})}\" method=\"post\" style=\"display: none;\">\n+                    <input type=\"hidden\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" />\n+                </form>\n+            </div>\n+\n+            <div class=\"d-flex justify-content-center gap-2 mt-4\">\n+                <button type=\"button\" class=\"btn btn-secondary\" onclick=\"history.back()\">취소</button>\n+                <button type=\"button\" id=\"submitAllBtn\" class=\"btn btn-primary\" th:text=\"${hospitalForm.hospitalId != null ? '수정' : '등록'}\"></button>\n+                <button type=\"button\" id=\"deleteBtn\" class=\"btn btn-danger\" sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">삭제</button>\n+            </div>\n+        </div>\n+\n+\n+<script>\n+  function previewImage(event) {\n+    const input = event.target;\n+    const reader = new FileReader();\n+\n+    reader.onload = function () {\n+      const preview = document.getElementById('preview');\n+      preview.src = reader.result;\n+    };\n+\n+    if (input.files && input.files[0]) {\n+      reader.readAsDataURL(input.files[0]);\n+    }\n+  }\n+\n+\n+  // 채찍피티 버전\n+    document.addEventListener('DOMContentLoaded', function () {\n+        const submitAllBtn = document.getElementById('submitAllBtn');\n+        const imageForm = document.getElementById('imageForm');\n+        const generalDataForm = document.getElementById('generalDataForm');\n+        // const hospitalId = '[[${hospitalForm.hospitalId}]]';\n+        const hospitalId = document.getElementById('hospitalId')?.value;\n+        const isNew = !hospitalId || hospitalId === 'null' || hospitalId === '';\n+\n+        const csrfToken = document.querySelector('meta[name=\"_csrf\"]').content;\n+        const csrfHeader = document.querySelector('meta[name=\"_csrf_header\"]').content;\n+\n+        const deleteBtn = document.getElementById('deleteBtn');\n+        if (deleteBtn) {\n+            deleteBtn.addEventListener('click', function() {\n+                if (confirm('정말로 이 병원을 삭제하시겠습니까?')) {\n+                    document.getElementById('deleteForm').submit();\n+                }\n+            });\n+        }\n+\n+        submitAllBtn.addEventListener('click', async function (event) {\n+            event.preventDefault();\n+\n+            const formData = new FormData();\n+\n+            // 1. 일반 입력값 병합\n+            const generalFormData = new FormData(generalDataForm);\n+            for (const [key, value] of generalFormData.entries()) {\n+                formData.append(key, value);\n+            }\n+\n+            // 2. 이미지 파일 업로드 및 URL 병합\n+            const imageFileInput = imageForm.querySelector('#fileInput');\n+            if (imageFileInput && imageFileInput.files.length > 0) {\n+                const imageUploadFormData = new FormData();\n+                imageUploadFormData.append('image', imageFileInput.files[0]);\n+\n+                try {\n+                    const uploadResponse = await fetch('/upload/image', {\n+                        method: 'POST',\n+                        headers: {\n+                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n+                        },\n+                        body: imageUploadFormData\n+                    });\n+\n+                    if (uploadResponse.ok) {\n+                        const uploadResult = await uploadResponse.json();\n+                        if (uploadResult.success === 1) {\n+                            formData.append('thumbnailImageUrl', uploadResult.imageUrl);\n+                        } else {\n+                            alert('이미지 업로드 실패: ' + uploadResult.message);\n+                            return; // 이미지 업로드 실패 시 전체 제출 중단\n+                        }\n+                    } else {\n+                        const errorText = await uploadResponse.text();\n+                        console.error('이미지 업로드 실패:', errorText);\n+                        alert('이미지 업로드를 실패하였습니다.');\n+                        return; // 이미지 업로드 실패 시 전체 제출 중단\n+                    }\n+                } catch (error) {\n+                    console.error('이미지 업로드 중 오류:', error);\n+                    alert('이미지 업로드 중 오류가 발생했습니다.');\n+                    return; // 이미지 업로드 실패 시 전체 제출 중단\n+                }\n+            }\n+\n+            // 3. 전송\n+            const actionUrl = isNew ? '/hospitals/new' : '/hospitals/edit';\n+\n+            try {\n+                const response = await fetch(actionUrl, {\n+                    method: 'POST',\n+                    headers: {\n+                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n+                        },\n+                    body: formData\n+                });\n+\n+                if (response.ok) {\n+                    const result = await response.json();\n+                    alert('병원 정보가 성공적으로 제출되었습니다!');\n+                    window.location.href = '/hospitals';\n+                } else {\n+                    const errorText = await response.text();\n+                    console.error('제출 실패:', errorText);\n+                    alert('제출에 실패했습니다: ' + errorText);\n+                }\n+            } catch (error) {\n+                console.error('제출 중 오류:', error);\n+                alert('제출 중 오류가 발생했습니다.');\n+            }\n+        });\n+    });\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+  // 잼민이 버전\n+//   document.addEventListener('DOMContentLoaded', function() {\n+//     const submitAllBtn = document.getElementById('submitAllBtn');\n+//     const generalDataForm = document.getElementById('generalDataForm');\n+//     const fileUploadForm = document.getElementById('fileUploadForm'); // fileUploadForm 참조 추가\n+//     const hospitalId = '[[${hospitalForm.hospitalId}]]'; // Thymeleaf 변수 사용\n+\n+//     submitAllBtn.addEventListener('click', async function(event) {\n+//       event.preventDefault(); // 기본 폼 제출 방지\n+\n+//       const formData = new FormData(generalDataForm); // generalDataForm의 데이터로 FormData 초기화\n+//       const fileInput = fileUploadForm.querySelector('#fileInput'); // fileUploadForm에서 fileInput 가져오기\n+//       if (fileInput && fileInput.files && fileInput.files[0]) {\n+//         formData.append('thumbnailImageFile', fileInput.files[0]);\n+//       }\n+\n+//       // 폼 액션 URL 결정\n+//       const actionUrl = hospitalId === 'null' ? '/hospitals/new' : '/hospitals/edit';\n+\n+//       try {\n+//         const response = await fetch(actionUrl, {\n+//                                                     method: 'POST',\n+//                                                     body: formData\n+//                                                 });\n+\n+//         if (response.ok) {\n+//           const result = await response.json(); // 또는 response.text()\n+//           console.log('Submission successful:', result);\n+//           alert('병원 정보가 성공적으로 제출되었습니다!');\n+//           // 성공 후 리다이렉트 또는 다른 작업 수행\n+//           window.location.href = '/hospitals'; // 예시: 병원 목록 페이지로 이동\n+//         } else {\n+//           const errorText = await response.text();\n+//           console.error('Submission failed:', response.status, errorText);\n+//           alert('병원 정보 제출에 실패했습니다: ' + errorText);\n+//         }\n+//       } catch (error) {\n+//         console.error('Error during submission:', error);\n+//         alert('병원 정보 제출 중 오류가 발생했습니다.');\n+//       }\n+//     });\n+//   });\n+</script>\n+\n+\n+    <th:block th:replace=\"~{/fragments/footer :: footer}\"></th:block>\n+    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q\" crossorigin=\"anonymous\"></script>\n+</body>\n+</html>\n\\ No newline at end of file\n"
                },
                {
                    "date": 1751989575312,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,299 @@\n+<!DOCTYPE html>\n+<html lang=\"ko\" xmlns:th=\"http://www.thymeleaf.org\" xmlns:sec=\"http://www.thymeleaf.org/thymeleaf-extras-springsecurity5\">\n+<head>\n+    <meta charset=\"UTF-8\">\n+    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n+    <meta name=\"_csrf\" th:content=\"${_csrf.token}\" />\n+    <meta name=\"_csrf_header\" th:content=\"${_csrf.headerName}\" />\n+\n+    <title>병원 등록</title>\n+    <!-- Bootstrap CSS -->\n+    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\">\n+    <!-- Font Awesome CSS -->\n+    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css\">\n+    <link rel=\"stylesheet\" th:href=\"@{/css/hospital_style.css}\">\n+</head>\n+<body>\n+    <th:block th:replace=\"~{/fragments/header :: header}\"></th:block>\n+    <div class=\"hospital-main-container\">\n+        <!-- 상단 로고 -->\n+        <div class=\"logo-container\">\n+            <div class=\"logo\">\n+                <img th:src=\"@{/img/hosp_logo.png}\" alt=\"병원 아이콘\" class=\"logo-icon\">\n+            </div>\n+        </div>\n+\n+        <!-- 메인 컨텐츠 -->\n+        <div class=\"main-content d-flex flex-column align-items-center\">\n+                        <!-- Hidden form for multipart file upload  잼민이버전-->\n+            <!-- <form id=\"fileUploadForm\" style=\"display: none;\" enctype=\"multipart/form-data\">\n+                <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" onchange=\"previewImage(event)\">\n+            </form> -->\n+\n+            <!-- 채찍피티 버전 -->\n+            <div class=\"d-flex justify-content-between align-items-start gap-5\">\n+\n+                <form id=\"imageForm\" enctype=\"multipart/form-data\">\n+                    <div class=\"image-upload-section\">\n+                        <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n+                            <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n+                        </div>\n+                        <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" style=\"display: none;\" onchange=\"previewImage(event)\">\n+                    </div>\n+                </form>\n+\n+\n+                <!-- Main form for general data -->\n+                <form id=\"generalDataForm\" th:object=\"${hospitalForm}\">\n+                    <input type=\"hidden\" id=\"hospitalId\" th:field=\"*{hospitalId}\" />\n+                    <!-- <input type=\"hidden\" id=\"csrfTokenGeneral\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" /> -->\n+\n+                    <div class=\"form-container\">\n+                        <!-- <div class=\"image-upload-section\">\n+                            <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n+                                <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n+                            </div>\n+                        </div> -->\n+\n+                        <div class=\"form-section\">\n+                            <div class=\"form-group\">\n+                                <label for=\"name\">병원 이름</label>\n+                                <input type=\"text\" id=\"name\" th:field=\"*{name}\" placeholder=\"병원 이름을 작성하세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"address\">병원 주소</label>\n+                                <input type=\"text\" id=\"address\" th:field=\"*{address}\" placeholder=\"주소를 입력해 주세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"homepage\">홈페이지</label>\n+                                <input type=\"url\" id=\"homepage\" th:field=\"*{homepage}\" placeholder=\"홈페이지 주소를 입력해 주세요\">\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"phone\">대표번호</label>\n+                                <input type=\"tel\" id=\"phone\" th:field=\"*{phone}\" placeholder=\"병원 전화번호를 입력하세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"email\">이메일</label>\n+                                <input type=\"email\" id=\"email\" th:field=\"*{email}\" placeholder=\"이메일 주소를 입력하세요\">\n+                            </div>\n+                            <div class=\"form-group\">\n+                                <label for=\"hosp-introduce\">병원 소개</label>\n+                                <textarea type=\"text\" id=\"hosp-introduce\" th:field=\"*{email}\" placeholder=\"간단한 소개글을 작성해 주세요\" required rows=\"4\" style=\"resize: none;\"></textarea>\n+                            </div>\n+                        </div>\n+                    </div>\n+                </form>\n+                <form id=\"checkSpecialForm\" th:object=\"${hospitalForm}\" class=\"d-flex flex-nowrap\">\n+                    <div class=\"form-group\">\n+                        <label>진료 과목</label>\n+                        <div class=\"checkbox-group\">\n+                            <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n+                                <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\n+                                <label th:for=\"'spec-' + ${spec.specialtyId}\" th:text=\"${spec.category}\"></label>\n+                            </div>\n+                        </div>\n+                    </div>\n+                </form>\n+                <form id=\"checkAnimalForm\" th:object=\"${hospitalForm}\">\n+                    <div class=\"form-group\">\n+                        <label>진료 가능 동물</label>\n+                        <div class=\"category-group\">\n+                            <label th:each=\"animal : ${animalList}\" class=\"category-item\">\n+                                <input type=\"checkbox\" name=\"category\" th:field=\"*{animalIds}\" th:value=\"${animal.animalId}\" th:id=\"'animal-' + ${animal.animalId}\">\n+                                <span th:for=\"'animal-' + ${animal.animalId}\" th:text=\"${animal.species}\"></span>\n+                            </label>\n+                        </div>\n+                    </div>\n+                </form>\n+            </div>\n+        </div>\n+\n+            <!-- 삭제 form -->\n+            <div sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">\n+                <form id=\"deleteForm\" th:action=\"@{/hospitals/delete/{id}(id=${hospitalForm.hospitalId})}\" method=\"post\" style=\"display: none;\">\n+                    <input type=\"hidden\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" />\n+                </form>\n+            </div>\n+\n+            <div class=\"d-flex justify-content-center gap-2 mt-4\">\n+                <button type=\"button\" class=\"btn btn-secondary\" onclick=\"history.back()\">취소</button>\n+                <button type=\"button\" id=\"submitAllBtn\" class=\"btn btn-primary\" th:text=\"${hospitalForm.hospitalId != null ? '수정' : '등록'}\"></button>\n+                <button type=\"button\" id=\"deleteBtn\" class=\"btn btn-danger\" sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">삭제</button>\n+            </div>\n+        </div>\n+\n+\n+<script>\n+  function previewImage(event) {\n+    const input = event.target;\n+    const reader = new FileReader();\n+\n+    reader.onload = function () {\n+      const preview = document.getElementById('preview');\n+      preview.src = reader.result;\n+    };\n+\n+    if (input.files && input.files[0]) {\n+      reader.readAsDataURL(input.files[0]);\n+    }\n+  }\n+\n+\n+  // 채찍피티 버전\n+    document.addEventListener('DOMContentLoaded', function () {\n+        const submitAllBtn = document.getElementById('submitAllBtn');\n+        const imageForm = document.getElementById('imageForm');\n+        const generalDataForm = document.getElementById('generalDataForm');\n+        // const hospitalId = '[[${hospitalForm.hospitalId}]]';\n+        const hospitalId = document.getElementById('hospitalId')?.value;\n+        const isNew = !hospitalId || hospitalId === 'null' || hospitalId === '';\n+\n+        const csrfToken = document.querySelector('meta[name=\"_csrf\"]').content;\n+        const csrfHeader = document.querySelector('meta[name=\"_csrf_header\"]').content;\n+\n+        const deleteBtn = document.getElementById('deleteBtn');\n+        if (deleteBtn) {\n+            deleteBtn.addEventListener('click', function() {\n+                if (confirm('정말로 이 병원을 삭제하시겠습니까?')) {\n+                    document.getElementById('deleteForm').submit();\n+                }\n+            });\n+        }\n+\n+        submitAllBtn.addEventListener('click', async function (event) {\n+            event.preventDefault();\n+\n+            const formData = new FormData();\n+\n+            // 1. 일반 입력값 병합\n+            const generalFormData = new FormData(generalDataForm);\n+            for (const [key, value] of generalFormData.entries()) {\n+                formData.append(key, value);\n+            }\n+\n+            // 2. 이미지 파일 업로드 및 URL 병합\n+            const imageFileInput = imageForm.querySelector('#fileInput');\n+            if (imageFileInput && imageFileInput.files.length > 0) {\n+                const imageUploadFormData = new FormData();\n+                imageUploadFormData.append('image', imageFileInput.files[0]);\n+\n+                try {\n+                    const uploadResponse = await fetch('/upload/image', {\n+                        method: 'POST',\n+                        headers: {\n+                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n+                        },\n+                        body: imageUploadFormData\n+                    });\n+\n+                    if (uploadResponse.ok) {\n+                        const uploadResult = await uploadResponse.json();\n+                        if (uploadResult.success === 1) {\n+                            formData.append('thumbnailImageUrl', uploadResult.imageUrl);\n+                        } else {\n+                            alert('이미지 업로드 실패: ' + uploadResult.message);\n+                            return; // 이미지 업로드 실패 시 전체 제출 중단\n+                        }\n+                    } else {\n+                        const errorText = await uploadResponse.text();\n+                        console.error('이미지 업로드 실패:', errorText);\n+                        alert('이미지 업로드를 실패하였습니다.');\n+                        return; // 이미지 업로드 실패 시 전체 제출 중단\n+                    }\n+                } catch (error) {\n+                    console.error('이미지 업로드 중 오류:', error);\n+                    alert('이미지 업로드 중 오류가 발생했습니다.');\n+                    return; // 이미지 업로드 실패 시 전체 제출 중단\n+                }\n+            }\n+\n+            // 3. 전송\n+            const actionUrl = isNew ? '/hospitals/new' : '/hospitals/edit';\n+\n+            try {\n+                const response = await fetch(actionUrl, {\n+                    method: 'POST',\n+                    headers: {\n+                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n+                        },\n+                    body: formData\n+                });\n+\n+                if (response.ok) {\n+                    const result = await response.json();\n+                    alert('병원 정보가 성공적으로 제출되었습니다!');\n+                    window.location.href = '/hospitals';\n+                } else {\n+                    const errorText = await response.text();\n+                    console.error('제출 실패:', errorText);\n+                    alert('제출에 실패했습니다: ' + errorText);\n+                }\n+            } catch (error) {\n+                console.error('제출 중 오류:', error);\n+                alert('제출 중 오류가 발생했습니다.');\n+            }\n+        });\n+    });\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+  // 잼민이 버전\n+//   document.addEventListener('DOMContentLoaded', function() {\n+//     const submitAllBtn = document.getElementById('submitAllBtn');\n+//     const generalDataForm = document.getElementById('generalDataForm');\n+//     const fileUploadForm = document.getElementById('fileUploadForm'); // fileUploadForm 참조 추가\n+//     const hospitalId = '[[${hospitalForm.hospitalId}]]'; // Thymeleaf 변수 사용\n+\n+//     submitAllBtn.addEventListener('click', async function(event) {\n+//       event.preventDefault(); // 기본 폼 제출 방지\n+\n+//       const formData = new FormData(generalDataForm); // generalDataForm의 데이터로 FormData 초기화\n+//       const fileInput = fileUploadForm.querySelector('#fileInput'); // fileUploadForm에서 fileInput 가져오기\n+//       if (fileInput && fileInput.files && fileInput.files[0]) {\n+//         formData.append('thumbnailImageFile', fileInput.files[0]);\n+//       }\n+\n+//       // 폼 액션 URL 결정\n+//       const actionUrl = hospitalId === 'null' ? '/hospitals/new' : '/hospitals/edit';\n+\n+//       try {\n+//         const response = await fetch(actionUrl, {\n+//                                                     method: 'POST',\n+//                                                     body: formData\n+//                                                 });\n+\n+//         if (response.ok) {\n+//           const result = await response.json(); // 또는 response.text()\n+//           console.log('Submission successful:', result);\n+//           alert('병원 정보가 성공적으로 제출되었습니다!');\n+//           // 성공 후 리다이렉트 또는 다른 작업 수행\n+//           window.location.href = '/hospitals'; // 예시: 병원 목록 페이지로 이동\n+//         } else {\n+//           const errorText = await response.text();\n+//           console.error('Submission failed:', response.status, errorText);\n+//           alert('병원 정보 제출에 실패했습니다: ' + errorText);\n+//         }\n+//       } catch (error) {\n+//         console.error('Error during submission:', error);\n+//         alert('병원 정보 제출 중 오류가 발생했습니다.');\n+//       }\n+//     });\n+//   });\n+</script>\n+\n+\n+    <th:block th:replace=\"~{/fragments/footer :: footer}\"></th:block>\n+    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q\" crossorigin=\"anonymous\"></script>\n+</body>\n+</html>\n\\ No newline at end of file\n"
                },
                {
                    "date": 1751989628568,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,301 @@\n+<!DOCTYPE html>\n+<html lang=\"ko\" xmlns:th=\"http://www.thymeleaf.org\" xmlns:sec=\"http://www.thymeleaf.org/thymeleaf-extras-springsecurity5\">\n+<head>\n+    <meta charset=\"UTF-8\">\n+    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n+    <meta name=\"_csrf\" th:content=\"${_csrf.token}\" />\n+    <meta name=\"_csrf_header\" th:content=\"${_csrf.headerName}\" />\n+\n+    <title>병원 등록</title>\n+    <!-- Bootstrap CSS -->\n+    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\">\n+    <!-- Font Awesome CSS -->\n+    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css\">\n+    <link rel=\"stylesheet\" th:href=\"@{/css/hospital_style.css}\">\n+</head>\n+<body>\n+    <th:block th:replace=\"~{/fragments/header :: header}\"></th:block>\n+    <div class=\"hospital-main-container\">\n+        <!-- 상단 로고 -->\n+        <div class=\"logo-container\">\n+            <div class=\"logo\">\n+                <img th:src=\"@{/img/hosp_logo.png}\" alt=\"병원 아이콘\" class=\"logo-icon\">\n+            </div>\n+        </div>\n+\n+        <!-- 메인 컨텐츠 -->\n+        <div class=\"main-content d-flex flex-column align-items-center\">\n+                        <!-- Hidden form for multipart file upload  잼민이버전-->\n+            <!-- <form id=\"fileUploadForm\" style=\"display: none;\" enctype=\"multipart/form-data\">\n+                <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" onchange=\"previewImage(event)\">\n+            </form> -->\n+\n+            <!-- 채찍피티 버전 -->\n+            <div class=\"d-flex justify-content-between align-items-start gap-5\">\n+\n+                <form id=\"imageForm\" enctype=\"multipart/form-data\">\n+                    <div class=\"image-upload-section\">\n+                        <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n+                            <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n+                        </div>\n+                        <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" style=\"display: none;\" onchange=\"previewImage(event)\">\n+                    </div>\n+                </form>\n+\n+\n+                <!-- Main form for general data -->\n+                <form id=\"generalDataForm\" th:object=\"${hospitalForm}\">\n+                    <input type=\"hidden\" id=\"hospitalId\" th:field=\"*{hospitalId}\" />\n+                    <!-- <input type=\"hidden\" id=\"csrfTokenGeneral\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" /> -->\n+\n+                    <div class=\"form-container\">\n+                        <!-- <div class=\"image-upload-section\">\n+                            <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n+                                <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n+                            </div>\n+                        </div> -->\n+\n+                        <div class=\"form-section\">\n+                            <div class=\"form-group\">\n+                                <label for=\"name\">병원 이름</label>\n+                                <input type=\"text\" id=\"name\" th:field=\"*{name}\" placeholder=\"병원 이름을 작성하세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"address\">병원 주소</label>\n+                                <input type=\"text\" id=\"address\" th:field=\"*{address}\" placeholder=\"주소를 입력해 주세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"homepage\">홈페이지</label>\n+                                <input type=\"url\" id=\"homepage\" th:field=\"*{homepage}\" placeholder=\"홈페이지 주소를 입력해 주세요\">\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"phone\">대표번호</label>\n+                                <input type=\"tel\" id=\"phone\" th:field=\"*{phone}\" placeholder=\"병원 전화번호를 입력하세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"email\">이메일</label>\n+                                <input type=\"email\" id=\"email\" th:field=\"*{email}\" placeholder=\"이메일 주소를 입력하세요\">\n+                            </div>\n+                            <div class=\"form-group\">\n+                                <label for=\"hosp-introduce\">병원 소개</label>\n+                                <textarea type=\"text\" id=\"hosp-introduce\" th:field=\"*{email}\" placeholder=\"간단한 소개글을 작성해 주세요\" required rows=\"4\" style=\"resize: none;\"></textarea>\n+                            </div>\n+                        </div>\n+                    </div>\n+                </form>\n+                <div class=\"d-flex flex-column gap-3\" style=\"flex-grow: 1;\">\n+                    <form id=\"checkSpecialForm\" th:object=\"${hospitalForm}\" class=\"d-flex flex-nowrap\">\n+                        <div class=\"form-group\">\n+                            <label>진료 과목</label>\n+                            <div class=\"checkbox-group\">\n+                                <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n+                                    <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\n+                                    <label th:for=\"'spec-' + ${spec.specialtyId}\" th:text=\"${spec.category}\"></label>\n+                                </div>\n+                            </div>\n+                        </div>\n+                    </form>\n+                    <form id=\"checkAnimalForm\" th:object=\"${hospitalForm}\">\n+                        <div class=\"form-group\">\n+                            <label>진료 가능 동물</label>\n+                            <div class=\"category-group\">\n+                                <label th:each=\"animal : ${animalList}\" class=\"category-item\">\n+                                    <input type=\"checkbox\" name=\"category\" th:field=\"*{animalIds}\" th:value=\"${animal.animalId}\" th:id=\"'animal-' + ${animal.animalId}\">\n+                                    <span th:for=\"'animal-' + ${animal.animalId}\" th:text=\"${animal.species}\"></span>\n+                                </label>\n+                            </div>\n+                        </div>\n+                    </form>\n+                </div>\n+            </div>\n+        </div>\n+\n+            <!-- 삭제 form -->\n+            <div sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">\n+                <form id=\"deleteForm\" th:action=\"@{/hospitals/delete/{id}(id=${hospitalForm.hospitalId})}\" method=\"post\" style=\"display: none;\">\n+                    <input type=\"hidden\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" />\n+                </form>\n+            </div>\n+\n+            <div class=\"d-flex justify-content-center gap-2 mt-4\">\n+                <button type=\"button\" class=\"btn btn-secondary\" onclick=\"history.back()\">취소</button>\n+                <button type=\"button\" id=\"submitAllBtn\" class=\"btn btn-primary\" th:text=\"${hospitalForm.hospitalId != null ? '수정' : '등록'}\"></button>\n+                <button type=\"button\" id=\"deleteBtn\" class=\"btn btn-danger\" sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">삭제</button>\n+            </div>\n+        </div>\n+\n+\n+<script>\n+  function previewImage(event) {\n+    const input = event.target;\n+    const reader = new FileReader();\n+\n+    reader.onload = function () {\n+      const preview = document.getElementById('preview');\n+      preview.src = reader.result;\n+    };\n+\n+    if (input.files && input.files[0]) {\n+      reader.readAsDataURL(input.files[0]);\n+    }\n+  }\n+\n+\n+  // 채찍피티 버전\n+    document.addEventListener('DOMContentLoaded', function () {\n+        const submitAllBtn = document.getElementById('submitAllBtn');\n+        const imageForm = document.getElementById('imageForm');\n+        const generalDataForm = document.getElementById('generalDataForm');\n+        // const hospitalId = '[[${hospitalForm.hospitalId}]]';\n+        const hospitalId = document.getElementById('hospitalId')?.value;\n+        const isNew = !hospitalId || hospitalId === 'null' || hospitalId === '';\n+\n+        const csrfToken = document.querySelector('meta[name=\"_csrf\"]').content;\n+        const csrfHeader = document.querySelector('meta[name=\"_csrf_header\"]').content;\n+\n+        const deleteBtn = document.getElementById('deleteBtn');\n+        if (deleteBtn) {\n+            deleteBtn.addEventListener('click', function() {\n+                if (confirm('정말로 이 병원을 삭제하시겠습니까?')) {\n+                    document.getElementById('deleteForm').submit();\n+                }\n+            });\n+        }\n+\n+        submitAllBtn.addEventListener('click', async function (event) {\n+            event.preventDefault();\n+\n+            const formData = new FormData();\n+\n+            // 1. 일반 입력값 병합\n+            const generalFormData = new FormData(generalDataForm);\n+            for (const [key, value] of generalFormData.entries()) {\n+                formData.append(key, value);\n+            }\n+\n+            // 2. 이미지 파일 업로드 및 URL 병합\n+            const imageFileInput = imageForm.querySelector('#fileInput');\n+            if (imageFileInput && imageFileInput.files.length > 0) {\n+                const imageUploadFormData = new FormData();\n+                imageUploadFormData.append('image', imageFileInput.files[0]);\n+\n+                try {\n+                    const uploadResponse = await fetch('/upload/image', {\n+                        method: 'POST',\n+                        headers: {\n+                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n+                        },\n+                        body: imageUploadFormData\n+                    });\n+\n+                    if (uploadResponse.ok) {\n+                        const uploadResult = await uploadResponse.json();\n+                        if (uploadResult.success === 1) {\n+                            formData.append('thumbnailImageUrl', uploadResult.imageUrl);\n+                        } else {\n+                            alert('이미지 업로드 실패: ' + uploadResult.message);\n+                            return; // 이미지 업로드 실패 시 전체 제출 중단\n+                        }\n+                    } else {\n+                        const errorText = await uploadResponse.text();\n+                        console.error('이미지 업로드 실패:', errorText);\n+                        alert('이미지 업로드를 실패하였습니다.');\n+                        return; // 이미지 업로드 실패 시 전체 제출 중단\n+                    }\n+                } catch (error) {\n+                    console.error('이미지 업로드 중 오류:', error);\n+                    alert('이미지 업로드 중 오류가 발생했습니다.');\n+                    return; // 이미지 업로드 실패 시 전체 제출 중단\n+                }\n+            }\n+\n+            // 3. 전송\n+            const actionUrl = isNew ? '/hospitals/new' : '/hospitals/edit';\n+\n+            try {\n+                const response = await fetch(actionUrl, {\n+                    method: 'POST',\n+                    headers: {\n+                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n+                        },\n+                    body: formData\n+                });\n+\n+                if (response.ok) {\n+                    const result = await response.json();\n+                    alert('병원 정보가 성공적으로 제출되었습니다!');\n+                    window.location.href = '/hospitals';\n+                } else {\n+                    const errorText = await response.text();\n+                    console.error('제출 실패:', errorText);\n+                    alert('제출에 실패했습니다: ' + errorText);\n+                }\n+            } catch (error) {\n+                console.error('제출 중 오류:', error);\n+                alert('제출 중 오류가 발생했습니다.');\n+            }\n+        });\n+    });\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+  // 잼민이 버전\n+//   document.addEventListener('DOMContentLoaded', function() {\n+//     const submitAllBtn = document.getElementById('submitAllBtn');\n+//     const generalDataForm = document.getElementById('generalDataForm');\n+//     const fileUploadForm = document.getElementById('fileUploadForm'); // fileUploadForm 참조 추가\n+//     const hospitalId = '[[${hospitalForm.hospitalId}]]'; // Thymeleaf 변수 사용\n+\n+//     submitAllBtn.addEventListener('click', async function(event) {\n+//       event.preventDefault(); // 기본 폼 제출 방지\n+\n+//       const formData = new FormData(generalDataForm); // generalDataForm의 데이터로 FormData 초기화\n+//       const fileInput = fileUploadForm.querySelector('#fileInput'); // fileUploadForm에서 fileInput 가져오기\n+//       if (fileInput && fileInput.files && fileInput.files[0]) {\n+//         formData.append('thumbnailImageFile', fileInput.files[0]);\n+//       }\n+\n+//       // 폼 액션 URL 결정\n+//       const actionUrl = hospitalId === 'null' ? '/hospitals/new' : '/hospitals/edit';\n+\n+//       try {\n+//         const response = await fetch(actionUrl, {\n+//                                                     method: 'POST',\n+//                                                     body: formData\n+//                                                 });\n+\n+//         if (response.ok) {\n+//           const result = await response.json(); // 또는 response.text()\n+//           console.log('Submission successful:', result);\n+//           alert('병원 정보가 성공적으로 제출되었습니다!');\n+//           // 성공 후 리다이렉트 또는 다른 작업 수행\n+//           window.location.href = '/hospitals'; // 예시: 병원 목록 페이지로 이동\n+//         } else {\n+//           const errorText = await response.text();\n+//           console.error('Submission failed:', response.status, errorText);\n+//           alert('병원 정보 제출에 실패했습니다: ' + errorText);\n+//         }\n+//       } catch (error) {\n+//         console.error('Error during submission:', error);\n+//         alert('병원 정보 제출 중 오류가 발생했습니다.');\n+//       }\n+//     });\n+//   });\n+</script>\n+\n+\n+    <th:block th:replace=\"~{/fragments/footer :: footer}\"></th:block>\n+    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q\" crossorigin=\"anonymous\"></script>\n+</body>\n+</html>\n\\ No newline at end of file\n"
                },
                {
                    "date": 1751989760716,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -23,16 +23,16 @@\n             </div>\n         </div>\n \n         <!-- 메인 컨텐츠 -->\n-        <div class=\"main-content d-flex flex-column align-items-center\">\n+        <div class=\"main-content\">\n                         <!-- Hidden form for multipart file upload  잼민이버전-->\n             <!-- <form id=\"fileUploadForm\" style=\"display: none;\" enctype=\"multipart/form-data\">\n                 <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" onchange=\"previewImage(event)\">\n             </form> -->\n \n             <!-- 채찍피티 버전 -->\n-            <div class=\"d-flex justify-content-between align-items-start gap-5\">\n+            <div class=\"d-flex justify-content-between align-items-start gap-6\">\n \n                 <form id=\"imageForm\" enctype=\"multipart/form-data\">\n                     <div class=\"image-upload-section\">\n                         <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n@@ -297,2755 +297,5 @@\n \n     <th:block th:replace=\"~{/fragments/footer :: footer}\"></th:block>\n     <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q\" crossorigin=\"anonymous\"></script>\n </body>\n-</html>\n-<!DOCTYPE html>\n-<html lang=\"ko\" xmlns:th=\"http://www.thymeleaf.org\" xmlns:sec=\"http://www.thymeleaf.org/thymeleaf-extras-springsecurity5\">\n-<head>\n-    <meta charset=\"UTF-8\">\n-    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n-    <meta name=\"_csrf\" th:content=\"${_csrf.token}\" />\n-    <meta name=\"_csrf_header\" th:content=\"${_csrf.headerName}\" />\n-\n-    <title>병원 등록</title>\n-    <!-- Bootstrap CSS -->\n-    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\">\n-    <!-- Font Awesome CSS -->\n-    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css\">\n-    <link rel=\"stylesheet\" th:href=\"@{/css/hospital_style.css}\">\n-</head>\n-<body>\n-    <th:block th:replace=\"~{/fragments/header :: header}\"></th:block>\n-    <div class=\"hospital-main-container\">\n-        <!-- 상단 로고 -->\n-        <div class=\"logo-container\">\n-            <div class=\"logo\">\n-                <img th:src=\"@{/img/hosp_logo.png}\" alt=\"병원 아이콘\" class=\"logo-icon\">\n-            </div>\n-        </div>\n-\n-        <!-- 메인 컨텐츠 -->\n-        <div class=\"main-content d-flex flex-column align-items-center\">\n-                        <!-- Hidden form for multipart file upload  잼민이버전-->\n-            <!-- <form id=\"fileUploadForm\" style=\"display: none;\" enctype=\"multipart/form-data\">\n-                <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" onchange=\"previewImage(event)\">\n-            </form> -->\n-\n-            <!-- 채찍피티 버전 -->\n-            <div class=\"d-flex justify-content-between align-items-start gap-5\">\n-\n-                <form id=\"imageForm\" enctype=\"multipart/form-data\">\n-                    <div class=\"image-upload-section\">\n-                        <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n-                            <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n-                        </div>\n-                        <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" style=\"display: none;\" onchange=\"previewImage(event)\">\n-                    </div>\n-                </form>\n-\n-\n-                <!-- Main form for general data -->\n-                <form id=\"generalDataForm\" th:object=\"${hospitalForm}\">\n-                    <input type=\"hidden\" id=\"hospitalId\" th:field=\"*{hospitalId}\" />\n-                    <!-- <input type=\"hidden\" id=\"csrfTokenGeneral\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" /> -->\n-\n-                    <div class=\"form-container\">\n-                        <!-- <div class=\"image-upload-section\">\n-                            <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n-                                <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n-                            </div>\n-                        </div> -->\n-\n-                        <div class=\"form-section\">\n-                            <div class=\"form-group\">\n-                                <label for=\"name\">병원 이름</label>\n-                                <input type=\"text\" id=\"name\" th:field=\"*{name}\" placeholder=\"병원 이름을 작성하세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"address\">병원 주소</label>\n-                                <input type=\"text\" id=\"address\" th:field=\"*{address}\" placeholder=\"주소를 입력해 주세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"homepage\">홈페이지</label>\n-                                <input type=\"url\" id=\"homepage\" th:field=\"*{homepage}\" placeholder=\"홈페이지 주소를 입력해 주세요\">\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"phone\">대표번호</label>\n-                                <input type=\"tel\" id=\"phone\" th:field=\"*{phone}\" placeholder=\"병원 전화번호를 입력하세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"email\">이메일</label>\n-                                <input type=\"email\" id=\"email\" th:field=\"*{email}\" placeholder=\"이메일 주소를 입력하세요\">\n-                            </div>\n-                            <div class=\"form-group\">\n-                                <label for=\"hosp-introduce\">병원 소개</label>\n-                                <textarea type=\"text\" id=\"hosp-introduce\" th:field=\"*{email}\" placeholder=\"간단한 소개글을 작성해 주세요\" required rows=\"4\" style=\"resize: none;\"></textarea>\n-                            </div>\n-                        </div>\n-                    </div>\n-                </form>\n-                <form id=\"checkSpecialForm\" th:object=\"${hospitalForm}\" class=\"d-flex flex-nowrap\">\n-                    <div class=\"form-group\">\n-                        <label>진료 과목</label>\n-                        <div class=\"checkbox-group\">\n-                            <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n-                                <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\n-                                <label th:for=\"'spec-' + ${spec.specialtyId}\" th:text=\"${spec.category}\"></label>\n-                            </div>\n-                        </div>\n-                    </div>\n-                </form>\n-                <form id=\"checkAnimalForm\" th:object=\"${hospitalForm}\">\n-                    <div class=\"form-group\">\n-                        <label>진료 가능 동물</label>\n-                        <div class=\"category-group\">\n-                            <label th:each=\"animal : ${animalList}\" class=\"category-item\">\n-                                <input type=\"checkbox\" name=\"category\" th:field=\"*{animalIds}\" th:value=\"${animal.animalId}\" th:id=\"'animal-' + ${animal.animalId}\">\n-                                <span th:for=\"'animal-' + ${animal.animalId}\" th:text=\"${animal.species}\"></span>\n-                            </label>\n-                        </div>\n-                    </div>\n-                </form>\n-            </div>\n-        </div>\n-\n-            <!-- 삭제 form -->\n-            <div sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">\n-                <form id=\"deleteForm\" th:action=\"@{/hospitals/delete/{id}(id=${hospitalForm.hospitalId})}\" method=\"post\" style=\"display: none;\">\n-                    <input type=\"hidden\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" />\n-                </form>\n-            </div>\n-\n-            <div class=\"d-flex justify-content-center gap-2 mt-4\">\n-                <button type=\"button\" class=\"btn btn-secondary\" onclick=\"history.back()\">취소</button>\n-                <button type=\"button\" id=\"submitAllBtn\" class=\"btn btn-primary\" th:text=\"${hospitalForm.hospitalId != null ? '수정' : '등록'}\"></button>\n-                <button type=\"button\" id=\"deleteBtn\" class=\"btn btn-danger\" sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">삭제</button>\n-            </div>\n-        </div>\n-\n-\n-<script>\n-  function previewImage(event) {\n-    const input = event.target;\n-    const reader = new FileReader();\n-\n-    reader.onload = function () {\n-      const preview = document.getElementById('preview');\n-      preview.src = reader.result;\n-    };\n-\n-    if (input.files && input.files[0]) {\n-      reader.readAsDataURL(input.files[0]);\n-    }\n-  }\n-\n-\n-  // 채찍피티 버전\n-    document.addEventListener('DOMContentLoaded', function () {\n-        const submitAllBtn = document.getElementById('submitAllBtn');\n-        const imageForm = document.getElementById('imageForm');\n-        const generalDataForm = document.getElementById('generalDataForm');\n-        // const hospitalId = '[[${hospitalForm.hospitalId}]]';\n-        const hospitalId = document.getElementById('hospitalId')?.value;\n-        const isNew = !hospitalId || hospitalId === 'null' || hospitalId === '';\n-\n-        const csrfToken = document.querySelector('meta[name=\"_csrf\"]').content;\n-        const csrfHeader = document.querySelector('meta[name=\"_csrf_header\"]').content;\n-\n-        const deleteBtn = document.getElementById('deleteBtn');\n-        if (deleteBtn) {\n-            deleteBtn.addEventListener('click', function() {\n-                if (confirm('정말로 이 병원을 삭제하시겠습니까?')) {\n-                    document.getElementById('deleteForm').submit();\n-                }\n-            });\n-        }\n-\n-        submitAllBtn.addEventListener('click', async function (event) {\n-            event.preventDefault();\n-\n-            const formData = new FormData();\n-\n-            // 1. 일반 입력값 병합\n-            const generalFormData = new FormData(generalDataForm);\n-            for (const [key, value] of generalFormData.entries()) {\n-                formData.append(key, value);\n-            }\n-\n-            // 2. 이미지 파일 업로드 및 URL 병합\n-            const imageFileInput = imageForm.querySelector('#fileInput');\n-            if (imageFileInput && imageFileInput.files.length > 0) {\n-                const imageUploadFormData = new FormData();\n-                imageUploadFormData.append('image', imageFileInput.files[0]);\n-\n-                try {\n-                    const uploadResponse = await fetch('/upload/image', {\n-                        method: 'POST',\n-                        headers: {\n-                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n-                        },\n-                        body: imageUploadFormData\n-                    });\n-\n-                    if (uploadResponse.ok) {\n-                        const uploadResult = await uploadResponse.json();\n-                        if (uploadResult.success === 1) {\n-                            formData.append('thumbnailImageUrl', uploadResult.imageUrl);\n-                        } else {\n-                            alert('이미지 업로드 실패: ' + uploadResult.message);\n-                            return; // 이미지 업로드 실패 시 전체 제출 중단\n-                        }\n-                    } else {\n-                        const errorText = await uploadResponse.text();\n-                        console.error('이미지 업로드 실패:', errorText);\n-                        alert('이미지 업로드를 실패하였습니다.');\n-                        return; // 이미지 업로드 실패 시 전체 제출 중단\n-                    }\n-                } catch (error) {\n-                    console.error('이미지 업로드 중 오류:', error);\n-                    alert('이미지 업로드 중 오류가 발생했습니다.');\n-                    return; // 이미지 업로드 실패 시 전체 제출 중단\n-                }\n-            }\n-\n-            // 3. 전송\n-            const actionUrl = isNew ? '/hospitals/new' : '/hospitals/edit';\n-\n-            try {\n-                const response = await fetch(actionUrl, {\n-                    method: 'POST',\n-                    headers: {\n-                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n-                        },\n-                    body: formData\n-                });\n-\n-                if (response.ok) {\n-                    const result = await response.json();\n-                    alert('병원 정보가 성공적으로 제출되었습니다!');\n-                    window.location.href = '/hospitals';\n-                } else {\n-                    const errorText = await response.text();\n-                    console.error('제출 실패:', errorText);\n-                    alert('제출에 실패했습니다: ' + errorText);\n-                }\n-            } catch (error) {\n-                console.error('제출 중 오류:', error);\n-                alert('제출 중 오류가 발생했습니다.');\n-            }\n-        });\n-    });\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-  // 잼민이 버전\n-//   document.addEventListener('DOMContentLoaded', function() {\n-//     const submitAllBtn = document.getElementById('submitAllBtn');\n-//     const generalDataForm = document.getElementById('generalDataForm');\n-//     const fileUploadForm = document.getElementById('fileUploadForm'); // fileUploadForm 참조 추가\n-//     const hospitalId = '[[${hospitalForm.hospitalId}]]'; // Thymeleaf 변수 사용\n-\n-//     submitAllBtn.addEventListener('click', async function(event) {\n-//       event.preventDefault(); // 기본 폼 제출 방지\n-\n-//       const formData = new FormData(generalDataForm); // generalDataForm의 데이터로 FormData 초기화\n-//       const fileInput = fileUploadForm.querySelector('#fileInput'); // fileUploadForm에서 fileInput 가져오기\n-//       if (fileInput && fileInput.files && fileInput.files[0]) {\n-//         formData.append('thumbnailImageFile', fileInput.files[0]);\n-//       }\n-\n-//       // 폼 액션 URL 결정\n-//       const actionUrl = hospitalId === 'null' ? '/hospitals/new' : '/hospitals/edit';\n-\n-//       try {\n-//         const response = await fetch(actionUrl, {\n-//                                                     method: 'POST',\n-//                                                     body: formData\n-//                                                 });\n-\n-//         if (response.ok) {\n-//           const result = await response.json(); // 또는 response.text()\n-//           console.log('Submission successful:', result);\n-//           alert('병원 정보가 성공적으로 제출되었습니다!');\n-//           // 성공 후 리다이렉트 또는 다른 작업 수행\n-//           window.location.href = '/hospitals'; // 예시: 병원 목록 페이지로 이동\n-//         } else {\n-//           const errorText = await response.text();\n-//           console.error('Submission failed:', response.status, errorText);\n-//           alert('병원 정보 제출에 실패했습니다: ' + errorText);\n-//         }\n-//       } catch (error) {\n-//         console.error('Error during submission:', error);\n-//         alert('병원 정보 제출 중 오류가 발생했습니다.');\n-//       }\n-//     });\n-//   });\n-</script>\n-\n-\n-    <th:block th:replace=\"~{/fragments/footer :: footer}\"></th:block>\n-    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q\" crossorigin=\"anonymous\"></script>\n-</body>\n-</html>\n-<!DOCTYPE html>\n-<html lang=\"ko\" xmlns:th=\"http://www.thymeleaf.org\" xmlns:sec=\"http://www.thymeleaf.org/thymeleaf-extras-springsecurity5\">\n-<head>\n-    <meta charset=\"UTF-8\">\n-    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n-    <meta name=\"_csrf\" th:content=\"${_csrf.token}\" />\n-    <meta name=\"_csrf_header\" th:content=\"${_csrf.headerName}\" />\n-\n-    <title>병원 등록</title>\n-    <!-- Bootstrap CSS -->\n-    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\">\n-    <!-- Font Awesome CSS -->\n-    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css\">\n-    <link rel=\"stylesheet\" th:href=\"@{/css/hospital_style.css}\">\n-</head>\n-<body>\n-    <th:block th:replace=\"~{/fragments/header :: header}\"></th:block>\n-    <div class=\"hospital-main-container\">\n-        <!-- 상단 로고 -->\n-        <div class=\"logo-container\">\n-            <div class=\"logo\">\n-                <img th:src=\"@{/img/hosp_logo.png}\" alt=\"병원 아이콘\" class=\"logo-icon\">\n-            </div>\n-        </div>\n-\n-        <!-- 메인 컨텐츠 -->\n-        <div class=\"main-content d-flex flex-column align-items-center\">\n-                        <!-- Hidden form for multipart file upload  잼민이버전-->\n-            <!-- <form id=\"fileUploadForm\" style=\"display: none;\" enctype=\"multipart/form-data\">\n-                <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" onchange=\"previewImage(event)\">\n-            </form> -->\n-\n-            <!-- 채찍피티 버전 -->\n-            <div class=\"d-flex flex-column justify-content-around align-items-start gap-20\">\n-\n-                <form id=\"imageForm\" enctype=\"multipart/form-data\">\n-                    <div class=\"image-upload-section\">\n-                        <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n-                            <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n-                        </div>\n-                        <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" style=\"display: none;\" onchange=\"previewImage(event)\">\n-                    </div>\n-                </form>\n-\n-\n-                <!-- Main form for general data -->\n-                <form id=\"generalDataForm\" th:object=\"${hospitalForm}\">\n-                    <input type=\"hidden\" id=\"hospitalId\" th:field=\"*{hospitalId}\" />\n-                    <!-- <input type=\"hidden\" id=\"csrfTokenGeneral\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" /> -->\n-\n-                    <div class=\"form-container\">\n-                        <!-- <div class=\"image-upload-section\">\n-                            <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n-                                <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n-                            </div>\n-                        </div> -->\n-\n-                        <div class=\"form-section\">\n-                            <div class=\"form-group\">\n-                                <label for=\"name\">병원 이름</label>\n-                                <input type=\"text\" id=\"name\" th:field=\"*{name}\" placeholder=\"병원 이름을 작성하세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"address\">병원 주소</label>\n-                                <input type=\"text\" id=\"address\" th:field=\"*{address}\" placeholder=\"주소를 입력해 주세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"homepage\">홈페이지</label>\n-                                <input type=\"url\" id=\"homepage\" th:field=\"*{homepage}\" placeholder=\"홈페이지 주소를 입력해 주세요\">\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"phone\">대표번호</label>\n-                                <input type=\"tel\" id=\"phone\" th:field=\"*{phone}\" placeholder=\"병원 전화번호를 입력하세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"email\">이메일</label>\n-                                <input type=\"email\" id=\"email\" th:field=\"*{email}\" placeholder=\"이메일 주소를 입력하세요\">\n-                            </div>\n-                            <div class=\"form-group\">\n-                                <label for=\"hosp-introduce\">병원 소개</label>\n-                                <textarea type=\"text\" id=\"hosp-introduce\" th:field=\"*{email}\" placeholder=\"간단한 소개글을 작성해 주세요\" required rows=\"4\" style=\"resize: none;\"></textarea>\n-                            </div>\n-                        </div>\n-                    </div>\n-                </form>\n-                <form id=\"checkSpecialForm\" th:object=\"${hospitalForm}\" class=\"d-flex flex-nowrap\">\n-                    <div class=\"form-group\">\n-                        <label>진료 과목</label>\n-                        <div class=\"checkbox-group\">\n-                            <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n-                                <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\n-                                <label th:for=\"'spec-' + ${spec.specialtyId}\" th:text=\"${spec.category}\"></label>\n-                            </div>\n-                        </div>\n-                    </div>\n-                </form>\n-                <form id=\"checkAnimalForm\" th:object=\"${hospitalForm}\">\n-                    <div class=\"form-group\">\n-                        <label>진료 가능 동물</label>\n-                        <div class=\"category-group\">\n-                            <label th:each=\"animal : ${animalList}\" class=\"category-item\">\n-                                <input type=\"checkbox\" name=\"category\" th:field=\"*{animalIds}\" th:value=\"${animal.animalId}\" th:id=\"'animal-' + ${animal.animalId}\">\n-                                <span th:for=\"'animal-' + ${animal.animalId}\" th:text=\"${animal.species}\"></span>\n-                            </label>\n-                        </div>\n-                    </div>\n-                </form>\n-            </div>\n-        </div>\n-\n-            <!-- 삭제 form -->\n-            <div sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">\n-                <form id=\"deleteForm\" th:action=\"@{/hospitals/delete/{id}(id=${hospitalForm.hospitalId})}\" method=\"post\" style=\"display: none;\">\n-                    <input type=\"hidden\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" />\n-                </form>\n-            </div>\n-\n-            <div class=\"d-flex justify-content-center gap-2 mt-4\">\n-                <button type=\"button\" class=\"btn btn-secondary\" onclick=\"history.back()\">취소</button>\n-                <button type=\"button\" id=\"submitAllBtn\" class=\"btn btn-primary\" th:text=\"${hospitalForm.hospitalId != null ? '수정' : '등록'}\"></button>\n-                <button type=\"button\" id=\"deleteBtn\" class=\"btn btn-danger\" sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">삭제</button>\n-            </div>\n-        </div>\n-\n-\n-<script>\n-  function previewImage(event) {\n-    const input = event.target;\n-    const reader = new FileReader();\n-\n-    reader.onload = function () {\n-      const preview = document.getElementById('preview');\n-      preview.src = reader.result;\n-    };\n-\n-    if (input.files && input.files[0]) {\n-      reader.readAsDataURL(input.files[0]);\n-    }\n-  }\n-\n-\n-  // 채찍피티 버전\n-    document.addEventListener('DOMContentLoaded', function () {\n-        const submitAllBtn = document.getElementById('submitAllBtn');\n-        const imageForm = document.getElementById('imageForm');\n-        const generalDataForm = document.getElementById('generalDataForm');\n-        // const hospitalId = '[[${hospitalForm.hospitalId}]]';\n-        const hospitalId = document.getElementById('hospitalId')?.value;\n-        const isNew = !hospitalId || hospitalId === 'null' || hospitalId === '';\n-\n-        const csrfToken = document.querySelector('meta[name=\"_csrf\"]').content;\n-        const csrfHeader = document.querySelector('meta[name=\"_csrf_header\"]').content;\n-\n-        const deleteBtn = document.getElementById('deleteBtn');\n-        if (deleteBtn) {\n-            deleteBtn.addEventListener('click', function() {\n-                if (confirm('정말로 이 병원을 삭제하시겠습니까?')) {\n-                    document.getElementById('deleteForm').submit();\n-                }\n-            });\n-        }\n-\n-        submitAllBtn.addEventListener('click', async function (event) {\n-            event.preventDefault();\n-\n-            const formData = new FormData();\n-\n-            // 1. 일반 입력값 병합\n-            const generalFormData = new FormData(generalDataForm);\n-            for (const [key, value] of generalFormData.entries()) {\n-                formData.append(key, value);\n-            }\n-\n-            // 2. 이미지 파일 업로드 및 URL 병합\n-            const imageFileInput = imageForm.querySelector('#fileInput');\n-            if (imageFileInput && imageFileInput.files.length > 0) {\n-                const imageUploadFormData = new FormData();\n-                imageUploadFormData.append('image', imageFileInput.files[0]);\n-\n-                try {\n-                    const uploadResponse = await fetch('/upload/image', {\n-                        method: 'POST',\n-                        headers: {\n-                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n-                        },\n-                        body: imageUploadFormData\n-                    });\n-\n-                    if (uploadResponse.ok) {\n-                        const uploadResult = await uploadResponse.json();\n-                        if (uploadResult.success === 1) {\n-                            formData.append('thumbnailImageUrl', uploadResult.imageUrl);\n-                        } else {\n-                            alert('이미지 업로드 실패: ' + uploadResult.message);\n-                            return; // 이미지 업로드 실패 시 전체 제출 중단\n-                        }\n-                    } else {\n-                        const errorText = await uploadResponse.text();\n-                        console.error('이미지 업로드 실패:', errorText);\n-                        alert('이미지 업로드를 실패하였습니다.');\n-                        return; // 이미지 업로드 실패 시 전체 제출 중단\n-                    }\n-                } catch (error) {\n-                    console.error('이미지 업로드 중 오류:', error);\n-                    alert('이미지 업로드 중 오류가 발생했습니다.');\n-                    return; // 이미지 업로드 실패 시 전체 제출 중단\n-                }\n-            }\n-\n-            // 3. 전송\n-            const actionUrl = isNew ? '/hospitals/new' : '/hospitals/edit';\n-\n-            try {\n-                const response = await fetch(actionUrl, {\n-                    method: 'POST',\n-                    headers: {\n-                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n-                        },\n-                    body: formData\n-                });\n-\n-                if (response.ok) {\n-                    const result = await response.json();\n-                    alert('병원 정보가 성공적으로 제출되었습니다!');\n-                    window.location.href = '/hospitals';\n-                } else {\n-                    const errorText = await response.text();\n-                    console.error('제출 실패:', errorText);\n-                    alert('제출에 실패했습니다: ' + errorText);\n-                }\n-            } catch (error) {\n-                console.error('제출 중 오류:', error);\n-                alert('제출 중 오류가 발생했습니다.');\n-            }\n-        });\n-    });\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-  // 잼민이 버전\n-//   document.addEventListener('DOMContentLoaded', function() {\n-//     const submitAllBtn = document.getElementById('submitAllBtn');\n-//     const generalDataForm = document.getElementById('generalDataForm');\n-//     const fileUploadForm = document.getElementById('fileUploadForm'); // fileUploadForm 참조 추가\n-//     const hospitalId = '[[${hospitalForm.hospitalId}]]'; // Thymeleaf 변수 사용\n-\n-//     submitAllBtn.addEventListener('click', async function(event) {\n-//       event.preventDefault(); // 기본 폼 제출 방지\n-\n-//       const formData = new FormData(generalDataForm); // generalDataForm의 데이터로 FormData 초기화\n-//       const fileInput = fileUploadForm.querySelector('#fileInput'); // fileUploadForm에서 fileInput 가져오기\n-//       if (fileInput && fileInput.files && fileInput.files[0]) {\n-//         formData.append('thumbnailImageFile', fileInput.files[0]);\n-//       }\n-\n-//       // 폼 액션 URL 결정\n-//       const actionUrl = hospitalId === 'null' ? '/hospitals/new' : '/hospitals/edit';\n-\n-//       try {\n-//         const response = await fetch(actionUrl, {\n-//                                                     method: 'POST',\n-//                                                     body: formData\n-//                                                 });\n-\n-//         if (response.ok) {\n-//           const result = await response.json(); // 또는 response.text()\n-//           console.log('Submission successful:', result);\n-//           alert('병원 정보가 성공적으로 제출되었습니다!');\n-//           // 성공 후 리다이렉트 또는 다른 작업 수행\n-//           window.location.href = '/hospitals'; // 예시: 병원 목록 페이지로 이동\n-//         } else {\n-//           const errorText = await response.text();\n-//           console.error('Submission failed:', response.status, errorText);\n-//           alert('병원 정보 제출에 실패했습니다: ' + errorText);\n-//         }\n-//       } catch (error) {\n-//         console.error('Error during submission:', error);\n-//         alert('병원 정보 제출 중 오류가 발생했습니다.');\n-//       }\n-//     });\n-//   });\n-</script>\n-\n-\n-    <th:block th:replace=\"~{/fragments/footer :: footer}\"></th:block>\n-    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q\" crossorigin=\"anonymous\"></script>\n-</body>\n-</html>\n-<!DOCTYPE html>\n-<html lang=\"ko\" xmlns:th=\"http://www.thymeleaf.org\" xmlns:sec=\"http://www.thymeleaf.org/thymeleaf-extras-springsecurity5\">\n-<head>\n-    <meta charset=\"UTF-8\">\n-    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n-    <meta name=\"_csrf\" th:content=\"${_csrf.token}\" />\n-    <meta name=\"_csrf_header\" th:content=\"${_csrf.headerName}\" />\n-\n-    <title>병원 등록</title>\n-    <!-- Bootstrap CSS -->\n-    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\">\n-    <!-- Font Awesome CSS -->\n-    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css\">\n-    <link rel=\"stylesheet\" th:href=\"@{/css/hospital_style.css}\">\n-</head>\n-<body>\n-    <th:block th:replace=\"~{/fragments/header :: header}\"></th:block>\n-    <div class=\"hospital-main-container\">\n-        <!-- 상단 로고 -->\n-        <div class=\"logo-container\">\n-            <div class=\"logo\">\n-                <img th:src=\"@{/img/hosp_logo.png}\" alt=\"병원 아이콘\" class=\"logo-icon\">\n-            </div>\n-        </div>\n-\n-        <!-- 메인 컨텐츠 -->\n-        <div class=\"main-content d-flex flex-column align-items-center\">\n-                        <!-- Hidden form for multipart file upload  잼민이버전-->\n-            <!-- <form id=\"fileUploadForm\" style=\"display: none;\" enctype=\"multipart/form-data\">\n-                <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" onchange=\"previewImage(event)\">\n-            </form> -->\n-\n-            <!-- 채찍피티 버전 -->\n-            <div class=\"d-flex justify-content-around align-items-start gap-20\">\n-\n-                <form id=\"imageForm\" enctype=\"multipart/form-data\">\n-                    <div class=\"image-upload-section\">\n-                        <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n-                            <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n-                        </div>\n-                        <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" style=\"display: none;\" onchange=\"previewImage(event)\">\n-                    </div>\n-                </form>\n-\n-\n-                <!-- Main form for general data -->\n-                <form id=\"generalDataForm\" th:object=\"${hospitalForm}\">\n-                    <input type=\"hidden\" id=\"hospitalId\" th:field=\"*{hospitalId}\" />\n-                    <!-- <input type=\"hidden\" id=\"csrfTokenGeneral\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" /> -->\n-\n-                    <div class=\"form-container\">\n-                        <!-- <div class=\"image-upload-section\">\n-                            <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n-                                <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n-                            </div>\n-                        </div> -->\n-\n-                        <div class=\"form-section\">\n-                            <div class=\"form-group\">\n-                                <label for=\"name\">병원 이름</label>\n-                                <input type=\"text\" id=\"name\" th:field=\"*{name}\" placeholder=\"병원 이름을 작성하세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"address\">병원 주소</label>\n-                                <input type=\"text\" id=\"address\" th:field=\"*{address}\" placeholder=\"주소를 입력해 주세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"homepage\">홈페이지</label>\n-                                <input type=\"url\" id=\"homepage\" th:field=\"*{homepage}\" placeholder=\"홈페이지 주소를 입력해 주세요\">\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"phone\">대표번호</label>\n-                                <input type=\"tel\" id=\"phone\" th:field=\"*{phone}\" placeholder=\"병원 전화번호를 입력하세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"email\">이메일</label>\n-                                <input type=\"email\" id=\"email\" th:field=\"*{email}\" placeholder=\"이메일 주소를 입력하세요\">\n-                            </div>\n-                            <div class=\"form-group\">\n-                                <label for=\"hosp-introduce\">병원 소개</label>\n-                                <textarea type=\"text\" id=\"hosp-introduce\" th:field=\"*{email}\" placeholder=\"간단한 소개글을 작성해 주세요\" required rows=\"4\" style=\"resize: none;\"></textarea>\n-                            </div>\n-                        </div>\n-                    </div>\n-                </form>\n-                <form id=\"checkSpecialForm\" th:object=\"${hospitalForm}\" class=\"d-flex flex-nowrap\">\n-                    <div class=\"form-group\">\n-                        <label>진료 과목</label>\n-                        <div class=\"checkbox-group\">\n-                            <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n-                                <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\n-                                <label th:for=\"'spec-' + ${spec.specialtyId}\" th:text=\"${spec.category}\"></label>\n-                            </div>\n-                        </div>\n-                    </div>\n-                </form>\n-                <form id=\"checkAnimalForm\" th:object=\"${hospitalForm}\">\n-                    <div class=\"form-group\">\n-                        <label>진료 가능 동물</label>\n-                        <div class=\"category-group\">\n-                            <label th:each=\"animal : ${animalList}\" class=\"category-item\">\n-                                <input type=\"checkbox\" name=\"category\" th:field=\"*{animalIds}\" th:value=\"${animal.animalId}\" th:id=\"'animal-' + ${animal.animalId}\">\n-                                <span th:for=\"'animal-' + ${animal.animalId}\" th:text=\"${animal.species}\"></span>\n-                            </label>\n-                        </div>\n-                    </div>\n-                </form>\n-            </div>\n-        </div>\n-\n-            <!-- 삭제 form -->\n-            <div sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">\n-                <form id=\"deleteForm\" th:action=\"@{/hospitals/delete/{id}(id=${hospitalForm.hospitalId})}\" method=\"post\" style=\"display: none;\">\n-                    <input type=\"hidden\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" />\n-                </form>\n-            </div>\n-\n-            <div class=\"d-flex justify-content-center gap-2 mt-4\">\n-                <button type=\"button\" class=\"btn btn-secondary\" onclick=\"history.back()\">취소</button>\n-                <button type=\"button\" id=\"submitAllBtn\" class=\"btn btn-primary\" th:text=\"${hospitalForm.hospitalId != null ? '수정' : '등록'}\"></button>\n-                <button type=\"button\" id=\"deleteBtn\" class=\"btn btn-danger\" sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">삭제</button>\n-            </div>\n-        </div>\n-\n-\n-<script>\n-  function previewImage(event) {\n-    const input = event.target;\n-    const reader = new FileReader();\n-\n-    reader.onload = function () {\n-      const preview = document.getElementById('preview');\n-      preview.src = reader.result;\n-    };\n-\n-    if (input.files && input.files[0]) {\n-      reader.readAsDataURL(input.files[0]);\n-    }\n-  }\n-\n-\n-  // 채찍피티 버전\n-    document.addEventListener('DOMContentLoaded', function () {\n-        const submitAllBtn = document.getElementById('submitAllBtn');\n-        const imageForm = document.getElementById('imageForm');\n-        const generalDataForm = document.getElementById('generalDataForm');\n-        // const hospitalId = '[[${hospitalForm.hospitalId}]]';\n-        const hospitalId = document.getElementById('hospitalId')?.value;\n-        const isNew = !hospitalId || hospitalId === 'null' || hospitalId === '';\n-\n-        const csrfToken = document.querySelector('meta[name=\"_csrf\"]').content;\n-        const csrfHeader = document.querySelector('meta[name=\"_csrf_header\"]').content;\n-\n-        const deleteBtn = document.getElementById('deleteBtn');\n-        if (deleteBtn) {\n-            deleteBtn.addEventListener('click', function() {\n-                if (confirm('정말로 이 병원을 삭제하시겠습니까?')) {\n-                    document.getElementById('deleteForm').submit();\n-                }\n-            });\n-        }\n-\n-        submitAllBtn.addEventListener('click', async function (event) {\n-            event.preventDefault();\n-\n-            const formData = new FormData();\n-\n-            // 1. 일반 입력값 병합\n-            const generalFormData = new FormData(generalDataForm);\n-            for (const [key, value] of generalFormData.entries()) {\n-                formData.append(key, value);\n-            }\n-\n-            // 2. 이미지 파일 업로드 및 URL 병합\n-            const imageFileInput = imageForm.querySelector('#fileInput');\n-            if (imageFileInput && imageFileInput.files.length > 0) {\n-                const imageUploadFormData = new FormData();\n-                imageUploadFormData.append('image', imageFileInput.files[0]);\n-\n-                try {\n-                    const uploadResponse = await fetch('/upload/image', {\n-                        method: 'POST',\n-                        headers: {\n-                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n-                        },\n-                        body: imageUploadFormData\n-                    });\n-\n-                    if (uploadResponse.ok) {\n-                        const uploadResult = await uploadResponse.json();\n-                        if (uploadResult.success === 1) {\n-                            formData.append('thumbnailImageUrl', uploadResult.imageUrl);\n-                        } else {\n-                            alert('이미지 업로드 실패: ' + uploadResult.message);\n-                            return; // 이미지 업로드 실패 시 전체 제출 중단\n-                        }\n-                    } else {\n-                        const errorText = await uploadResponse.text();\n-                        console.error('이미지 업로드 실패:', errorText);\n-                        alert('이미지 업로드를 실패하였습니다.');\n-                        return; // 이미지 업로드 실패 시 전체 제출 중단\n-                    }\n-                } catch (error) {\n-                    console.error('이미지 업로드 중 오류:', error);\n-                    alert('이미지 업로드 중 오류가 발생했습니다.');\n-                    return; // 이미지 업로드 실패 시 전체 제출 중단\n-                }\n-            }\n-\n-            // 3. 전송\n-            const actionUrl = isNew ? '/hospitals/new' : '/hospitals/edit';\n-\n-            try {\n-                const response = await fetch(actionUrl, {\n-                    method: 'POST',\n-                    headers: {\n-                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n-                        },\n-                    body: formData\n-                });\n-\n-                if (response.ok) {\n-                    const result = await response.json();\n-                    alert('병원 정보가 성공적으로 제출되었습니다!');\n-                    window.location.href = '/hospitals';\n-                } else {\n-                    const errorText = await response.text();\n-                    console.error('제출 실패:', errorText);\n-                    alert('제출에 실패했습니다: ' + errorText);\n-                }\n-            } catch (error) {\n-                console.error('제출 중 오류:', error);\n-                alert('제출 중 오류가 발생했습니다.');\n-            }\n-        });\n-    });\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-  // 잼민이 버전\n-//   document.addEventListener('DOMContentLoaded', function() {\n-//     const submitAllBtn = document.getElementById('submitAllBtn');\n-//     const generalDataForm = document.getElementById('generalDataForm');\n-//     const fileUploadForm = document.getElementById('fileUploadForm'); // fileUploadForm 참조 추가\n-//     const hospitalId = '[[${hospitalForm.hospitalId}]]'; // Thymeleaf 변수 사용\n-\n-//     submitAllBtn.addEventListener('click', async function(event) {\n-//       event.preventDefault(); // 기본 폼 제출 방지\n-\n-//       const formData = new FormData(generalDataForm); // generalDataForm의 데이터로 FormData 초기화\n-//       const fileInput = fileUploadForm.querySelector('#fileInput'); // fileUploadForm에서 fileInput 가져오기\n-//       if (fileInput && fileInput.files && fileInput.files[0]) {\n-//         formData.append('thumbnailImageFile', fileInput.files[0]);\n-//       }\n-\n-//       // 폼 액션 URL 결정\n-//       const actionUrl = hospitalId === 'null' ? '/hospitals/new' : '/hospitals/edit';\n-\n-//       try {\n-//         const response = await fetch(actionUrl, {\n-//                                                     method: 'POST',\n-//                                                     body: formData\n-//                                                 });\n-\n-//         if (response.ok) {\n-//           const result = await response.json(); // 또는 response.text()\n-//           console.log('Submission successful:', result);\n-//           alert('병원 정보가 성공적으로 제출되었습니다!');\n-//           // 성공 후 리다이렉트 또는 다른 작업 수행\n-//           window.location.href = '/hospitals'; // 예시: 병원 목록 페이지로 이동\n-//         } else {\n-//           const errorText = await response.text();\n-//           console.error('Submission failed:', response.status, errorText);\n-//           alert('병원 정보 제출에 실패했습니다: ' + errorText);\n-//         }\n-//       } catch (error) {\n-//         console.error('Error during submission:', error);\n-//         alert('병원 정보 제출 중 오류가 발생했습니다.');\n-//       }\n-//     });\n-//   });\n-</script>\n-\n-\n-    <th:block th:replace=\"~{/fragments/footer :: footer}\"></th:block>\n-    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q\" crossorigin=\"anonymous\"></script>\n-</body>\n-</html>\n-<!DOCTYPE html>\n-<html lang=\"ko\" xmlns:th=\"http://www.thymeleaf.org\" xmlns:sec=\"http://www.thymeleaf.org/thymeleaf-extras-springsecurity5\">\n-<head>\n-    <meta charset=\"UTF-8\">\n-    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n-    <meta name=\"_csrf\" th:content=\"${_csrf.token}\" />\n-    <meta name=\"_csrf_header\" th:content=\"${_csrf.headerName}\" />\n-\n-    <title>병원 등록</title>\n-    <!-- Bootstrap CSS -->\n-    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\">\n-    <!-- Font Awesome CSS -->\n-    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css\">\n-    <link rel=\"stylesheet\" th:href=\"@{/css/hospital_style.css}\">\n-</head>\n-<body>\n-    <th:block th:replace=\"~{/fragments/header :: header}\"></th:block>\n-    <div class=\"hospital-main-container\">\n-        <!-- 상단 로고 -->\n-        <div class=\"logo-container\">\n-            <div class=\"logo\">\n-                <img th:src=\"@{/img/hosp_logo.png}\" alt=\"병원 아이콘\" class=\"logo-icon\">\n-            </div>\n-        </div>\n-\n-        <!-- 메인 컨텐츠 -->\n-        <div class=\"main-content d-flex flex-column align-items-center\">\n-                        <!-- Hidden form for multipart file upload  잼민이버전-->\n-            <!-- <form id=\"fileUploadForm\" style=\"display: none;\" enctype=\"multipart/form-data\">\n-                <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" onchange=\"previewImage(event)\">\n-            </form> -->\n-\n-            <!-- 채찍피티 버전 -->\n-            <div class=\"d-flex justify-content-around align-items-start gap-20\">\n-\n-                <form id=\"imageForm\" enctype=\"multipart/form-data\">\n-                    <div class=\"image-upload-section\">\n-                        <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n-                            <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n-                        </div>\n-                        <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" style=\"display: none;\" onchange=\"previewImage(event)\">\n-                    </div>\n-                </form>\n-\n-\n-                <!-- Main form for general data -->\n-                <form id=\"generalDataForm\" th:object=\"${hospitalForm}\">\n-                    <input type=\"hidden\" id=\"hospitalId\" th:field=\"*{hospitalId}\" />\n-                    <!-- <input type=\"hidden\" id=\"csrfTokenGeneral\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" /> -->\n-\n-                    <div class=\"form-container\">\n-                        <!-- <div class=\"image-upload-section\">\n-                            <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n-                                <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n-                            </div>\n-                        </div> -->\n-\n-                        <div class=\"form-section\">\n-                            <div class=\"form-group\">\n-                                <label for=\"name\">병원 이름</label>\n-                                <input type=\"text\" id=\"name\" th:field=\"*{name}\" placeholder=\"병원 이름을 작성하세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"address\">병원 주소</label>\n-                                <input type=\"text\" id=\"address\" th:field=\"*{address}\" placeholder=\"주소를 입력해 주세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"homepage\">홈페이지</label>\n-                                <input type=\"url\" id=\"homepage\" th:field=\"*{homepage}\" placeholder=\"홈페이지 주소를 입력해 주세요\">\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"phone\">대표번호</label>\n-                                <input type=\"tel\" id=\"phone\" th:field=\"*{phone}\" placeholder=\"병원 전화번호를 입력하세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"email\">이메일</label>\n-                                <input type=\"email\" id=\"email\" th:field=\"*{email}\" placeholder=\"이메일 주소를 입력하세요\">\n-                            </div>\n-                            <div class=\"form-group\">\n-                                <label for=\"hosp-introduce\">병원 소개</label>\n-                                <textarea type=\"text\" id=\"hosp-introduce\" th:field=\"*{email}\" placeholder=\"간단한 소개글을 작성해 주세요\" required rows=\"4\" style=\"resize: none;\"></textarea>\n-                            </div>\n-                        </div>\n-                    </div>\n-                </form>\n-                <form id=\"checkSpecialForm\" th:object=\"${hospitalForm}\">\n-                    <div class=\"form-group\">\n-                        <label>진료 과목</label>\n-                        <div class=\"checkbox-group\">\n-                            <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n-                                <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\n-                                <label th:for=\"'spec-' + ${spec.specialtyId}\" th:text=\"${spec.category}\"></label>\n-                            </div>\n-                            <input type=\"text\" id=\"specialty\" placeholder=\"진료 과목을 입력하세요\" required>\n-                        </div>\n-                    </div>\n-                </form>\n-                <form id=\"checkAnimalForm\" th:object=\"${hospitalForm}\">\n-                    <div class=\"form-group\">\n-                        <label>진료 가능 동물</label>\n-                        <div class=\"category-group\">\n-                            <label th:each=\"animal : ${animalList}\" class=\"category-item\">\n-                                <input type=\"checkbox\" name=\"category\" th:field=\"*{animalIds}\" th:value=\"${animal.animalId}\" th:id=\"'animal-' + ${animal.animalId}\">\n-                                <span th:for=\"'animal-' + ${animal.animalId}\" th:text=\"${animal.species}\"></span>\n-                            </label>\n-                        </div>\n-                    </div>\n-                </form>\n-            </div>\n-        </div>\n-\n-            <!-- 삭제 form -->\n-            <div sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">\n-                <form id=\"deleteForm\" th:action=\"@{/hospitals/delete/{id}(id=${hospitalForm.hospitalId})}\" method=\"post\" style=\"display: none;\">\n-                    <input type=\"hidden\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" />\n-                </form>\n-            </div>\n-\n-            <div class=\"d-flex justify-content-center gap-2 mt-4\">\n-                <button type=\"button\" class=\"btn btn-secondary\" onclick=\"history.back()\">취소</button>\n-                <button type=\"button\" id=\"submitAllBtn\" class=\"btn btn-primary\" th:text=\"${hospitalForm.hospitalId != null ? '수정' : '등록'}\"></button>\n-                <button type=\"button\" id=\"deleteBtn\" class=\"btn btn-danger\" sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">삭제</button>\n-            </div>\n-        </div>\n-\n-\n-<script>\n-  function previewImage(event) {\n-    const input = event.target;\n-    const reader = new FileReader();\n-\n-    reader.onload = function () {\n-      const preview = document.getElementById('preview');\n-      preview.src = reader.result;\n-    };\n-\n-    if (input.files && input.files[0]) {\n-      reader.readAsDataURL(input.files[0]);\n-    }\n-  }\n-\n-\n-  // 채찍피티 버전\n-    document.addEventListener('DOMContentLoaded', function () {\n-        const submitAllBtn = document.getElementById('submitAllBtn');\n-        const imageForm = document.getElementById('imageForm');\n-        const generalDataForm = document.getElementById('generalDataForm');\n-        // const hospitalId = '[[${hospitalForm.hospitalId}]]';\n-        const hospitalId = document.getElementById('hospitalId')?.value;\n-        const isNew = !hospitalId || hospitalId === 'null' || hospitalId === '';\n-\n-        const csrfToken = document.querySelector('meta[name=\"_csrf\"]').content;\n-        const csrfHeader = document.querySelector('meta[name=\"_csrf_header\"]').content;\n-\n-        const deleteBtn = document.getElementById('deleteBtn');\n-        if (deleteBtn) {\n-            deleteBtn.addEventListener('click', function() {\n-                if (confirm('정말로 이 병원을 삭제하시겠습니까?')) {\n-                    document.getElementById('deleteForm').submit();\n-                }\n-            });\n-        }\n-\n-        submitAllBtn.addEventListener('click', async function (event) {\n-            event.preventDefault();\n-\n-            const formData = new FormData();\n-\n-            // 1. 일반 입력값 병합\n-            const generalFormData = new FormData(generalDataForm);\n-            for (const [key, value] of generalFormData.entries()) {\n-                formData.append(key, value);\n-            }\n-\n-            // 2. 이미지 파일 업로드 및 URL 병합\n-            const imageFileInput = imageForm.querySelector('#fileInput');\n-            if (imageFileInput && imageFileInput.files.length > 0) {\n-                const imageUploadFormData = new FormData();\n-                imageUploadFormData.append('image', imageFileInput.files[0]);\n-\n-                try {\n-                    const uploadResponse = await fetch('/upload/image', {\n-                        method: 'POST',\n-                        headers: {\n-                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n-                        },\n-                        body: imageUploadFormData\n-                    });\n-\n-                    if (uploadResponse.ok) {\n-                        const uploadResult = await uploadResponse.json();\n-                        if (uploadResult.success === 1) {\n-                            formData.append('thumbnailImageUrl', uploadResult.imageUrl);\n-                        } else {\n-                            alert('이미지 업로드 실패: ' + uploadResult.message);\n-                            return; // 이미지 업로드 실패 시 전체 제출 중단\n-                        }\n-                    } else {\n-                        const errorText = await uploadResponse.text();\n-                        console.error('이미지 업로드 실패:', errorText);\n-                        alert('이미지 업로드를 실패하였습니다.');\n-                        return; // 이미지 업로드 실패 시 전체 제출 중단\n-                    }\n-                } catch (error) {\n-                    console.error('이미지 업로드 중 오류:', error);\n-                    alert('이미지 업로드 중 오류가 발생했습니다.');\n-                    return; // 이미지 업로드 실패 시 전체 제출 중단\n-                }\n-            }\n-\n-            // 3. 전송\n-            const actionUrl = isNew ? '/hospitals/new' : '/hospitals/edit';\n-\n-            try {\n-                const response = await fetch(actionUrl, {\n-                    method: 'POST',\n-                    headers: {\n-                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n-                        },\n-                    body: formData\n-                });\n-\n-                if (response.ok) {\n-                    const result = await response.json();\n-                    alert('병원 정보가 성공적으로 제출되었습니다!');\n-                    window.location.href = '/hospitals';\n-                } else {\n-                    const errorText = await response.text();\n-                    console.error('제출 실패:', errorText);\n-                    alert('제출에 실패했습니다: ' + errorText);\n-                }\n-            } catch (error) {\n-                console.error('제출 중 오류:', error);\n-                alert('제출 중 오류가 발생했습니다.');\n-            }\n-        });\n-    });\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-  // 잼민이 버전\n-//   document.addEventListener('DOMContentLoaded', function() {\n-//     const submitAllBtn = document.getElementById('submitAllBtn');\n-//     const generalDataForm = document.getElementById('generalDataForm');\n-//     const fileUploadForm = document.getElementById('fileUploadForm'); // fileUploadForm 참조 추가\n-//     const hospitalId = '[[${hospitalForm.hospitalId}]]'; // Thymeleaf 변수 사용\n-\n-//     submitAllBtn.addEventListener('click', async function(event) {\n-//       event.preventDefault(); // 기본 폼 제출 방지\n-\n-//       const formData = new FormData(generalDataForm); // generalDataForm의 데이터로 FormData 초기화\n-//       const fileInput = fileUploadForm.querySelector('#fileInput'); // fileUploadForm에서 fileInput 가져오기\n-//       if (fileInput && fileInput.files && fileInput.files[0]) {\n-//         formData.append('thumbnailImageFile', fileInput.files[0]);\n-//       }\n-\n-//       // 폼 액션 URL 결정\n-//       const actionUrl = hospitalId === 'null' ? '/hospitals/new' : '/hospitals/edit';\n-\n-//       try {\n-//         const response = await fetch(actionUrl, {\n-//                                                     method: 'POST',\n-//                                                     body: formData\n-//                                                 });\n-\n-//         if (response.ok) {\n-//           const result = await response.json(); // 또는 response.text()\n-//           console.log('Submission successful:', result);\n-//           alert('병원 정보가 성공적으로 제출되었습니다!');\n-//           // 성공 후 리다이렉트 또는 다른 작업 수행\n-//           window.location.href = '/hospitals'; // 예시: 병원 목록 페이지로 이동\n-//         } else {\n-//           const errorText = await response.text();\n-//           console.error('Submission failed:', response.status, errorText);\n-//           alert('병원 정보 제출에 실패했습니다: ' + errorText);\n-//         }\n-//       } catch (error) {\n-//         console.error('Error during submission:', error);\n-//         alert('병원 정보 제출 중 오류가 발생했습니다.');\n-//       }\n-//     });\n-//   });\n-</script>\n-\n-\n-    <th:block th:replace=\"~{/fragments/footer :: footer}\"></th:block>\n-    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q\" crossorigin=\"anonymous\"></script>\n-</body>\n-</html>\n-<!DOCTYPE html>\n-<html lang=\"ko\" xmlns:th=\"http://www.thymeleaf.org\" xmlns:sec=\"http://www.thymeleaf.org/thymeleaf-extras-springsecurity5\">\n-<head>\n-    <meta charset=\"UTF-8\">\n-    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n-    <meta name=\"_csrf\" th:content=\"${_csrf.token}\" />\n-    <meta name=\"_csrf_header\" th:content=\"${_csrf.headerName}\" />\n-\n-    <title>병원 등록</title>\n-    <!-- Bootstrap CSS -->\n-    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\">\n-    <!-- Font Awesome CSS -->\n-    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css\">\n-    <link rel=\"stylesheet\" th:href=\"@{/css/hospital_style.css}\">\n-</head>\n-<body>\n-    <th:block th:replace=\"~{/fragments/header :: header}\"></th:block>\n-    <div class=\"hospital-main-container\">\n-        <!-- 상단 로고 -->\n-        <div class=\"logo-container\">\n-            <div class=\"logo\">\n-                <img th:src=\"@{/img/hosp_logo.png}\" alt=\"병원 아이콘\" class=\"logo-icon\">\n-            </div>\n-        </div>\n-\n-        <!-- 메인 컨텐츠 -->\n-        <div class=\"main-content\">\n-                        <!-- Hidden form for multipart file upload  잼민이버전-->\n-            <!-- <form id=\"fileUploadForm\" style=\"display: none;\" enctype=\"multipart/form-data\">\n-                <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" onchange=\"previewImage(event)\">\n-            </form> -->\n-\n-            <!-- 채찍피티 버전 -->\n-            <div class=\"d-flex justify-content-around align-items-start gap-20\">\n-\n-                <form id=\"imageForm\" enctype=\"multipart/form-data\">\n-                    <div class=\"image-upload-section\">\n-                        <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n-                            <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n-                        </div>\n-                        <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" style=\"display: none;\" onchange=\"previewImage(event)\">\n-                    </div>\n-                </form>\n-\n-\n-                <!-- Main form for general data -->\n-                <form id=\"generalDataForm\" th:object=\"${hospitalForm}\">\n-                    <input type=\"hidden\" id=\"hospitalId\" th:field=\"*{hospitalId}\" />\n-                    <!-- <input type=\"hidden\" id=\"csrfTokenGeneral\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" /> -->\n-\n-                    <div class=\"form-container\">\n-                        <!-- <div class=\"image-upload-section\">\n-                            <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n-                                <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n-                            </div>\n-                        </div> -->\n-\n-                        <div class=\"form-section\">\n-                            <div class=\"form-group\">\n-                                <label for=\"name\">병원 이름</label>\n-                                <input type=\"text\" id=\"name\" th:field=\"*{name}\" placeholder=\"병원 이름을 작성하세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"address\">병원 주소</label>\n-                                <input type=\"text\" id=\"address\" th:field=\"*{address}\" placeholder=\"주소를 입력해 주세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"homepage\">홈페이지</label>\n-                                <input type=\"url\" id=\"homepage\" th:field=\"*{homepage}\" placeholder=\"홈페이지 주소를 입력해 주세요\">\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"phone\">대표번호</label>\n-                                <input type=\"tel\" id=\"phone\" th:field=\"*{phone}\" placeholder=\"병원 전화번호를 입력하세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"email\">이메일</label>\n-                                <input type=\"email\" id=\"email\" th:field=\"*{email}\" placeholder=\"이메일 주소를 입력하세요\">\n-                            </div>\n-                            <div class=\"form-group\">\n-                                <label for=\"hosp-introduce\">병원 소개</label>\n-                                <textarea type=\"text\" id=\"hosp-introduce\" th:field=\"*{email}\" placeholder=\"간단한 소개글을 작성해 주세요\" required rows=\"4\" style=\"resize: none;\"></textarea>\n-                            </div>\n-                        </div>\n-                    </div>\n-                </form>\n-                <form id=\"checkSpecialForm\" th:object=\"${hospitalForm}\">\n-                    <div class=\"form-group\">\n-                        <label>진료 과목</label>\n-                        <div class=\"checkbox-group\">\n-                            <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n-                                <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\n-                                <label th:for=\"'spec-' + ${spec.specialtyId}\" th:text=\"${spec.category}\"></label>\n-                            </div>\n-                            <input type=\"text\" id=\"specialty\" placeholder=\"진료 과목을 입력하세요\" required>\n-                        </div>\n-                    </div>\n-                </form>\n-                <form id=\"checkAnimalForm\" th:object=\"${hospitalForm}\">\n-                    <div class=\"form-group\">\n-                        <label>진료 가능 동물</label>\n-                        <div class=\"category-group\">\n-                            <label th:each=\"animal : ${animalList}\" class=\"category-item\">\n-                                <input type=\"checkbox\" name=\"category\" th:field=\"*{animalIds}\" th:value=\"${animal.animalId}\" th:id=\"'animal-' + ${animal.animalId}\">\n-                                <span th:for=\"'animal-' + ${animal.animalId}\" th:text=\"${animal.species}\"></span>\n-                            </label>\n-                        </div>\n-                    </div>\n-                </form>\n-            </div>\n-        </div>\n-\n-            <!-- 삭제 form -->\n-            <div sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">\n-                <form id=\"deleteForm\" th:action=\"@{/hospitals/delete/{id}(id=${hospitalForm.hospitalId})}\" method=\"post\" style=\"display: none;\">\n-                    <input type=\"hidden\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" />\n-                </form>\n-            </div>\n-\n-            <div class=\"d-flex justify-content-center gap-2 mt-4\">\n-                <button type=\"button\" class=\"btn btn-secondary\" onclick=\"history.back()\">취소</button>\n-                <button type=\"button\" id=\"submitAllBtn\" class=\"btn btn-primary\" th:text=\"${hospitalForm.hospitalId != null ? '수정' : '등록'}\"></button>\n-                <button type=\"button\" id=\"deleteBtn\" class=\"btn btn-danger\" sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">삭제</button>\n-            </div>\n-        </div>\n-\n-\n-<script>\n-  function previewImage(event) {\n-    const input = event.target;\n-    const reader = new FileReader();\n-\n-    reader.onload = function () {\n-      const preview = document.getElementById('preview');\n-      preview.src = reader.result;\n-    };\n-\n-    if (input.files && input.files[0]) {\n-      reader.readAsDataURL(input.files[0]);\n-    }\n-  }\n-\n-\n-  // 채찍피티 버전\n-    document.addEventListener('DOMContentLoaded', function () {\n-        const submitAllBtn = document.getElementById('submitAllBtn');\n-        const imageForm = document.getElementById('imageForm');\n-        const generalDataForm = document.getElementById('generalDataForm');\n-        // const hospitalId = '[[${hospitalForm.hospitalId}]]';\n-        const hospitalId = document.getElementById('hospitalId')?.value;\n-        const isNew = !hospitalId || hospitalId === 'null' || hospitalId === '';\n-\n-        const csrfToken = document.querySelector('meta[name=\"_csrf\"]').content;\n-        const csrfHeader = document.querySelector('meta[name=\"_csrf_header\"]').content;\n-\n-        const deleteBtn = document.getElementById('deleteBtn');\n-        if (deleteBtn) {\n-            deleteBtn.addEventListener('click', function() {\n-                if (confirm('정말로 이 병원을 삭제하시겠습니까?')) {\n-                    document.getElementById('deleteForm').submit();\n-                }\n-            });\n-        }\n-\n-        submitAllBtn.addEventListener('click', async function (event) {\n-            event.preventDefault();\n-\n-            const formData = new FormData();\n-\n-            // 1. 일반 입력값 병합\n-            const generalFormData = new FormData(generalDataForm);\n-            for (const [key, value] of generalFormData.entries()) {\n-                formData.append(key, value);\n-            }\n-\n-            // 2. 이미지 파일 업로드 및 URL 병합\n-            const imageFileInput = imageForm.querySelector('#fileInput');\n-            if (imageFileInput && imageFileInput.files.length > 0) {\n-                const imageUploadFormData = new FormData();\n-                imageUploadFormData.append('image', imageFileInput.files[0]);\n-\n-                try {\n-                    const uploadResponse = await fetch('/upload/image', {\n-                        method: 'POST',\n-                        headers: {\n-                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n-                        },\n-                        body: imageUploadFormData\n-                    });\n-\n-                    if (uploadResponse.ok) {\n-                        const uploadResult = await uploadResponse.json();\n-                        if (uploadResult.success === 1) {\n-                            formData.append('thumbnailImageUrl', uploadResult.imageUrl);\n-                        } else {\n-                            alert('이미지 업로드 실패: ' + uploadResult.message);\n-                            return; // 이미지 업로드 실패 시 전체 제출 중단\n-                        }\n-                    } else {\n-                        const errorText = await uploadResponse.text();\n-                        console.error('이미지 업로드 실패:', errorText);\n-                        alert('이미지 업로드를 실패하였습니다.');\n-                        return; // 이미지 업로드 실패 시 전체 제출 중단\n-                    }\n-                } catch (error) {\n-                    console.error('이미지 업로드 중 오류:', error);\n-                    alert('이미지 업로드 중 오류가 발생했습니다.');\n-                    return; // 이미지 업로드 실패 시 전체 제출 중단\n-                }\n-            }\n-\n-            // 3. 전송\n-            const actionUrl = isNew ? '/hospitals/new' : '/hospitals/edit';\n-\n-            try {\n-                const response = await fetch(actionUrl, {\n-                    method: 'POST',\n-                    headers: {\n-                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n-                        },\n-                    body: formData\n-                });\n-\n-                if (response.ok) {\n-                    const result = await response.json();\n-                    alert('병원 정보가 성공적으로 제출되었습니다!');\n-                    window.location.href = '/hospitals';\n-                } else {\n-                    const errorText = await response.text();\n-                    console.error('제출 실패:', errorText);\n-                    alert('제출에 실패했습니다: ' + errorText);\n-                }\n-            } catch (error) {\n-                console.error('제출 중 오류:', error);\n-                alert('제출 중 오류가 발생했습니다.');\n-            }\n-        });\n-    });\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-  // 잼민이 버전\n-//   document.addEventListener('DOMContentLoaded', function() {\n-//     const submitAllBtn = document.getElementById('submitAllBtn');\n-//     const generalDataForm = document.getElementById('generalDataForm');\n-//     const fileUploadForm = document.getElementById('fileUploadForm'); // fileUploadForm 참조 추가\n-//     const hospitalId = '[[${hospitalForm.hospitalId}]]'; // Thymeleaf 변수 사용\n-\n-//     submitAllBtn.addEventListener('click', async function(event) {\n-//       event.preventDefault(); // 기본 폼 제출 방지\n-\n-//       const formData = new FormData(generalDataForm); // generalDataForm의 데이터로 FormData 초기화\n-//       const fileInput = fileUploadForm.querySelector('#fileInput'); // fileUploadForm에서 fileInput 가져오기\n-//       if (fileInput && fileInput.files && fileInput.files[0]) {\n-//         formData.append('thumbnailImageFile', fileInput.files[0]);\n-//       }\n-\n-//       // 폼 액션 URL 결정\n-//       const actionUrl = hospitalId === 'null' ? '/hospitals/new' : '/hospitals/edit';\n-\n-//       try {\n-//         const response = await fetch(actionUrl, {\n-//                                                     method: 'POST',\n-//                                                     body: formData\n-//                                                 });\n-\n-//         if (response.ok) {\n-//           const result = await response.json(); // 또는 response.text()\n-//           console.log('Submission successful:', result);\n-//           alert('병원 정보가 성공적으로 제출되었습니다!');\n-//           // 성공 후 리다이렉트 또는 다른 작업 수행\n-//           window.location.href = '/hospitals'; // 예시: 병원 목록 페이지로 이동\n-//         } else {\n-//           const errorText = await response.text();\n-//           console.error('Submission failed:', response.status, errorText);\n-//           alert('병원 정보 제출에 실패했습니다: ' + errorText);\n-//         }\n-//       } catch (error) {\n-//         console.error('Error during submission:', error);\n-//         alert('병원 정보 제출 중 오류가 발생했습니다.');\n-//       }\n-//     });\n-//   });\n-</script>\n-\n-\n-    <th:block th:replace=\"~{/fragments/footer :: footer}\"></th:block>\n-    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q\" crossorigin=\"anonymous\"></script>\n-</body>\n-</html>\n-<!DOCTYPE html>\n-<html lang=\"ko\" xmlns:th=\"http://www.thymeleaf.org\" xmlns:sec=\"http://www.thymeleaf.org/thymeleaf-extras-springsecurity5\">\n-<head>\n-    <meta charset=\"UTF-8\">\n-    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n-    <meta name=\"_csrf\" th:content=\"${_csrf.token}\" />\n-    <meta name=\"_csrf_header\" th:content=\"${_csrf.headerName}\" />\n-\n-    <title>병원 등록</title>\n-    <!-- Bootstrap CSS -->\n-    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\">\n-    <!-- Font Awesome CSS -->\n-    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css\">\n-    <link rel=\"stylesheet\" th:href=\"@{/css/hospital_style.css}\">\n-</head>\n-<body>\n-    <th:block th:replace=\"~{/fragments/header :: header}\"></th:block>\n-    <div class=\"hospital-main-container\">\n-        <!-- 상단 로고 -->\n-        <div class=\"logo-container\">\n-            <div class=\"logo\">\n-                <img th:src=\"@{/img/hosp_logo.png}\" alt=\"병원 아이콘\" class=\"logo-icon\">\n-            </div>\n-        </div>\n-\n-        <!-- 메인 컨텐츠 -->\n-        <div class=\"main-content\">\n-                        <!-- Hidden form for multipart file upload  잼민이버전-->\n-            <!-- <form id=\"fileUploadForm\" style=\"display: none;\" enctype=\"multipart/form-data\">\n-                <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" onchange=\"previewImage(event)\">\n-            </form> -->\n-\n-            <!-- 채찍피티 버전 -->\n-            <div class=\"d-flex justify-content-around align-items-start gap-20\">\n-\n-                <form id=\"imageForm\" enctype=\"multipart/form-data\">\n-                    <div class=\"image-upload-section\">\n-                        <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n-                            <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n-                        </div>\n-                        <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" style=\"display: none;\" onchange=\"previewImage(event)\">\n-                    </div>\n-                </form>\n-\n-\n-                <!-- Main form for general data -->\n-                <form id=\"generalDataForm\" th:object=\"${hospitalForm}\">\n-                    <input type=\"hidden\" id=\"hospitalId\" th:field=\"*{hospitalId}\" />\n-                    <!-- <input type=\"hidden\" id=\"csrfTokenGeneral\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" /> -->\n-\n-                    <div class=\"form-container\">\n-                        <!-- <div class=\"image-upload-section\">\n-                            <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n-                                <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n-                            </div>\n-                        </div> -->\n-\n-                        <div class=\"form-section\">\n-                            <div class=\"form-group\">\n-                                <label for=\"name\">병원 이름</label>\n-                                <input type=\"text\" id=\"name\" th:field=\"*{name}\" placeholder=\"병원 이름을 작성하세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"address\">병원 주소</label>\n-                                <input type=\"text\" id=\"address\" th:field=\"*{address}\" placeholder=\"주소를 입력해 주세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"homepage\">홈페이지</label>\n-                                <input type=\"url\" id=\"homepage\" th:field=\"*{homepage}\" placeholder=\"홈페이지 주소를 입력해 주세요\">\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"phone\">대표번호</label>\n-                                <input type=\"tel\" id=\"phone\" th:field=\"*{phone}\" placeholder=\"병원 전화번호를 입력하세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"email\">이메일</label>\n-                                <input type=\"email\" id=\"email\" th:field=\"*{email}\" placeholder=\"이메일 주소를 입력하세요\">\n-                            </div>\n-                            <div class=\"form-group\">\n-                                <label for=\"hosp-introduce\">병원 소개</label>\n-                                <textarea type=\"text\" id=\"hosp-introduce\" th:field=\"*{email}\" placeholder=\"간단한 소개글을 작성해 주세요\" required rows=\"4\" style=\"resize: none;\"></textarea>\n-                            </div>\n-                        </div>\n-                    </div>\n-                </form>\n-                <form id=\"checkboxForm\" th:object=\"${hospitalForm}\">\n-                    <div class=\"form-group\">\n-                        <label>진료 과목</label>\n-                        <div class=\"checkbox-group\">\n-                            <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n-                                <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\n-                                <label th:for=\"'spec-' + ${spec.specialtyId}\" th:text=\"${spec.category}\"></label>\n-                            </div>\n-                            <input type=\"text\" id=\"specialty\" placeholder=\"진료 과목을 입력하세요\" required>\n-                        </div>\n-                    </div>\n-                </form>\n-                <form id=\"checkboxForm\" th:object=\"${hospitalForm}\">\n-                    <div class=\"form-group\">\n-                        <label>진료 가능 동물</label>\n-                        <div class=\"category-group\">\n-                            <label th:each=\"animal : ${animalList}\" class=\"category-item\">\n-                                <input type=\"checkbox\" name=\"category\" th:field=\"*{animalIds}\" th:value=\"${animal.animalId}\" th:id=\"'animal-' + ${animal.animalId}\">\n-                                <span th:for=\"'animal-' + ${animal.animalId}\" th:text=\"${animal.species}\"></span>\n-                            </label>\n-                        </div>\n-                    </div>\n-                </form>\n-            </div>\n-        </div>\n-\n-            <!-- 삭제 form -->\n-            <div sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">\n-                <form id=\"deleteForm\" th:action=\"@{/hospitals/delete/{id}(id=${hospitalForm.hospitalId})}\" method=\"post\" style=\"display: none;\">\n-                    <input type=\"hidden\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" />\n-                </form>\n-            </div>\n-\n-            <div class=\"d-flex justify-content-center gap-2 mt-4\">\n-                <button type=\"button\" class=\"btn btn-secondary\" onclick=\"history.back()\">취소</button>\n-                <button type=\"button\" id=\"submitAllBtn\" class=\"btn btn-primary\" th:text=\"${hospitalForm.hospitalId != null ? '수정' : '등록'}\"></button>\n-                <button type=\"button\" id=\"deleteBtn\" class=\"btn btn-danger\" sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">삭제</button>\n-            </div>\n-        </div>\n-\n-\n-<script>\n-  function previewImage(event) {\n-    const input = event.target;\n-    const reader = new FileReader();\n-\n-    reader.onload = function () {\n-      const preview = document.getElementById('preview');\n-      preview.src = reader.result;\n-    };\n-\n-    if (input.files && input.files[0]) {\n-      reader.readAsDataURL(input.files[0]);\n-    }\n-  }\n-\n-\n-  // 채찍피티 버전\n-    document.addEventListener('DOMContentLoaded', function () {\n-        const submitAllBtn = document.getElementById('submitAllBtn');\n-        const imageForm = document.getElementById('imageForm');\n-        const generalDataForm = document.getElementById('generalDataForm');\n-        // const hospitalId = '[[${hospitalForm.hospitalId}]]';\n-        const hospitalId = document.getElementById('hospitalId')?.value;\n-        const isNew = !hospitalId || hospitalId === 'null' || hospitalId === '';\n-\n-        const csrfToken = document.querySelector('meta[name=\"_csrf\"]').content;\n-        const csrfHeader = document.querySelector('meta[name=\"_csrf_header\"]').content;\n-\n-        const deleteBtn = document.getElementById('deleteBtn');\n-        if (deleteBtn) {\n-            deleteBtn.addEventListener('click', function() {\n-                if (confirm('정말로 이 병원을 삭제하시겠습니까?')) {\n-                    document.getElementById('deleteForm').submit();\n-                }\n-            });\n-        }\n-\n-        submitAllBtn.addEventListener('click', async function (event) {\n-            event.preventDefault();\n-\n-            const formData = new FormData();\n-\n-            // 1. 일반 입력값 병합\n-            const generalFormData = new FormData(generalDataForm);\n-            for (const [key, value] of generalFormData.entries()) {\n-                formData.append(key, value);\n-            }\n-\n-            // 2. 이미지 파일 업로드 및 URL 병합\n-            const imageFileInput = imageForm.querySelector('#fileInput');\n-            if (imageFileInput && imageFileInput.files.length > 0) {\n-                const imageUploadFormData = new FormData();\n-                imageUploadFormData.append('image', imageFileInput.files[0]);\n-\n-                try {\n-                    const uploadResponse = await fetch('/upload/image', {\n-                        method: 'POST',\n-                        headers: {\n-                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n-                        },\n-                        body: imageUploadFormData\n-                    });\n-\n-                    if (uploadResponse.ok) {\n-                        const uploadResult = await uploadResponse.json();\n-                        if (uploadResult.success === 1) {\n-                            formData.append('thumbnailImageUrl', uploadResult.imageUrl);\n-                        } else {\n-                            alert('이미지 업로드 실패: ' + uploadResult.message);\n-                            return; // 이미지 업로드 실패 시 전체 제출 중단\n-                        }\n-                    } else {\n-                        const errorText = await uploadResponse.text();\n-                        console.error('이미지 업로드 실패:', errorText);\n-                        alert('이미지 업로드를 실패하였습니다.');\n-                        return; // 이미지 업로드 실패 시 전체 제출 중단\n-                    }\n-                } catch (error) {\n-                    console.error('이미지 업로드 중 오류:', error);\n-                    alert('이미지 업로드 중 오류가 발생했습니다.');\n-                    return; // 이미지 업로드 실패 시 전체 제출 중단\n-                }\n-            }\n-\n-            // 3. 전송\n-            const actionUrl = isNew ? '/hospitals/new' : '/hospitals/edit';\n-\n-            try {\n-                const response = await fetch(actionUrl, {\n-                    method: 'POST',\n-                    headers: {\n-                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n-                        },\n-                    body: formData\n-                });\n-\n-                if (response.ok) {\n-                    const result = await response.json();\n-                    alert('병원 정보가 성공적으로 제출되었습니다!');\n-                    window.location.href = '/hospitals';\n-                } else {\n-                    const errorText = await response.text();\n-                    console.error('제출 실패:', errorText);\n-                    alert('제출에 실패했습니다: ' + errorText);\n-                }\n-            } catch (error) {\n-                console.error('제출 중 오류:', error);\n-                alert('제출 중 오류가 발생했습니다.');\n-            }\n-        });\n-    });\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-  // 잼민이 버전\n-//   document.addEventListener('DOMContentLoaded', function() {\n-//     const submitAllBtn = document.getElementById('submitAllBtn');\n-//     const generalDataForm = document.getElementById('generalDataForm');\n-//     const fileUploadForm = document.getElementById('fileUploadForm'); // fileUploadForm 참조 추가\n-//     const hospitalId = '[[${hospitalForm.hospitalId}]]'; // Thymeleaf 변수 사용\n-\n-//     submitAllBtn.addEventListener('click', async function(event) {\n-//       event.preventDefault(); // 기본 폼 제출 방지\n-\n-//       const formData = new FormData(generalDataForm); // generalDataForm의 데이터로 FormData 초기화\n-//       const fileInput = fileUploadForm.querySelector('#fileInput'); // fileUploadForm에서 fileInput 가져오기\n-//       if (fileInput && fileInput.files && fileInput.files[0]) {\n-//         formData.append('thumbnailImageFile', fileInput.files[0]);\n-//       }\n-\n-//       // 폼 액션 URL 결정\n-//       const actionUrl = hospitalId === 'null' ? '/hospitals/new' : '/hospitals/edit';\n-\n-//       try {\n-//         const response = await fetch(actionUrl, {\n-//                                                     method: 'POST',\n-//                                                     body: formData\n-//                                                 });\n-\n-//         if (response.ok) {\n-//           const result = await response.json(); // 또는 response.text()\n-//           console.log('Submission successful:', result);\n-//           alert('병원 정보가 성공적으로 제출되었습니다!');\n-//           // 성공 후 리다이렉트 또는 다른 작업 수행\n-//           window.location.href = '/hospitals'; // 예시: 병원 목록 페이지로 이동\n-//         } else {\n-//           const errorText = await response.text();\n-//           console.error('Submission failed:', response.status, errorText);\n-//           alert('병원 정보 제출에 실패했습니다: ' + errorText);\n-//         }\n-//       } catch (error) {\n-//         console.error('Error during submission:', error);\n-//         alert('병원 정보 제출 중 오류가 발생했습니다.');\n-//       }\n-//     });\n-//   });\n-</script>\n-\n-\n-    <th:block th:replace=\"~{/fragments/footer :: footer}\"></th:block>\n-    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q\" crossorigin=\"anonymous\"></script>\n-</body>\n-</html>\n-<!DOCTYPE html>\n-<html lang=\"ko\" xmlns:th=\"http://www.thymeleaf.org\" xmlns:sec=\"http://www.thymeleaf.org/thymeleaf-extras-springsecurity5\">\n-<head>\n-    <meta charset=\"UTF-8\">\n-    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n-    <meta name=\"_csrf\" th:content=\"${_csrf.token}\" />\n-    <meta name=\"_csrf_header\" th:content=\"${_csrf.headerName}\" />\n-\n-    <title>병원 등록</title>\n-    <!-- Bootstrap CSS -->\n-    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\">\n-    <!-- Font Awesome CSS -->\n-    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css\">\n-    <link rel=\"stylesheet\" th:href=\"@{/css/hospital_style.css}\">\n-</head>\n-<body>\n-    <th:block th:replace=\"~{/fragments/header :: header}\"></th:block>\n-    <div class=\"hospital-main-container\">\n-        <!-- 상단 로고 -->\n-        <div class=\"logo-container\">\n-            <div class=\"logo\">\n-                <img th:src=\"@{/img/hosp_logo.png}\" alt=\"병원 아이콘\" class=\"logo-icon\">\n-            </div>\n-        </div>\n-\n-        <!-- 메인 컨텐츠 -->\n-        <div class=\"main-content\">\n-                        <!-- Hidden form for multipart file upload  잼민이버전-->\n-            <!-- <form id=\"fileUploadForm\" style=\"display: none;\" enctype=\"multipart/form-data\">\n-                <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" onchange=\"previewImage(event)\">\n-            </form> -->\n-\n-            <!-- 채찍피티 버전 -->\n-            <div class=\"d-flex justify-content-around align-items-start gap-20\">\n-\n-                <form id=\"imageForm\" enctype=\"multipart/form-data\">\n-                    <div class=\"image-upload-section\">\n-                        <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n-                            <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n-                        </div>\n-                        <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" style=\"display: none;\" onchange=\"previewImage(event)\">\n-                    </div>\n-                </form>\n-\n-\n-                <!-- Main form for general data -->\n-                <form id=\"generalDataForm\" th:object=\"${hospitalForm}\">\n-                    <input type=\"hidden\" id=\"hospitalId\" th:field=\"*{hospitalId}\" />\n-                    <!-- <input type=\"hidden\" id=\"csrfTokenGeneral\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" /> -->\n-\n-                    <div class=\"form-container\">\n-                        <!-- <div class=\"image-upload-section\">\n-                            <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n-                                <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n-                            </div>\n-                        </div> -->\n-\n-                        <div class=\"form-section\">\n-                            <div class=\"form-group\">\n-                                <label for=\"name\">병원 이름</label>\n-                                <input type=\"text\" id=\"name\" th:field=\"*{name}\" placeholder=\"병원 이름을 작성하세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"address\">병원 주소</label>\n-                                <input type=\"text\" id=\"address\" th:field=\"*{address}\" placeholder=\"주소를 입력해 주세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"homepage\">홈페이지</label>\n-                                <input type=\"url\" id=\"homepage\" th:field=\"*{homepage}\" placeholder=\"홈페이지 주소를 입력해 주세요\">\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"phone\">대표번호</label>\n-                                <input type=\"tel\" id=\"phone\" th:field=\"*{phone}\" placeholder=\"병원 전화번호를 입력하세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"email\">이메일</label>\n-                                <input type=\"email\" id=\"email\" th:field=\"*{email}\" placeholder=\"이메일 주소를 입력하세요\">\n-                            </div>\n-                            <div class=\"form-group\">\n-                                <label for=\"hosp-introduce\">병원 소개</label>\n-                                <textarea type=\"text\" id=\"hosp-introduce\" th:field=\"*{email}\" placeholder=\"간단한 소개글을 작성해 주세요\" required rows=\"4\" style=\"resize: none;\"></textarea>\n-                            </div>\n-                        </div>\n-                    </div>\n-                </form>\n-                <form id=\"checkboxForm\" th:object=\"${hospitalForm}\">\n-                    <div class=\"form-group\">\n-                        <label>진료 과목</label>\n-                        <div class=\"checkbox-group\">\n-                            <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n-                                <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\n-                                <label th:for=\"'spec-' + ${spec.specialtyId}\" th:text=\"${spec.category}\"></label>\n-                            </div>\n-                            <input type=\"text\" id=\"specialty\" placeholder=\"진료 과목을 입력하세요\" required>\n-                        </div>\n-                    </div>\n-                    <div class=\"form-group\">\n-                        <label>진료 가능 동물</label>\n-                        <div class=\"category-group\">\n-                            <label th:each=\"animal : ${animalList}\" class=\"category-item\">\n-                                <input type=\"checkbox\" name=\"category\" th:field=\"*{animalIds}\" th:value=\"${animal.animalId}\" th:id=\"'animal-' + ${animal.animalId}\">\n-                                <span th:for=\"'animal-' + ${animal.animalId}\" th:text=\"${animal.species}\"></span>\n-                            </label>\n-                        </div>\n-                    </div>\n-                        </div>\n-                </form>\n-                        </div>\n-                    </div>\n-                </form>\n-            </div>\n-\n-            <!-- 삭제 form -->\n-            <div sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">\n-                <form id=\"deleteForm\" th:action=\"@{/hospitals/delete/{id}(id=${hospitalForm.hospitalId})}\" method=\"post\" style=\"display: none;\">\n-                    <input type=\"hidden\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" />\n-                </form>\n-            </div>\n-\n-            <div class=\"d-flex justify-content-center gap-2 mt-4\">\n-                <button type=\"button\" class=\"btn btn-secondary\" onclick=\"history.back()\">취소</button>\n-                <button type=\"button\" id=\"submitAllBtn\" class=\"btn btn-primary\" th:text=\"${hospitalForm.hospitalId != null ? '수정' : '등록'}\"></button>\n-                <button type=\"button\" id=\"deleteBtn\" class=\"btn btn-danger\" sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">삭제</button>\n-            </div>\n-        </div>\n-\n-\n-<script>\n-  function previewImage(event) {\n-    const input = event.target;\n-    const reader = new FileReader();\n-\n-    reader.onload = function () {\n-      const preview = document.getElementById('preview');\n-      preview.src = reader.result;\n-    };\n-\n-    if (input.files && input.files[0]) {\n-      reader.readAsDataURL(input.files[0]);\n-    }\n-  }\n-\n-\n-  // 채찍피티 버전\n-    document.addEventListener('DOMContentLoaded', function () {\n-        const submitAllBtn = document.getElementById('submitAllBtn');\n-        const imageForm = document.getElementById('imageForm');\n-        const generalDataForm = document.getElementById('generalDataForm');\n-        // const hospitalId = '[[${hospitalForm.hospitalId}]]';\n-        const hospitalId = document.getElementById('hospitalId')?.value;\n-        const isNew = !hospitalId || hospitalId === 'null' || hospitalId === '';\n-\n-        const csrfToken = document.querySelector('meta[name=\"_csrf\"]').content;\n-        const csrfHeader = document.querySelector('meta[name=\"_csrf_header\"]').content;\n-\n-        const deleteBtn = document.getElementById('deleteBtn');\n-        if (deleteBtn) {\n-            deleteBtn.addEventListener('click', function() {\n-                if (confirm('정말로 이 병원을 삭제하시겠습니까?')) {\n-                    document.getElementById('deleteForm').submit();\n-                }\n-            });\n-        }\n-\n-        submitAllBtn.addEventListener('click', async function (event) {\n-            event.preventDefault();\n-\n-            const formData = new FormData();\n-\n-            // 1. 일반 입력값 병합\n-            const generalFormData = new FormData(generalDataForm);\n-            for (const [key, value] of generalFormData.entries()) {\n-                formData.append(key, value);\n-            }\n-\n-            // 2. 이미지 파일 업로드 및 URL 병합\n-            const imageFileInput = imageForm.querySelector('#fileInput');\n-            if (imageFileInput && imageFileInput.files.length > 0) {\n-                const imageUploadFormData = new FormData();\n-                imageUploadFormData.append('image', imageFileInput.files[0]);\n-\n-                try {\n-                    const uploadResponse = await fetch('/upload/image', {\n-                        method: 'POST',\n-                        headers: {\n-                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n-                        },\n-                        body: imageUploadFormData\n-                    });\n-\n-                    if (uploadResponse.ok) {\n-                        const uploadResult = await uploadResponse.json();\n-                        if (uploadResult.success === 1) {\n-                            formData.append('thumbnailImageUrl', uploadResult.imageUrl);\n-                        } else {\n-                            alert('이미지 업로드 실패: ' + uploadResult.message);\n-                            return; // 이미지 업로드 실패 시 전체 제출 중단\n-                        }\n-                    } else {\n-                        const errorText = await uploadResponse.text();\n-                        console.error('이미지 업로드 실패:', errorText);\n-                        alert('이미지 업로드를 실패하였습니다.');\n-                        return; // 이미지 업로드 실패 시 전체 제출 중단\n-                    }\n-                } catch (error) {\n-                    console.error('이미지 업로드 중 오류:', error);\n-                    alert('이미지 업로드 중 오류가 발생했습니다.');\n-                    return; // 이미지 업로드 실패 시 전체 제출 중단\n-                }\n-            }\n-\n-            // 3. 전송\n-            const actionUrl = isNew ? '/hospitals/new' : '/hospitals/edit';\n-\n-            try {\n-                const response = await fetch(actionUrl, {\n-                    method: 'POST',\n-                    headers: {\n-                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n-                        },\n-                    body: formData\n-                });\n-\n-                if (response.ok) {\n-                    const result = await response.json();\n-                    alert('병원 정보가 성공적으로 제출되었습니다!');\n-                    window.location.href = '/hospitals';\n-                } else {\n-                    const errorText = await response.text();\n-                    console.error('제출 실패:', errorText);\n-                    alert('제출에 실패했습니다: ' + errorText);\n-                }\n-            } catch (error) {\n-                console.error('제출 중 오류:', error);\n-                alert('제출 중 오류가 발생했습니다.');\n-            }\n-        });\n-    });\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-  // 잼민이 버전\n-//   document.addEventListener('DOMContentLoaded', function() {\n-//     const submitAllBtn = document.getElementById('submitAllBtn');\n-//     const generalDataForm = document.getElementById('generalDataForm');\n-//     const fileUploadForm = document.getElementById('fileUploadForm'); // fileUploadForm 참조 추가\n-//     const hospitalId = '[[${hospitalForm.hospitalId}]]'; // Thymeleaf 변수 사용\n-\n-//     submitAllBtn.addEventListener('click', async function(event) {\n-//       event.preventDefault(); // 기본 폼 제출 방지\n-\n-//       const formData = new FormData(generalDataForm); // generalDataForm의 데이터로 FormData 초기화\n-//       const fileInput = fileUploadForm.querySelector('#fileInput'); // fileUploadForm에서 fileInput 가져오기\n-//       if (fileInput && fileInput.files && fileInput.files[0]) {\n-//         formData.append('thumbnailImageFile', fileInput.files[0]);\n-//       }\n-\n-//       // 폼 액션 URL 결정\n-//       const actionUrl = hospitalId === 'null' ? '/hospitals/new' : '/hospitals/edit';\n-\n-//       try {\n-//         const response = await fetch(actionUrl, {\n-//                                                     method: 'POST',\n-//                                                     body: formData\n-//                                                 });\n-\n-//         if (response.ok) {\n-//           const result = await response.json(); // 또는 response.text()\n-//           console.log('Submission successful:', result);\n-//           alert('병원 정보가 성공적으로 제출되었습니다!');\n-//           // 성공 후 리다이렉트 또는 다른 작업 수행\n-//           window.location.href = '/hospitals'; // 예시: 병원 목록 페이지로 이동\n-//         } else {\n-//           const errorText = await response.text();\n-//           console.error('Submission failed:', response.status, errorText);\n-//           alert('병원 정보 제출에 실패했습니다: ' + errorText);\n-//         }\n-//       } catch (error) {\n-//         console.error('Error during submission:', error);\n-//         alert('병원 정보 제출 중 오류가 발생했습니다.');\n-//       }\n-//     });\n-//   });\n-</script>\n-\n-\n-    <th:block th:replace=\"~{/fragments/footer :: footer}\"></th:block>\n-    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q\" crossorigin=\"anonymous\"></script>\n-</body>\n-</html>\n-<!DOCTYPE html>\n-<html lang=\"ko\" xmlns:th=\"http://www.thymeleaf.org\" xmlns:sec=\"http://www.thymeleaf.org/thymeleaf-extras-springsecurity5\">\n-<head>\n-    <meta charset=\"UTF-8\">\n-    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n-    <meta name=\"_csrf\" th:content=\"${_csrf.token}\" />\n-    <meta name=\"_csrf_header\" th:content=\"${_csrf.headerName}\" />\n-\n-    <title>병원 등록</title>\n-    <!-- Bootstrap CSS -->\n-    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\">\n-    <!-- Font Awesome CSS -->\n-    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css\">\n-    <link rel=\"stylesheet\" th:href=\"@{/css/hospital_style.css}\">\n-</head>\n-<body>\n-    <th:block th:replace=\"~{/fragments/header :: header}\"></th:block>\n-    <div class=\"hospital-main-container\">\n-        <!-- 상단 로고 -->\n-        <div class=\"logo-container\">\n-            <div class=\"logo\">\n-                <img th:src=\"@{/img/hosp_logo.png}\" alt=\"병원 아이콘\" class=\"logo-icon\">\n-            </div>\n-        </div>\n-\n-        <!-- 메인 컨텐츠 -->\n-        <div class=\"main-content\">\n-                        <!-- Hidden form for multipart file upload  잼민이버전-->\n-            <!-- <form id=\"fileUploadForm\" style=\"display: none;\" enctype=\"multipart/form-data\">\n-                <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" onchange=\"previewImage(event)\">\n-            </form> -->\n-\n-            <!-- 채찍피티 버전 -->\n-            <div class=\"d-flex justify-content-around align-items-start gap-20\">\n-\n-                <form id=\"imageForm\" enctype=\"multipart/form-data\">\n-                    <div class=\"image-upload-section\">\n-                        <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n-                            <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n-                        </div>\n-                        <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" style=\"display: none;\" onchange=\"previewImage(event)\">\n-                    </div>\n-                </form>\n-\n-\n-                <!-- Main form for general data -->\n-                <form id=\"generalDataForm\" th:object=\"${hospitalForm}\">\n-                    <input type=\"hidden\" id=\"hospitalId\" th:field=\"*{hospitalId}\" />\n-                    <!-- <input type=\"hidden\" id=\"csrfTokenGeneral\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" /> -->\n-\n-                    <div class=\"form-container\">\n-                        <!-- <div class=\"image-upload-section\">\n-                            <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n-                                <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n-                            </div>\n-                        </div> -->\n-\n-                        <div class=\"form-section\">\n-                            <div class=\"form-group\">\n-                                <label for=\"name\">병원 이름</label>\n-                                <input type=\"text\" id=\"name\" th:field=\"*{name}\" placeholder=\"병원 이름을 작성하세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"address\">병원 주소</label>\n-                                <input type=\"text\" id=\"address\" th:field=\"*{address}\" placeholder=\"주소를 입력해 주세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"homepage\">홈페이지</label>\n-                                <input type=\"url\" id=\"homepage\" th:field=\"*{homepage}\" placeholder=\"홈페이지 주소를 입력해 주세요\">\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"phone\">대표번호</label>\n-                                <input type=\"tel\" id=\"phone\" th:field=\"*{phone}\" placeholder=\"병원 전화번호를 입력하세요\" required>\n-                            </div>\n-\n-                            <!-- <div class=\"form-group\">\n-                                <label for=\"email\">이메일</label>\n-                                <input type=\"email\" id=\"email\" th:field=\"*{email}\" placeholder=\"이메일 주소를 입력하세요\">\n-                            </div> -->\n-                            <div class=\"form-group\">\n-                                <label for=\"hosp-introduce\">병원 소개</label>\n-                                <textarea type=\"text\" id=\"hosp-introduce\" th:field=\"*{email}\" placeholder=\"간단한 소개글을 작성해 주세요\" required rows=\"4\" style=\"resize: none;\"></textarea>\n-                            </div>\n-                        </div>\n-                    </div>\n-                </form>\n-                <form id=\"checkboxForm\" th:object=\"${hospitalForm}\">\n-                    <div class=\"form-group\">\n-                        <label>진료 과목</label>\n-                        <div class=\"checkbox-group\">\n-                            <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n-                                <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\n-                                <label th:for=\"'spec-' + ${spec.specialtyId}\" th:text=\"${spec.category}\"></label>\n-                            </div>\n-                            <input type=\"text\" id=\"specialty\" placeholder=\"진료 과목을 입력하세요\" required>\n-                        </div>\n-                    </div>\n-                    <div class=\"form-group\">\n-                        <label>진료 가능 동물</label>\n-                        <div class=\"category-group\">\n-                            <label th:each=\"animal : ${animalList}\" class=\"category-item\">\n-                                <input type=\"checkbox\" name=\"category\" th:field=\"*{animalIds}\" th:value=\"${animal.animalId}\" th:id=\"'animal-' + ${animal.animalId}\">\n-                                <span th:for=\"'animal-' + ${animal.animalId}\" th:text=\"${animal.species}\"></span>\n-                            </label>\n-                        </div>\n-                    </div>\n-                    <div class=\"form-group\">\n-                        <label>카테고리</label>\n-                        <div class=\"category-group\">\n-                            <label class=\"category-item\">\n-                                <input type=\"checkbox\" name=\"category\" value=\"포유류\">\n-                                <span>포유류</span>\n-                            </label>\n-                            <label class=\"category-item\">\n-                                <input type=\"checkbox\" name=\"category\" value=\"파충류\">\n-                                <span>파충류</span>\n-                            </label>\n-                            <label class=\"category-item\">\n-                                <input type=\"checkbox\" name=\"category\" value=\"조류\">\n-                                <span>조류</span>\n-                            </label>\n-                            <label class=\"category-item\">\n-                                <input type=\"checkbox\" name=\"category\" value=\"절지류\">\n-                                <span>절지류</span>\n-                            </label>\n-                            <label class=\"category-item\">\n-                                <input type=\"checkbox\" name=\"category\" value=\"설치류\">\n-                                <span>설치류</span>\n-                            </label>\n-                        </div>\n-                    </div>\n-                        </div>\n-                </form>\n-                        </div>\n-                    </div>\n-                </form>\n-            </div>\n-\n-            <!-- 삭제 form -->\n-            <div sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">\n-                <form id=\"deleteForm\" th:action=\"@{/hospitals/delete/{id}(id=${hospitalForm.hospitalId})}\" method=\"post\" style=\"display: none;\">\n-                    <input type=\"hidden\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" />\n-                </form>\n-            </div>\n-\n-            <div class=\"d-flex justify-content-center gap-2 mt-4\">\n-                <button type=\"button\" class=\"btn btn-secondary\" onclick=\"history.back()\">취소</button>\n-                <button type=\"button\" id=\"submitAllBtn\" class=\"btn btn-primary\" th:text=\"${hospitalForm.hospitalId != null ? '수정' : '등록'}\"></button>\n-                <button type=\"button\" id=\"deleteBtn\" class=\"btn btn-danger\" sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">삭제</button>\n-            </div>\n-        </div>\n-\n-\n-<script>\n-  function previewImage(event) {\n-    const input = event.target;\n-    const reader = new FileReader();\n-\n-    reader.onload = function () {\n-      const preview = document.getElementById('preview');\n-      preview.src = reader.result;\n-    };\n-\n-    if (input.files && input.files[0]) {\n-      reader.readAsDataURL(input.files[0]);\n-    }\n-  }\n-\n-\n-  // 채찍피티 버전\n-    document.addEventListener('DOMContentLoaded', function () {\n-        const submitAllBtn = document.getElementById('submitAllBtn');\n-        const imageForm = document.getElementById('imageForm');\n-        const generalDataForm = document.getElementById('generalDataForm');\n-        // const hospitalId = '[[${hospitalForm.hospitalId}]]';\n-        const hospitalId = document.getElementById('hospitalId')?.value;\n-        const isNew = !hospitalId || hospitalId === 'null' || hospitalId === '';\n-\n-        const csrfToken = document.querySelector('meta[name=\"_csrf\"]').content;\n-        const csrfHeader = document.querySelector('meta[name=\"_csrf_header\"]').content;\n-\n-        const deleteBtn = document.getElementById('deleteBtn');\n-        if (deleteBtn) {\n-            deleteBtn.addEventListener('click', function() {\n-                if (confirm('정말로 이 병원을 삭제하시겠습니까?')) {\n-                    document.getElementById('deleteForm').submit();\n-                }\n-            });\n-        }\n-\n-        submitAllBtn.addEventListener('click', async function (event) {\n-            event.preventDefault();\n-\n-            const formData = new FormData();\n-\n-            // 1. 일반 입력값 병합\n-            const generalFormData = new FormData(generalDataForm);\n-            for (const [key, value] of generalFormData.entries()) {\n-                formData.append(key, value);\n-            }\n-\n-            // 2. 이미지 파일 업로드 및 URL 병합\n-            const imageFileInput = imageForm.querySelector('#fileInput');\n-            if (imageFileInput && imageFileInput.files.length > 0) {\n-                const imageUploadFormData = new FormData();\n-                imageUploadFormData.append('image', imageFileInput.files[0]);\n-\n-                try {\n-                    const uploadResponse = await fetch('/upload/image', {\n-                        method: 'POST',\n-                        headers: {\n-                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n-                        },\n-                        body: imageUploadFormData\n-                    });\n-\n-                    if (uploadResponse.ok) {\n-                        const uploadResult = await uploadResponse.json();\n-                        if (uploadResult.success === 1) {\n-                            formData.append('thumbnailImageUrl', uploadResult.imageUrl);\n-                        } else {\n-                            alert('이미지 업로드 실패: ' + uploadResult.message);\n-                            return; // 이미지 업로드 실패 시 전체 제출 중단\n-                        }\n-                    } else {\n-                        const errorText = await uploadResponse.text();\n-                        console.error('이미지 업로드 실패:', errorText);\n-                        alert('이미지 업로드를 실패하였습니다.');\n-                        return; // 이미지 업로드 실패 시 전체 제출 중단\n-                    }\n-                } catch (error) {\n-                    console.error('이미지 업로드 중 오류:', error);\n-                    alert('이미지 업로드 중 오류가 발생했습니다.');\n-                    return; // 이미지 업로드 실패 시 전체 제출 중단\n-                }\n-            }\n-\n-            // 3. 전송\n-            const actionUrl = isNew ? '/hospitals/new' : '/hospitals/edit';\n-\n-            try {\n-                const response = await fetch(actionUrl, {\n-                    method: 'POST',\n-                    headers: {\n-                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n-                        },\n-                    body: formData\n-                });\n-\n-                if (response.ok) {\n-                    const result = await response.json();\n-                    alert('병원 정보가 성공적으로 제출되었습니다!');\n-                    window.location.href = '/hospitals';\n-                } else {\n-                    const errorText = await response.text();\n-                    console.error('제출 실패:', errorText);\n-                    alert('제출에 실패했습니다: ' + errorText);\n-                }\n-            } catch (error) {\n-                console.error('제출 중 오류:', error);\n-                alert('제출 중 오류가 발생했습니다.');\n-            }\n-        });\n-    });\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-  // 잼민이 버전\n-//   document.addEventListener('DOMContentLoaded', function() {\n-//     const submitAllBtn = document.getElementById('submitAllBtn');\n-//     const generalDataForm = document.getElementById('generalDataForm');\n-//     const fileUploadForm = document.getElementById('fileUploadForm'); // fileUploadForm 참조 추가\n-//     const hospitalId = '[[${hospitalForm.hospitalId}]]'; // Thymeleaf 변수 사용\n-\n-//     submitAllBtn.addEventListener('click', async function(event) {\n-//       event.preventDefault(); // 기본 폼 제출 방지\n-\n-//       const formData = new FormData(generalDataForm); // generalDataForm의 데이터로 FormData 초기화\n-//       const fileInput = fileUploadForm.querySelector('#fileInput'); // fileUploadForm에서 fileInput 가져오기\n-//       if (fileInput && fileInput.files && fileInput.files[0]) {\n-//         formData.append('thumbnailImageFile', fileInput.files[0]);\n-//       }\n-\n-//       // 폼 액션 URL 결정\n-//       const actionUrl = hospitalId === 'null' ? '/hospitals/new' : '/hospitals/edit';\n-\n-//       try {\n-//         const response = await fetch(actionUrl, {\n-//                                                     method: 'POST',\n-//                                                     body: formData\n-//                                                 });\n-\n-//         if (response.ok) {\n-//           const result = await response.json(); // 또는 response.text()\n-//           console.log('Submission successful:', result);\n-//           alert('병원 정보가 성공적으로 제출되었습니다!');\n-//           // 성공 후 리다이렉트 또는 다른 작업 수행\n-//           window.location.href = '/hospitals'; // 예시: 병원 목록 페이지로 이동\n-//         } else {\n-//           const errorText = await response.text();\n-//           console.error('Submission failed:', response.status, errorText);\n-//           alert('병원 정보 제출에 실패했습니다: ' + errorText);\n-//         }\n-//       } catch (error) {\n-//         console.error('Error during submission:', error);\n-//         alert('병원 정보 제출 중 오류가 발생했습니다.');\n-//       }\n-//     });\n-//   });\n-</script>\n-\n-\n-    <th:block th:replace=\"~{/fragments/footer :: footer}\"></th:block>\n-    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q\" crossorigin=\"anonymous\"></script>\n-</body>\n-</html>\n-<!DOCTYPE html>\n-<html lang=\"ko\" xmlns:th=\"http://www.thymeleaf.org\" xmlns:sec=\"http://www.thymeleaf.org/thymeleaf-extras-springsecurity5\">\n-<head>\n-    <meta charset=\"UTF-8\">\n-    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n-    <meta name=\"_csrf\" th:content=\"${_csrf.token}\" />\n-    <meta name=\"_csrf_header\" th:content=\"${_csrf.headerName}\" />\n-\n-    <title>병원 등록</title>\n-    <!-- Bootstrap CSS -->\n-    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\">\n-    <!-- Font Awesome CSS -->\n-    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css\">\n-    <link rel=\"stylesheet\" th:href=\"@{/css/hospital_style.css}\">\n-</head>\n-<body>\n-    <th:block th:replace=\"~{/fragments/header :: header}\"></th:block>\n-    <div class=\"hospital-main-container\">\n-        <!-- 상단 로고 -->\n-        <div class=\"logo-container\">\n-            <div class=\"logo\">\n-                <img th:src=\"@{/img/hosp_logo.png}\" alt=\"병원 아이콘\" class=\"logo-icon\">\n-            </div>\n-        </div>\n-\n-        <!-- 메인 컨텐츠 -->\n-        <div class=\"main-content\">\n-                        <!-- Hidden form for multipart file upload  잼민이버전-->\n-            <!-- <form id=\"fileUploadForm\" style=\"display: none;\" enctype=\"multipart/form-data\">\n-                <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" onchange=\"previewImage(event)\">\n-            </form> -->\n-\n-            <!-- 채찍피티 버전 -->\n-            <div class=\"d-flex justify-content-around align-items-start gap-20\">\n-\n-                <form id=\"imageForm\" enctype=\"multipart/form-data\">\n-                    <div class=\"image-upload-section\">\n-                        <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n-                            <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n-                        </div>\n-                        <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" style=\"display: none;\" onchange=\"previewImage(event)\">\n-                    </div>\n-                </form>\n-\n-\n-                <!-- Main form for general data -->\n-                <form id=\"generalDataForm\" th:object=\"${hospitalForm}\">\n-                    <input type=\"hidden\" id=\"hospitalId\" th:field=\"*{hospitalId}\" />\n-                    <!-- <input type=\"hidden\" id=\"csrfTokenGeneral\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" /> -->\n-\n-                    <div class=\"form-container\">\n-                        <!-- <div class=\"image-upload-section\">\n-                            <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n-                                <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n-                            </div>\n-                        </div> -->\n-\n-                        <div class=\"form-section\">\n-                            <div class=\"form-group\">\n-                                <label for=\"name\">병원 이름</label>\n-                                <input type=\"text\" id=\"name\" th:field=\"*{name}\" placeholder=\"병원 이름을 작성하세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"address\">병원 주소</label>\n-                                <input type=\"text\" id=\"address\" th:field=\"*{address}\" placeholder=\"주소를 입력해 주세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"homepage\">홈페이지</label>\n-                                <input type=\"url\" id=\"homepage\" th:field=\"*{homepage}\" placeholder=\"홈페이지 주소를 입력해 주세요\">\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"phone\">대표번호</label>\n-                                <input type=\"tel\" id=\"phone\" th:field=\"*{phone}\" placeholder=\"병원 전화번호를 입력하세요\" required>\n-                            </div>\n-\n-                            <!-- <div class=\"form-group\">\n-                                <label for=\"email\">이메일</label>\n-                                <input type=\"email\" id=\"email\" th:field=\"*{email}\" placeholder=\"이메일 주소를 입력하세요\">\n-                            </div> -->\n-                            <div class=\"form-group\">\n-                                <label for=\"hosp-introduce\">병원 소개</label>\n-                                <textarea type=\"text\" id=\"hosp-introduce\" th:field=\"*{email}\" placeholder=\"간단한 소개글을 작성해 주세요\" required rows=\"4\" style=\"resize: none;\"></textarea>\n-                            </div>\n-                        </div>\n-                    </div>\n-                </form>\n-                <form id=\"checkboxForm\" th:object=\"${hospitalForm}\">\n-                    <div class=\"form-group\">\n-                        <label>진료 과목</label>\n-                        <div class=\"checkbox-group\">\n-                            <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n-                                <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\n-                                <label th:for=\"'spec-' + ${spec.specialtyId}\" th:text=\"${spec.category}\"></label>\n-                            </div>\n-                            <input type=\"text\" id=\"specialty\" placeholder=\"진료 과목을 입력하세요\" required>\n-                        </div>\n-                    </div>\n-                    <div>\n-                        <label>진료 가능 동물</label>\n-                        <div class=\"checkbox-group\">\n-                            <label th:each=\"animal : ${animalList}\" class=\"category-item\">\n-                                <input type=\"checkbox\" name=\"category\" th:field=\"*{animalIds}\" th:value=\"${animal.animalId}\" th:id=\"'animal-' + ${animal.animalId}\">\n-                                <span th:for=\"'animal-' + ${animal.animalId}\" th:text=\"${animal.species}\"></span>\n-                            </label>\n-                        </div>\n-                    </div>\n-                    <div class=\"form-group\">\n-                        <label>카테고리</label>\n-                        <div class=\"category-group\">\n-                            <label class=\"category-item\">\n-                                <input type=\"checkbox\" name=\"category\" value=\"포유류\">\n-                                <span>포유류</span>\n-                            </label>\n-                            <label class=\"category-item\">\n-                                <input type=\"checkbox\" name=\"category\" value=\"파충류\">\n-                                <span>파충류</span>\n-                            </label>\n-                            <label class=\"category-item\">\n-                                <input type=\"checkbox\" name=\"category\" value=\"조류\">\n-                                <span>조류</span>\n-                            </label>\n-                            <label class=\"category-item\">\n-                                <input type=\"checkbox\" name=\"category\" value=\"절지류\">\n-                                <span>절지류</span>\n-                            </label>\n-                            <label class=\"category-item\">\n-                                <input type=\"checkbox\" name=\"category\" value=\"설치류\">\n-                                <span>설치류</span>\n-                            </label>\n-                        </div>\n-                    </div>\n-                        </div>\n-                </form>\n-                        </div>\n-                    </div>\n-                </form>\n-            </div>\n-\n-            <!-- 삭제 form -->\n-            <div sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">\n-                <form id=\"deleteForm\" th:action=\"@{/hospitals/delete/{id}(id=${hospitalForm.hospitalId})}\" method=\"post\" style=\"display: none;\">\n-                    <input type=\"hidden\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" />\n-                </form>\n-            </div>\n-\n-            <div class=\"d-flex justify-content-center gap-2 mt-4\">\n-                <button type=\"button\" class=\"btn btn-secondary\" onclick=\"history.back()\">취소</button>\n-                <button type=\"button\" id=\"submitAllBtn\" class=\"btn btn-primary\" th:text=\"${hospitalForm.hospitalId != null ? '수정' : '등록'}\"></button>\n-                <button type=\"button\" id=\"deleteBtn\" class=\"btn btn-danger\" sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">삭제</button>\n-            </div>\n-        </div>\n-\n-\n-<script>\n-  function previewImage(event) {\n-    const input = event.target;\n-    const reader = new FileReader();\n-\n-    reader.onload = function () {\n-      const preview = document.getElementById('preview');\n-      preview.src = reader.result;\n-    };\n-\n-    if (input.files && input.files[0]) {\n-      reader.readAsDataURL(input.files[0]);\n-    }\n-  }\n-\n-\n-  // 채찍피티 버전\n-    document.addEventListener('DOMContentLoaded', function () {\n-        const submitAllBtn = document.getElementById('submitAllBtn');\n-        const imageForm = document.getElementById('imageForm');\n-        const generalDataForm = document.getElementById('generalDataForm');\n-        // const hospitalId = '[[${hospitalForm.hospitalId}]]';\n-        const hospitalId = document.getElementById('hospitalId')?.value;\n-        const isNew = !hospitalId || hospitalId === 'null' || hospitalId === '';\n-\n-        const csrfToken = document.querySelector('meta[name=\"_csrf\"]').content;\n-        const csrfHeader = document.querySelector('meta[name=\"_csrf_header\"]').content;\n-\n-        const deleteBtn = document.getElementById('deleteBtn');\n-        if (deleteBtn) {\n-            deleteBtn.addEventListener('click', function() {\n-                if (confirm('정말로 이 병원을 삭제하시겠습니까?')) {\n-                    document.getElementById('deleteForm').submit();\n-                }\n-            });\n-        }\n-\n-        submitAllBtn.addEventListener('click', async function (event) {\n-            event.preventDefault();\n-\n-            const formData = new FormData();\n-\n-            // 1. 일반 입력값 병합\n-            const generalFormData = new FormData(generalDataForm);\n-            for (const [key, value] of generalFormData.entries()) {\n-                formData.append(key, value);\n-            }\n-\n-            // 2. 이미지 파일 업로드 및 URL 병합\n-            const imageFileInput = imageForm.querySelector('#fileInput');\n-            if (imageFileInput && imageFileInput.files.length > 0) {\n-                const imageUploadFormData = new FormData();\n-                imageUploadFormData.append('image', imageFileInput.files[0]);\n-\n-                try {\n-                    const uploadResponse = await fetch('/upload/image', {\n-                        method: 'POST',\n-                        headers: {\n-                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n-                        },\n-                        body: imageUploadFormData\n-                    });\n-\n-                    if (uploadResponse.ok) {\n-                        const uploadResult = await uploadResponse.json();\n-                        if (uploadResult.success === 1) {\n-                            formData.append('thumbnailImageUrl', uploadResult.imageUrl);\n-                        } else {\n-                            alert('이미지 업로드 실패: ' + uploadResult.message);\n-                            return; // 이미지 업로드 실패 시 전체 제출 중단\n-                        }\n-                    } else {\n-                        const errorText = await uploadResponse.text();\n-                        console.error('이미지 업로드 실패:', errorText);\n-                        alert('이미지 업로드를 실패하였습니다.');\n-                        return; // 이미지 업로드 실패 시 전체 제출 중단\n-                    }\n-                } catch (error) {\n-                    console.error('이미지 업로드 중 오류:', error);\n-                    alert('이미지 업로드 중 오류가 발생했습니다.');\n-                    return; // 이미지 업로드 실패 시 전체 제출 중단\n-                }\n-            }\n-\n-            // 3. 전송\n-            const actionUrl = isNew ? '/hospitals/new' : '/hospitals/edit';\n-\n-            try {\n-                const response = await fetch(actionUrl, {\n-                    method: 'POST',\n-                    headers: {\n-                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n-                        },\n-                    body: formData\n-                });\n-\n-                if (response.ok) {\n-                    const result = await response.json();\n-                    alert('병원 정보가 성공적으로 제출되었습니다!');\n-                    window.location.href = '/hospitals';\n-                } else {\n-                    const errorText = await response.text();\n-                    console.error('제출 실패:', errorText);\n-                    alert('제출에 실패했습니다: ' + errorText);\n-                }\n-            } catch (error) {\n-                console.error('제출 중 오류:', error);\n-                alert('제출 중 오류가 발생했습니다.');\n-            }\n-        });\n-    });\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-  // 잼민이 버전\n-//   document.addEventListener('DOMContentLoaded', function() {\n-//     const submitAllBtn = document.getElementById('submitAllBtn');\n-//     const generalDataForm = document.getElementById('generalDataForm');\n-//     const fileUploadForm = document.getElementById('fileUploadForm'); // fileUploadForm 참조 추가\n-//     const hospitalId = '[[${hospitalForm.hospitalId}]]'; // Thymeleaf 변수 사용\n-\n-//     submitAllBtn.addEventListener('click', async function(event) {\n-//       event.preventDefault(); // 기본 폼 제출 방지\n-\n-//       const formData = new FormData(generalDataForm); // generalDataForm의 데이터로 FormData 초기화\n-//       const fileInput = fileUploadForm.querySelector('#fileInput'); // fileUploadForm에서 fileInput 가져오기\n-//       if (fileInput && fileInput.files && fileInput.files[0]) {\n-//         formData.append('thumbnailImageFile', fileInput.files[0]);\n-//       }\n-\n-//       // 폼 액션 URL 결정\n-//       const actionUrl = hospitalId === 'null' ? '/hospitals/new' : '/hospitals/edit';\n-\n-//       try {\n-//         const response = await fetch(actionUrl, {\n-//                                                     method: 'POST',\n-//                                                     body: formData\n-//                                                 });\n-\n-//         if (response.ok) {\n-//           const result = await response.json(); // 또는 response.text()\n-//           console.log('Submission successful:', result);\n-//           alert('병원 정보가 성공적으로 제출되었습니다!');\n-//           // 성공 후 리다이렉트 또는 다른 작업 수행\n-//           window.location.href = '/hospitals'; // 예시: 병원 목록 페이지로 이동\n-//         } else {\n-//           const errorText = await response.text();\n-//           console.error('Submission failed:', response.status, errorText);\n-//           alert('병원 정보 제출에 실패했습니다: ' + errorText);\n-//         }\n-//       } catch (error) {\n-//         console.error('Error during submission:', error);\n-//         alert('병원 정보 제출 중 오류가 발생했습니다.');\n-//       }\n-//     });\n-//   });\n-</script>\n-\n-\n-    <th:block th:replace=\"~{/fragments/footer :: footer}\"></th:block>\n-    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q\" crossorigin=\"anonymous\"></script>\n-</body>\n </html>\n\\ No newline at end of file\n"
                },
                {
                    "date": 1751989789909,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -23,9 +23,9 @@\n             </div>\n         </div>\n \n         <!-- 메인 컨텐츠 -->\n-        <div class=\"main-content\">\n+        <div class=\"main-content d-flex flex-column align-items-center\">\n                         <!-- Hidden form for multipart file upload  잼민이버전-->\n             <!-- <form id=\"fileUploadForm\" style=\"display: none;\" enctype=\"multipart/form-data\">\n                 <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" onchange=\"previewImage(event)\">\n             </form> -->\n"
                },
                {
                    "date": 1751989831980,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,301 @@\n+<!DOCTYPE html>\n+<html lang=\"ko\" xmlns:th=\"http://www.thymeleaf.org\" xmlns:sec=\"http://www.thymeleaf.org/thymeleaf-extras-springsecurity5\">\n+<head>\n+    <meta charset=\"UTF-8\">\n+    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n+    <meta name=\"_csrf\" th:content=\"${_csrf.token}\" />\n+    <meta name=\"_csrf_header\" th:content=\"${_csrf.headerName}\" />\n+\n+    <title>병원 등록</title>\n+    <!-- Bootstrap CSS -->\n+    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\">\n+    <!-- Font Awesome CSS -->\n+    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css\">\n+    <link rel=\"stylesheet\" th:href=\"@{/css/hospital_style.css}\">\n+</head>\n+<body>\n+    <th:block th:replace=\"~{/fragments/header :: header}\"></th:block>\n+    <div class=\"hospital-main-container\">\n+        <!-- 상단 로고 -->\n+        <div class=\"logo-container\">\n+            <div class=\"logo\">\n+                <img th:src=\"@{/img/hosp_logo.png}\" alt=\"병원 아이콘\" class=\"logo-icon\">\n+            </div>\n+        </div>\n+\n+        <!-- 메인 컨텐츠 -->\n+        <div class=\"main-content d-flex flex-column\">\n+                        <!-- Hidden form for multipart file upload  잼민이버전-->\n+            <!-- <form id=\"fileUploadForm\" style=\"display: none;\" enctype=\"multipart/form-data\">\n+                <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" onchange=\"previewImage(event)\">\n+            </form> -->\n+\n+            <!-- 채찍피티 버전 -->\n+            <div class=\"d-flex justify-content-between align-items-start gap-6\">\n+\n+                <form id=\"imageForm\" enctype=\"multipart/form-data\">\n+                    <div class=\"image-upload-section\">\n+                        <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n+                            <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n+                        </div>\n+                        <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" style=\"display: none;\" onchange=\"previewImage(event)\">\n+                    </div>\n+                </form>\n+\n+\n+                <!-- Main form for general data -->\n+                <form id=\"generalDataForm\" th:object=\"${hospitalForm}\">\n+                    <input type=\"hidden\" id=\"hospitalId\" th:field=\"*{hospitalId}\" />\n+                    <!-- <input type=\"hidden\" id=\"csrfTokenGeneral\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" /> -->\n+\n+                    <div class=\"form-container\">\n+                        <!-- <div class=\"image-upload-section\">\n+                            <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n+                                <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n+                            </div>\n+                        </div> -->\n+\n+                        <div class=\"form-section\">\n+                            <div class=\"form-group\">\n+                                <label for=\"name\">병원 이름</label>\n+                                <input type=\"text\" id=\"name\" th:field=\"*{name}\" placeholder=\"병원 이름을 작성하세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"address\">병원 주소</label>\n+                                <input type=\"text\" id=\"address\" th:field=\"*{address}\" placeholder=\"주소를 입력해 주세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"homepage\">홈페이지</label>\n+                                <input type=\"url\" id=\"homepage\" th:field=\"*{homepage}\" placeholder=\"홈페이지 주소를 입력해 주세요\">\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"phone\">대표번호</label>\n+                                <input type=\"tel\" id=\"phone\" th:field=\"*{phone}\" placeholder=\"병원 전화번호를 입력하세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"email\">이메일</label>\n+                                <input type=\"email\" id=\"email\" th:field=\"*{email}\" placeholder=\"이메일 주소를 입력하세요\">\n+                            </div>\n+                            <div class=\"form-group\">\n+                                <label for=\"hosp-introduce\">병원 소개</label>\n+                                <textarea type=\"text\" id=\"hosp-introduce\" th:field=\"*{email}\" placeholder=\"간단한 소개글을 작성해 주세요\" required rows=\"4\" style=\"resize: none;\"></textarea>\n+                            </div>\n+                        </div>\n+                    </div>\n+                </form>\n+                <div class=\"d-flex flex-column gap-3\" style=\"flex-grow: 1;\">\n+                    <form id=\"checkSpecialForm\" th:object=\"${hospitalForm}\" class=\"d-flex flex-nowrap\">\n+                        <div class=\"form-group\">\n+                            <label>진료 과목</label>\n+                            <div class=\"checkbox-group\">\n+                                <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n+                                    <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\n+                                    <label th:for=\"'spec-' + ${spec.specialtyId}\" th:text=\"${spec.category}\"></label>\n+                                </div>\n+                            </div>\n+                        </div>\n+                    </form>\n+                    <form id=\"checkAnimalForm\" th:object=\"${hospitalForm}\">\n+                        <div class=\"form-group\">\n+                            <label>진료 가능 동물</label>\n+                            <div class=\"category-group\">\n+                                <label th:each=\"animal : ${animalList}\" class=\"category-item\">\n+                                    <input type=\"checkbox\" name=\"category\" th:field=\"*{animalIds}\" th:value=\"${animal.animalId}\" th:id=\"'animal-' + ${animal.animalId}\">\n+                                    <span th:for=\"'animal-' + ${animal.animalId}\" th:text=\"${animal.species}\"></span>\n+                                </label>\n+                            </div>\n+                        </div>\n+                    </form>\n+                </div>\n+            </div>\n+        </div>\n+\n+            <!-- 삭제 form -->\n+            <div sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">\n+                <form id=\"deleteForm\" th:action=\"@{/hospitals/delete/{id}(id=${hospitalForm.hospitalId})}\" method=\"post\" style=\"display: none;\">\n+                    <input type=\"hidden\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" />\n+                </form>\n+            </div>\n+\n+            <div class=\"d-flex justify-content-center gap-2 mt-4\">\n+                <button type=\"button\" class=\"btn btn-secondary\" onclick=\"history.back()\">취소</button>\n+                <button type=\"button\" id=\"submitAllBtn\" class=\"btn btn-primary\" th:text=\"${hospitalForm.hospitalId != null ? '수정' : '등록'}\"></button>\n+                <button type=\"button\" id=\"deleteBtn\" class=\"btn btn-danger\" sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">삭제</button>\n+            </div>\n+        </div>\n+\n+\n+<script>\n+  function previewImage(event) {\n+    const input = event.target;\n+    const reader = new FileReader();\n+\n+    reader.onload = function () {\n+      const preview = document.getElementById('preview');\n+      preview.src = reader.result;\n+    };\n+\n+    if (input.files && input.files[0]) {\n+      reader.readAsDataURL(input.files[0]);\n+    }\n+  }\n+\n+\n+  // 채찍피티 버전\n+    document.addEventListener('DOMContentLoaded', function () {\n+        const submitAllBtn = document.getElementById('submitAllBtn');\n+        const imageForm = document.getElementById('imageForm');\n+        const generalDataForm = document.getElementById('generalDataForm');\n+        // const hospitalId = '[[${hospitalForm.hospitalId}]]';\n+        const hospitalId = document.getElementById('hospitalId')?.value;\n+        const isNew = !hospitalId || hospitalId === 'null' || hospitalId === '';\n+\n+        const csrfToken = document.querySelector('meta[name=\"_csrf\"]').content;\n+        const csrfHeader = document.querySelector('meta[name=\"_csrf_header\"]').content;\n+\n+        const deleteBtn = document.getElementById('deleteBtn');\n+        if (deleteBtn) {\n+            deleteBtn.addEventListener('click', function() {\n+                if (confirm('정말로 이 병원을 삭제하시겠습니까?')) {\n+                    document.getElementById('deleteForm').submit();\n+                }\n+            });\n+        }\n+\n+        submitAllBtn.addEventListener('click', async function (event) {\n+            event.preventDefault();\n+\n+            const formData = new FormData();\n+\n+            // 1. 일반 입력값 병합\n+            const generalFormData = new FormData(generalDataForm);\n+            for (const [key, value] of generalFormData.entries()) {\n+                formData.append(key, value);\n+            }\n+\n+            // 2. 이미지 파일 업로드 및 URL 병합\n+            const imageFileInput = imageForm.querySelector('#fileInput');\n+            if (imageFileInput && imageFileInput.files.length > 0) {\n+                const imageUploadFormData = new FormData();\n+                imageUploadFormData.append('image', imageFileInput.files[0]);\n+\n+                try {\n+                    const uploadResponse = await fetch('/upload/image', {\n+                        method: 'POST',\n+                        headers: {\n+                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n+                        },\n+                        body: imageUploadFormData\n+                    });\n+\n+                    if (uploadResponse.ok) {\n+                        const uploadResult = await uploadResponse.json();\n+                        if (uploadResult.success === 1) {\n+                            formData.append('thumbnailImageUrl', uploadResult.imageUrl);\n+                        } else {\n+                            alert('이미지 업로드 실패: ' + uploadResult.message);\n+                            return; // 이미지 업로드 실패 시 전체 제출 중단\n+                        }\n+                    } else {\n+                        const errorText = await uploadResponse.text();\n+                        console.error('이미지 업로드 실패:', errorText);\n+                        alert('이미지 업로드를 실패하였습니다.');\n+                        return; // 이미지 업로드 실패 시 전체 제출 중단\n+                    }\n+                } catch (error) {\n+                    console.error('이미지 업로드 중 오류:', error);\n+                    alert('이미지 업로드 중 오류가 발생했습니다.');\n+                    return; // 이미지 업로드 실패 시 전체 제출 중단\n+                }\n+            }\n+\n+            // 3. 전송\n+            const actionUrl = isNew ? '/hospitals/new' : '/hospitals/edit';\n+\n+            try {\n+                const response = await fetch(actionUrl, {\n+                    method: 'POST',\n+                    headers: {\n+                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n+                        },\n+                    body: formData\n+                });\n+\n+                if (response.ok) {\n+                    const result = await response.json();\n+                    alert('병원 정보가 성공적으로 제출되었습니다!');\n+                    window.location.href = '/hospitals';\n+                } else {\n+                    const errorText = await response.text();\n+                    console.error('제출 실패:', errorText);\n+                    alert('제출에 실패했습니다: ' + errorText);\n+                }\n+            } catch (error) {\n+                console.error('제출 중 오류:', error);\n+                alert('제출 중 오류가 발생했습니다.');\n+            }\n+        });\n+    });\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+  // 잼민이 버전\n+//   document.addEventListener('DOMContentLoaded', function() {\n+//     const submitAllBtn = document.getElementById('submitAllBtn');\n+//     const generalDataForm = document.getElementById('generalDataForm');\n+//     const fileUploadForm = document.getElementById('fileUploadForm'); // fileUploadForm 참조 추가\n+//     const hospitalId = '[[${hospitalForm.hospitalId}]]'; // Thymeleaf 변수 사용\n+\n+//     submitAllBtn.addEventListener('click', async function(event) {\n+//       event.preventDefault(); // 기본 폼 제출 방지\n+\n+//       const formData = new FormData(generalDataForm); // generalDataForm의 데이터로 FormData 초기화\n+//       const fileInput = fileUploadForm.querySelector('#fileInput'); // fileUploadForm에서 fileInput 가져오기\n+//       if (fileInput && fileInput.files && fileInput.files[0]) {\n+//         formData.append('thumbnailImageFile', fileInput.files[0]);\n+//       }\n+\n+//       // 폼 액션 URL 결정\n+//       const actionUrl = hospitalId === 'null' ? '/hospitals/new' : '/hospitals/edit';\n+\n+//       try {\n+//         const response = await fetch(actionUrl, {\n+//                                                     method: 'POST',\n+//                                                     body: formData\n+//                                                 });\n+\n+//         if (response.ok) {\n+//           const result = await response.json(); // 또는 response.text()\n+//           console.log('Submission successful:', result);\n+//           alert('병원 정보가 성공적으로 제출되었습니다!');\n+//           // 성공 후 리다이렉트 또는 다른 작업 수행\n+//           window.location.href = '/hospitals'; // 예시: 병원 목록 페이지로 이동\n+//         } else {\n+//           const errorText = await response.text();\n+//           console.error('Submission failed:', response.status, errorText);\n+//           alert('병원 정보 제출에 실패했습니다: ' + errorText);\n+//         }\n+//       } catch (error) {\n+//         console.error('Error during submission:', error);\n+//         alert('병원 정보 제출 중 오류가 발생했습니다.');\n+//       }\n+//     });\n+//   });\n+</script>\n+\n+\n+    <th:block th:replace=\"~{/fragments/footer :: footer}\"></th:block>\n+    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q\" crossorigin=\"anonymous\"></script>\n+</body>\n+</html>\n\\ No newline at end of file\n"
                },
                {
                    "date": 1751989886595,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,301 @@\n+<!DOCTYPE html>\n+<html lang=\"ko\" xmlns:th=\"http://www.thymeleaf.org\" xmlns:sec=\"http://www.thymeleaf.org/thymeleaf-extras-springsecurity5\">\n+<head>\n+    <meta charset=\"UTF-8\">\n+    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n+    <meta name=\"_csrf\" th:content=\"${_csrf.token}\" />\n+    <meta name=\"_csrf_header\" th:content=\"${_csrf.headerName}\" />\n+\n+    <title>병원 등록</title>\n+    <!-- Bootstrap CSS -->\n+    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\">\n+    <!-- Font Awesome CSS -->\n+    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css\">\n+    <link rel=\"stylesheet\" th:href=\"@{/css/hospital_style.css}\">\n+</head>\n+<body>\n+    <th:block th:replace=\"~{/fragments/header :: header}\"></th:block>\n+    <div class=\"hospital-main-container\">\n+        <!-- 상단 로고 -->\n+        <div class=\"logo-container\">\n+            <div class=\"logo\">\n+                <img th:src=\"@{/img/hosp_logo.png}\" alt=\"병원 아이콘\" class=\"logo-icon\">\n+            </div>\n+        </div>\n+\n+        <!-- 메인 컨텐츠 -->\n+        <div class=\"main-content d-flex flex-column align-items-center\">\n+                        <!-- Hidden form for multipart file upload  잼민이버전-->\n+            <!-- <form id=\"fileUploadForm\" style=\"display: none;\" enctype=\"multipart/form-data\">\n+                <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" onchange=\"previewImage(event)\">\n+            </form> -->\n+\n+            <!-- 채찍피티 버전 -->\n+            <div class=\"d-flex justify-content-between align-items-start\">\n+\n+                <form id=\"imageForm\" enctype=\"multipart/form-data\">\n+                    <div class=\"image-upload-section\">\n+                        <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n+                            <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n+                        </div>\n+                        <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" style=\"display: none;\" onchange=\"previewImage(event)\">\n+                    </div>\n+                </form>\n+\n+\n+                <!-- Main form for general data -->\n+                <form id=\"generalDataForm\" th:object=\"${hospitalForm}\">\n+                    <input type=\"hidden\" id=\"hospitalId\" th:field=\"*{hospitalId}\" />\n+                    <!-- <input type=\"hidden\" id=\"csrfTokenGeneral\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" /> -->\n+\n+                    <div class=\"form-container\">\n+                        <!-- <div class=\"image-upload-section\">\n+                            <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n+                                <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n+                            </div>\n+                        </div> -->\n+\n+                        <div class=\"form-section\">\n+                            <div class=\"form-group\">\n+                                <label for=\"name\">병원 이름</label>\n+                                <input type=\"text\" id=\"name\" th:field=\"*{name}\" placeholder=\"병원 이름을 작성하세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"address\">병원 주소</label>\n+                                <input type=\"text\" id=\"address\" th:field=\"*{address}\" placeholder=\"주소를 입력해 주세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"homepage\">홈페이지</label>\n+                                <input type=\"url\" id=\"homepage\" th:field=\"*{homepage}\" placeholder=\"홈페이지 주소를 입력해 주세요\">\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"phone\">대표번호</label>\n+                                <input type=\"tel\" id=\"phone\" th:field=\"*{phone}\" placeholder=\"병원 전화번호를 입력하세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"email\">이메일</label>\n+                                <input type=\"email\" id=\"email\" th:field=\"*{email}\" placeholder=\"이메일 주소를 입력하세요\">\n+                            </div>\n+                            <div class=\"form-group\">\n+                                <label for=\"hosp-introduce\">병원 소개</label>\n+                                <textarea type=\"text\" id=\"hosp-introduce\" th:field=\"*{email}\" placeholder=\"간단한 소개글을 작성해 주세요\" required rows=\"4\" style=\"resize: none;\"></textarea>\n+                            </div>\n+                        </div>\n+                    </div>\n+                </form>\n+                <div class=\"d-flex flex-column gap-3\" style=\"flex-grow: 1;\">\n+                    <form id=\"checkSpecialForm\" th:object=\"${hospitalForm}\" class=\"d-flex flex-nowrap\">\n+                        <div class=\"form-group\">\n+                            <label>진료 과목</label>\n+                            <div class=\"checkbox-group\">\n+                                <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n+                                    <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\n+                                    <label th:for=\"'spec-' + ${spec.specialtyId}\" th:text=\"${spec.category}\"></label>\n+                                </div>\n+                            </div>\n+                        </div>\n+                    </form>\n+                    <form id=\"checkAnimalForm\" th:object=\"${hospitalForm}\">\n+                        <div class=\"form-group\">\n+                            <label>진료 가능 동물</label>\n+                            <div class=\"category-group\">\n+                                <label th:each=\"animal : ${animalList}\" class=\"category-item\">\n+                                    <input type=\"checkbox\" name=\"category\" th:field=\"*{animalIds}\" th:value=\"${animal.animalId}\" th:id=\"'animal-' + ${animal.animalId}\">\n+                                    <span th:for=\"'animal-' + ${animal.animalId}\" th:text=\"${animal.species}\"></span>\n+                                </label>\n+                            </div>\n+                        </div>\n+                    </form>\n+                </div>\n+            </div>\n+        </div>\n+\n+            <!-- 삭제 form -->\n+            <div sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">\n+                <form id=\"deleteForm\" th:action=\"@{/hospitals/delete/{id}(id=${hospitalForm.hospitalId})}\" method=\"post\" style=\"display: none;\">\n+                    <input type=\"hidden\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" />\n+                </form>\n+            </div>\n+\n+            <div class=\"d-flex justify-content-center gap-2 mt-4\">\n+                <button type=\"button\" class=\"btn btn-secondary\" onclick=\"history.back()\">취소</button>\n+                <button type=\"button\" id=\"submitAllBtn\" class=\"btn btn-primary\" th:text=\"${hospitalForm.hospitalId != null ? '수정' : '등록'}\"></button>\n+                <button type=\"button\" id=\"deleteBtn\" class=\"btn btn-danger\" sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">삭제</button>\n+            </div>\n+        </div>\n+\n+\n+<script>\n+  function previewImage(event) {\n+    const input = event.target;\n+    const reader = new FileReader();\n+\n+    reader.onload = function () {\n+      const preview = document.getElementById('preview');\n+      preview.src = reader.result;\n+    };\n+\n+    if (input.files && input.files[0]) {\n+      reader.readAsDataURL(input.files[0]);\n+    }\n+  }\n+\n+\n+  // 채찍피티 버전\n+    document.addEventListener('DOMContentLoaded', function () {\n+        const submitAllBtn = document.getElementById('submitAllBtn');\n+        const imageForm = document.getElementById('imageForm');\n+        const generalDataForm = document.getElementById('generalDataForm');\n+        // const hospitalId = '[[${hospitalForm.hospitalId}]]';\n+        const hospitalId = document.getElementById('hospitalId')?.value;\n+        const isNew = !hospitalId || hospitalId === 'null' || hospitalId === '';\n+\n+        const csrfToken = document.querySelector('meta[name=\"_csrf\"]').content;\n+        const csrfHeader = document.querySelector('meta[name=\"_csrf_header\"]').content;\n+\n+        const deleteBtn = document.getElementById('deleteBtn');\n+        if (deleteBtn) {\n+            deleteBtn.addEventListener('click', function() {\n+                if (confirm('정말로 이 병원을 삭제하시겠습니까?')) {\n+                    document.getElementById('deleteForm').submit();\n+                }\n+            });\n+        }\n+\n+        submitAllBtn.addEventListener('click', async function (event) {\n+            event.preventDefault();\n+\n+            const formData = new FormData();\n+\n+            // 1. 일반 입력값 병합\n+            const generalFormData = new FormData(generalDataForm);\n+            for (const [key, value] of generalFormData.entries()) {\n+                formData.append(key, value);\n+            }\n+\n+            // 2. 이미지 파일 업로드 및 URL 병합\n+            const imageFileInput = imageForm.querySelector('#fileInput');\n+            if (imageFileInput && imageFileInput.files.length > 0) {\n+                const imageUploadFormData = new FormData();\n+                imageUploadFormData.append('image', imageFileInput.files[0]);\n+\n+                try {\n+                    const uploadResponse = await fetch('/upload/image', {\n+                        method: 'POST',\n+                        headers: {\n+                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n+                        },\n+                        body: imageUploadFormData\n+                    });\n+\n+                    if (uploadResponse.ok) {\n+                        const uploadResult = await uploadResponse.json();\n+                        if (uploadResult.success === 1) {\n+                            formData.append('thumbnailImageUrl', uploadResult.imageUrl);\n+                        } else {\n+                            alert('이미지 업로드 실패: ' + uploadResult.message);\n+                            return; // 이미지 업로드 실패 시 전체 제출 중단\n+                        }\n+                    } else {\n+                        const errorText = await uploadResponse.text();\n+                        console.error('이미지 업로드 실패:', errorText);\n+                        alert('이미지 업로드를 실패하였습니다.');\n+                        return; // 이미지 업로드 실패 시 전체 제출 중단\n+                    }\n+                } catch (error) {\n+                    console.error('이미지 업로드 중 오류:', error);\n+                    alert('이미지 업로드 중 오류가 발생했습니다.');\n+                    return; // 이미지 업로드 실패 시 전체 제출 중단\n+                }\n+            }\n+\n+            // 3. 전송\n+            const actionUrl = isNew ? '/hospitals/new' : '/hospitals/edit';\n+\n+            try {\n+                const response = await fetch(actionUrl, {\n+                    method: 'POST',\n+                    headers: {\n+                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n+                        },\n+                    body: formData\n+                });\n+\n+                if (response.ok) {\n+                    const result = await response.json();\n+                    alert('병원 정보가 성공적으로 제출되었습니다!');\n+                    window.location.href = '/hospitals';\n+                } else {\n+                    const errorText = await response.text();\n+                    console.error('제출 실패:', errorText);\n+                    alert('제출에 실패했습니다: ' + errorText);\n+                }\n+            } catch (error) {\n+                console.error('제출 중 오류:', error);\n+                alert('제출 중 오류가 발생했습니다.');\n+            }\n+        });\n+    });\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+  // 잼민이 버전\n+//   document.addEventListener('DOMContentLoaded', function() {\n+//     const submitAllBtn = document.getElementById('submitAllBtn');\n+//     const generalDataForm = document.getElementById('generalDataForm');\n+//     const fileUploadForm = document.getElementById('fileUploadForm'); // fileUploadForm 참조 추가\n+//     const hospitalId = '[[${hospitalForm.hospitalId}]]'; // Thymeleaf 변수 사용\n+\n+//     submitAllBtn.addEventListener('click', async function(event) {\n+//       event.preventDefault(); // 기본 폼 제출 방지\n+\n+//       const formData = new FormData(generalDataForm); // generalDataForm의 데이터로 FormData 초기화\n+//       const fileInput = fileUploadForm.querySelector('#fileInput'); // fileUploadForm에서 fileInput 가져오기\n+//       if (fileInput && fileInput.files && fileInput.files[0]) {\n+//         formData.append('thumbnailImageFile', fileInput.files[0]);\n+//       }\n+\n+//       // 폼 액션 URL 결정\n+//       const actionUrl = hospitalId === 'null' ? '/hospitals/new' : '/hospitals/edit';\n+\n+//       try {\n+//         const response = await fetch(actionUrl, {\n+//                                                     method: 'POST',\n+//                                                     body: formData\n+//                                                 });\n+\n+//         if (response.ok) {\n+//           const result = await response.json(); // 또는 response.text()\n+//           console.log('Submission successful:', result);\n+//           alert('병원 정보가 성공적으로 제출되었습니다!');\n+//           // 성공 후 리다이렉트 또는 다른 작업 수행\n+//           window.location.href = '/hospitals'; // 예시: 병원 목록 페이지로 이동\n+//         } else {\n+//           const errorText = await response.text();\n+//           console.error('Submission failed:', response.status, errorText);\n+//           alert('병원 정보 제출에 실패했습니다: ' + errorText);\n+//         }\n+//       } catch (error) {\n+//         console.error('Error during submission:', error);\n+//         alert('병원 정보 제출 중 오류가 발생했습니다.');\n+//       }\n+//     });\n+//   });\n+</script>\n+\n+\n+    <th:block th:replace=\"~{/fragments/footer :: footer}\"></th:block>\n+    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q\" crossorigin=\"anonymous\"></script>\n+</body>\n+</html>\n\\ No newline at end of file\n"
                },
                {
                    "date": 1751989932774,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,301 @@\n+<!DOCTYPE html>\n+<html lang=\"ko\" xmlns:th=\"http://www.thymeleaf.org\" xmlns:sec=\"http://www.thymeleaf.org/thymeleaf-extras-springsecurity5\">\n+<head>\n+    <meta charset=\"UTF-8\">\n+    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n+    <meta name=\"_csrf\" th:content=\"${_csrf.token}\" />\n+    <meta name=\"_csrf_header\" th:content=\"${_csrf.headerName}\" />\n+\n+    <title>병원 등록</title>\n+    <!-- Bootstrap CSS -->\n+    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\">\n+    <!-- Font Awesome CSS -->\n+    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css\">\n+    <link rel=\"stylesheet\" th:href=\"@{/css/hospital_style.css}\">\n+</head>\n+<body>\n+    <th:block th:replace=\"~{/fragments/header :: header}\"></th:block>\n+    <div class=\"hospital-main-container\">\n+        <!-- 상단 로고 -->\n+        <div class=\"logo-container\">\n+            <div class=\"logo\">\n+                <img th:src=\"@{/img/hosp_logo.png}\" alt=\"병원 아이콘\" class=\"logo-icon\">\n+            </div>\n+        </div>\n+\n+        <!-- 메인 컨텐츠 -->\n+        <div class=\"main-content d-flex flex-column align-items-center\">\n+                        <!-- Hidden form for multipart file upload  잼민이버전-->\n+            <!-- <form id=\"fileUploadForm\" style=\"display: none;\" enctype=\"multipart/form-data\">\n+                <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" onchange=\"previewImage(event)\">\n+            </form> -->\n+\n+            <!-- 채찍피티 버전 -->\n+            <div class=\"d-flex justify-content-between align-items-start gap-5\">\n+\n+                <form id=\"imageForm\" enctype=\"multipart/form-data\">\n+                    <div class=\"image-upload-section\">\n+                        <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n+                            <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n+                        </div>\n+                        <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" style=\"display: none;\" onchange=\"previewImage(event)\">\n+                    </div>\n+                </form>\n+\n+\n+                <!-- Main form for general data -->\n+                <form id=\"generalDataForm\" th:object=\"${hospitalForm}\">\n+                    <input type=\"hidden\" id=\"hospitalId\" th:field=\"*{hospitalId}\" />\n+                    <!-- <input type=\"hidden\" id=\"csrfTokenGeneral\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" /> -->\n+\n+                    <div class=\"form-container\">\n+                        <!-- <div class=\"image-upload-section\">\n+                            <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n+                                <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n+                            </div>\n+                        </div> -->\n+\n+                        <div class=\"form-section\">\n+                            <div class=\"form-group\">\n+                                <label for=\"name\">병원 이름</label>\n+                                <input type=\"text\" id=\"name\" th:field=\"*{name}\" placeholder=\"병원 이름을 작성하세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"address\">병원 주소</label>\n+                                <input type=\"text\" id=\"address\" th:field=\"*{address}\" placeholder=\"주소를 입력해 주세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"homepage\">홈페이지</label>\n+                                <input type=\"url\" id=\"homepage\" th:field=\"*{homepage}\" placeholder=\"홈페이지 주소를 입력해 주세요\">\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"phone\">대표번호</label>\n+                                <input type=\"tel\" id=\"phone\" th:field=\"*{phone}\" placeholder=\"병원 전화번호를 입력하세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"email\">이메일</label>\n+                                <input type=\"email\" id=\"email\" th:field=\"*{email}\" placeholder=\"이메일 주소를 입력하세요\">\n+                            </div>\n+                            <div class=\"form-group\">\n+                                <label for=\"hosp-introduce\">병원 소개</label>\n+                                <textarea type=\"text\" id=\"hosp-introduce\" th:field=\"*{email}\" placeholder=\"간단한 소개글을 작성해 주세요\" required rows=\"4\" style=\"resize: none;\"></textarea>\n+                            </div>\n+                        </div>\n+                    </div>\n+                </form>\n+                <div class=\"d-flex flex-column gap-3\" style=\"flex-grow: 1;\">\n+                    <form id=\"checkSpecialForm\" th:object=\"${hospitalForm}\" class=\"d-flex flex-nowrap\">\n+                        <div class=\"form-group\">\n+                            <label>진료 과목</label>\n+                            <div class=\"checkbox-group\">\n+                                <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n+                                    <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\n+                                    <label th:for=\"'spec-' + ${spec.specialtyId}\" th:text=\"${spec.category}\"></label>\n+                                </div>\n+                            </div>\n+                        </div>\n+                    </form>\n+                    <form id=\"checkAnimalForm\" th:object=\"${hospitalForm}\">\n+                        <div class=\"form-group\">\n+                            <label>진료 가능 동물</label>\n+                            <div class=\"category-group\">\n+                                <label th:each=\"animal : ${animalList}\" class=\"category-item\">\n+                                    <input type=\"checkbox\" name=\"category\" th:field=\"*{animalIds}\" th:value=\"${animal.animalId}\" th:id=\"'animal-' + ${animal.animalId}\">\n+                                    <span th:for=\"'animal-' + ${animal.animalId}\" th:text=\"${animal.species}\"></span>\n+                                </label>\n+                            </div>\n+                        </div>\n+                    </form>\n+                </div>\n+            </div>\n+        </div>\n+\n+            <!-- 삭제 form -->\n+            <div sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">\n+                <form id=\"deleteForm\" th:action=\"@{/hospitals/delete/{id}(id=${hospitalForm.hospitalId})}\" method=\"post\" style=\"display: none;\">\n+                    <input type=\"hidden\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" />\n+                </form>\n+            </div>\n+\n+            <div class=\"d-flex justify-content-center gap-2 mt-4\">\n+                <button type=\"button\" class=\"btn btn-secondary\" onclick=\"history.back()\">취소</button>\n+                <button type=\"button\" id=\"submitAllBtn\" class=\"btn btn-primary\" th:text=\"${hospitalForm.hospitalId != null ? '수정' : '등록'}\"></button>\n+                <button type=\"button\" id=\"deleteBtn\" class=\"btn btn-danger\" sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">삭제</button>\n+            </div>\n+        </div>\n+\n+\n+<script>\n+  function previewImage(event) {\n+    const input = event.target;\n+    const reader = new FileReader();\n+\n+    reader.onload = function () {\n+      const preview = document.getElementById('preview');\n+      preview.src = reader.result;\n+    };\n+\n+    if (input.files && input.files[0]) {\n+      reader.readAsDataURL(input.files[0]);\n+    }\n+  }\n+\n+\n+  // 채찍피티 버전\n+    document.addEventListener('DOMContentLoaded', function () {\n+        const submitAllBtn = document.getElementById('submitAllBtn');\n+        const imageForm = document.getElementById('imageForm');\n+        const generalDataForm = document.getElementById('generalDataForm');\n+        // const hospitalId = '[[${hospitalForm.hospitalId}]]';\n+        const hospitalId = document.getElementById('hospitalId')?.value;\n+        const isNew = !hospitalId || hospitalId === 'null' || hospitalId === '';\n+\n+        const csrfToken = document.querySelector('meta[name=\"_csrf\"]').content;\n+        const csrfHeader = document.querySelector('meta[name=\"_csrf_header\"]').content;\n+\n+        const deleteBtn = document.getElementById('deleteBtn');\n+        if (deleteBtn) {\n+            deleteBtn.addEventListener('click', function() {\n+                if (confirm('정말로 이 병원을 삭제하시겠습니까?')) {\n+                    document.getElementById('deleteForm').submit();\n+                }\n+            });\n+        }\n+\n+        submitAllBtn.addEventListener('click', async function (event) {\n+            event.preventDefault();\n+\n+            const formData = new FormData();\n+\n+            // 1. 일반 입력값 병합\n+            const generalFormData = new FormData(generalDataForm);\n+            for (const [key, value] of generalFormData.entries()) {\n+                formData.append(key, value);\n+            }\n+\n+            // 2. 이미지 파일 업로드 및 URL 병합\n+            const imageFileInput = imageForm.querySelector('#fileInput');\n+            if (imageFileInput && imageFileInput.files.length > 0) {\n+                const imageUploadFormData = new FormData();\n+                imageUploadFormData.append('image', imageFileInput.files[0]);\n+\n+                try {\n+                    const uploadResponse = await fetch('/upload/image', {\n+                        method: 'POST',\n+                        headers: {\n+                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n+                        },\n+                        body: imageUploadFormData\n+                    });\n+\n+                    if (uploadResponse.ok) {\n+                        const uploadResult = await uploadResponse.json();\n+                        if (uploadResult.success === 1) {\n+                            formData.append('thumbnailImageUrl', uploadResult.imageUrl);\n+                        } else {\n+                            alert('이미지 업로드 실패: ' + uploadResult.message);\n+                            return; // 이미지 업로드 실패 시 전체 제출 중단\n+                        }\n+                    } else {\n+                        const errorText = await uploadResponse.text();\n+                        console.error('이미지 업로드 실패:', errorText);\n+                        alert('이미지 업로드를 실패하였습니다.');\n+                        return; // 이미지 업로드 실패 시 전체 제출 중단\n+                    }\n+                } catch (error) {\n+                    console.error('이미지 업로드 중 오류:', error);\n+                    alert('이미지 업로드 중 오류가 발생했습니다.');\n+                    return; // 이미지 업로드 실패 시 전체 제출 중단\n+                }\n+            }\n+\n+            // 3. 전송\n+            const actionUrl = isNew ? '/hospitals/new' : '/hospitals/edit';\n+\n+            try {\n+                const response = await fetch(actionUrl, {\n+                    method: 'POST',\n+                    headers: {\n+                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n+                        },\n+                    body: formData\n+                });\n+\n+                if (response.ok) {\n+                    const result = await response.json();\n+                    alert('병원 정보가 성공적으로 제출되었습니다!');\n+                    window.location.href = '/hospitals';\n+                } else {\n+                    const errorText = await response.text();\n+                    console.error('제출 실패:', errorText);\n+                    alert('제출에 실패했습니다: ' + errorText);\n+                }\n+            } catch (error) {\n+                console.error('제출 중 오류:', error);\n+                alert('제출 중 오류가 발생했습니다.');\n+            }\n+        });\n+    });\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+  // 잼민이 버전\n+//   document.addEventListener('DOMContentLoaded', function() {\n+//     const submitAllBtn = document.getElementById('submitAllBtn');\n+//     const generalDataForm = document.getElementById('generalDataForm');\n+//     const fileUploadForm = document.getElementById('fileUploadForm'); // fileUploadForm 참조 추가\n+//     const hospitalId = '[[${hospitalForm.hospitalId}]]'; // Thymeleaf 변수 사용\n+\n+//     submitAllBtn.addEventListener('click', async function(event) {\n+//       event.preventDefault(); // 기본 폼 제출 방지\n+\n+//       const formData = new FormData(generalDataForm); // generalDataForm의 데이터로 FormData 초기화\n+//       const fileInput = fileUploadForm.querySelector('#fileInput'); // fileUploadForm에서 fileInput 가져오기\n+//       if (fileInput && fileInput.files && fileInput.files[0]) {\n+//         formData.append('thumbnailImageFile', fileInput.files[0]);\n+//       }\n+\n+//       // 폼 액션 URL 결정\n+//       const actionUrl = hospitalId === 'null' ? '/hospitals/new' : '/hospitals/edit';\n+\n+//       try {\n+//         const response = await fetch(actionUrl, {\n+//                                                     method: 'POST',\n+//                                                     body: formData\n+//                                                 });\n+\n+//         if (response.ok) {\n+//           const result = await response.json(); // 또는 response.text()\n+//           console.log('Submission successful:', result);\n+//           alert('병원 정보가 성공적으로 제출되었습니다!');\n+//           // 성공 후 리다이렉트 또는 다른 작업 수행\n+//           window.location.href = '/hospitals'; // 예시: 병원 목록 페이지로 이동\n+//         } else {\n+//           const errorText = await response.text();\n+//           console.error('Submission failed:', response.status, errorText);\n+//           alert('병원 정보 제출에 실패했습니다: ' + errorText);\n+//         }\n+//       } catch (error) {\n+//         console.error('Error during submission:', error);\n+//         alert('병원 정보 제출 중 오류가 발생했습니다.');\n+//       }\n+//     });\n+//   });\n+</script>\n+\n+\n+    <th:block th:replace=\"~{/fragments/footer :: footer}\"></th:block>\n+    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q\" crossorigin=\"anonymous\"></script>\n+</body>\n+</html>\n\\ No newline at end of file\n"
                },
                {
                    "date": 1751989973553,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,301 @@\n+<!DOCTYPE html>\n+<html lang=\"ko\" xmlns:th=\"http://www.thymeleaf.org\" xmlns:sec=\"http://www.thymeleaf.org/thymeleaf-extras-springsecurity5\">\n+<head>\n+    <meta charset=\"UTF-8\">\n+    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n+    <meta name=\"_csrf\" th:content=\"${_csrf.token}\" />\n+    <meta name=\"_csrf_header\" th:content=\"${_csrf.headerName}\" />\n+\n+    <title>병원 등록</title>\n+    <!-- Bootstrap CSS -->\n+    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\">\n+    <!-- Font Awesome CSS -->\n+    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css\">\n+    <link rel=\"stylesheet\" th:href=\"@{/css/hospital_style.css}\">\n+</head>\n+<body>\n+    <th:block th:replace=\"~{/fragments/header :: header}\"></th:block>\n+    <div class=\"hospital-main-container\">\n+        <!-- 상단 로고 -->\n+        <div class=\"logo-container\">\n+            <div class=\"logo\">\n+                <img th:src=\"@{/img/hosp_logo.png}\" alt=\"병원 아이콘\" class=\"logo-icon\">\n+            </div>\n+        </div>\n+\n+        <!-- 메인 컨텐츠 -->\n+        <div class=\"main-content d-flex flex-column align-items-center\">\n+                        <!-- Hidden form for multipart file upload  잼민이버전-->\n+            <!-- <form id=\"fileUploadForm\" style=\"display: none;\" enctype=\"multipart/form-data\">\n+                <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" onchange=\"previewImage(event)\">\n+            </form> -->\n+\n+            <!-- 채찍피티 버전 -->\n+            <div class=\"d-flex justify-content-between align-items-start gap-5\">\n+\n+                <form id=\"imageForm\" enctype=\"multipart/form-data\">\n+                    <div class=\"image-upload-section\">\n+                        <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n+                            <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n+                        </div>\n+                        <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" style=\"display: none;\" onchange=\"previewImage(event)\">\n+                    </div>\n+                </form>\n+\n+\n+                <!-- Main form for general data -->\n+                <form id=\"generalDataForm\" th:object=\"${hospitalForm}\">\n+                    <input type=\"hidden\" id=\"hospitalId\" th:field=\"*{hospitalId}\" />\n+                    <!-- <input type=\"hidden\" id=\"csrfTokenGeneral\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" /> -->\n+\n+                    <div class=\"form-container\">\n+                        <!-- <div class=\"image-upload-section\">\n+                            <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n+                                <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n+                            </div>\n+                        </div> -->\n+\n+                        <div class=\"form-section\">\n+                            <div class=\"form-group\">\n+                                <label for=\"name\">병원 이름</label>\n+                                <input type=\"text\" id=\"name\" th:field=\"*{name}\" placeholder=\"병원 이름을 작성하세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"address\">병원 주소</label>\n+                                <input type=\"text\" id=\"address\" th:field=\"*{address}\" placeholder=\"주소를 입력해 주세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"homepage\">홈페이지</label>\n+                                <input type=\"url\" id=\"homepage\" th:field=\"*{homepage}\" placeholder=\"홈페이지 주소를 입력해 주세요\">\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"phone\">대표번호</label>\n+                                <input type=\"tel\" id=\"phone\" th:field=\"*{phone}\" placeholder=\"병원 전화번호를 입력하세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"email\">이메일</label>\n+                                <input type=\"email\" id=\"email\" th:field=\"*{email}\" placeholder=\"이메일 주소를 입력하세요\">\n+                            </div>\n+                            <div class=\"form-group\">\n+                                <label for=\"hosp-introduce\">병원 소개</label>\n+                                <textarea type=\"text\" id=\"hosp-introduce\" th:field=\"*{email}\" placeholder=\"간단한 소개글을 작성해 주세요\" required rows=\"4\" style=\"resize: none;\"></textarea>\n+                            </div>\n+                        </div>\n+                    </div>\n+                </form>\n+                <div class=\"d-flex flex-column gap-3\" style=\"flex-grow: 1;\">\n+                    <form id=\"checkSpecialForm\" th:object=\"${hospitalForm}\" class=\"d-flex flex-nowrap\">\n+                        <div class=\"form-group d-flex flex-nowrap\">\n+                            <label>진료 과목</label>\n+                            <div class=\"checkbox-group\">\n+                                <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n+                                    <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\n+                                    <label th:for=\"'spec-' + ${spec.specialtyId}\" th:text=\"${spec.category}\"></label>\n+                                </div>\n+                            </div>\n+                        </div>\n+                    </form>\n+                    <form id=\"checkAnimalForm\" th:object=\"${hospitalForm}\">\n+                        <div class=\"form-group\">\n+                            <label>진료 가능 동물</label>\n+                            <div class=\"category-group\">\n+                                <label th:each=\"animal : ${animalList}\" class=\"category-item\">\n+                                    <input type=\"checkbox\" name=\"category\" th:field=\"*{animalIds}\" th:value=\"${animal.animalId}\" th:id=\"'animal-' + ${animal.animalId}\">\n+                                    <span th:for=\"'animal-' + ${animal.animalId}\" th:text=\"${animal.species}\"></span>\n+                                </label>\n+                            </div>\n+                        </div>\n+                    </form>\n+                </div>\n+            </div>\n+        </div>\n+\n+            <!-- 삭제 form -->\n+            <div sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">\n+                <form id=\"deleteForm\" th:action=\"@{/hospitals/delete/{id}(id=${hospitalForm.hospitalId})}\" method=\"post\" style=\"display: none;\">\n+                    <input type=\"hidden\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" />\n+                </form>\n+            </div>\n+\n+            <div class=\"d-flex justify-content-center gap-2 mt-4\">\n+                <button type=\"button\" class=\"btn btn-secondary\" onclick=\"history.back()\">취소</button>\n+                <button type=\"button\" id=\"submitAllBtn\" class=\"btn btn-primary\" th:text=\"${hospitalForm.hospitalId != null ? '수정' : '등록'}\"></button>\n+                <button type=\"button\" id=\"deleteBtn\" class=\"btn btn-danger\" sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">삭제</button>\n+            </div>\n+        </div>\n+\n+\n+<script>\n+  function previewImage(event) {\n+    const input = event.target;\n+    const reader = new FileReader();\n+\n+    reader.onload = function () {\n+      const preview = document.getElementById('preview');\n+      preview.src = reader.result;\n+    };\n+\n+    if (input.files && input.files[0]) {\n+      reader.readAsDataURL(input.files[0]);\n+    }\n+  }\n+\n+\n+  // 채찍피티 버전\n+    document.addEventListener('DOMContentLoaded', function () {\n+        const submitAllBtn = document.getElementById('submitAllBtn');\n+        const imageForm = document.getElementById('imageForm');\n+        const generalDataForm = document.getElementById('generalDataForm');\n+        // const hospitalId = '[[${hospitalForm.hospitalId}]]';\n+        const hospitalId = document.getElementById('hospitalId')?.value;\n+        const isNew = !hospitalId || hospitalId === 'null' || hospitalId === '';\n+\n+        const csrfToken = document.querySelector('meta[name=\"_csrf\"]').content;\n+        const csrfHeader = document.querySelector('meta[name=\"_csrf_header\"]').content;\n+\n+        const deleteBtn = document.getElementById('deleteBtn');\n+        if (deleteBtn) {\n+            deleteBtn.addEventListener('click', function() {\n+                if (confirm('정말로 이 병원을 삭제하시겠습니까?')) {\n+                    document.getElementById('deleteForm').submit();\n+                }\n+            });\n+        }\n+\n+        submitAllBtn.addEventListener('click', async function (event) {\n+            event.preventDefault();\n+\n+            const formData = new FormData();\n+\n+            // 1. 일반 입력값 병합\n+            const generalFormData = new FormData(generalDataForm);\n+            for (const [key, value] of generalFormData.entries()) {\n+                formData.append(key, value);\n+            }\n+\n+            // 2. 이미지 파일 업로드 및 URL 병합\n+            const imageFileInput = imageForm.querySelector('#fileInput');\n+            if (imageFileInput && imageFileInput.files.length > 0) {\n+                const imageUploadFormData = new FormData();\n+                imageUploadFormData.append('image', imageFileInput.files[0]);\n+\n+                try {\n+                    const uploadResponse = await fetch('/upload/image', {\n+                        method: 'POST',\n+                        headers: {\n+                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n+                        },\n+                        body: imageUploadFormData\n+                    });\n+\n+                    if (uploadResponse.ok) {\n+                        const uploadResult = await uploadResponse.json();\n+                        if (uploadResult.success === 1) {\n+                            formData.append('thumbnailImageUrl', uploadResult.imageUrl);\n+                        } else {\n+                            alert('이미지 업로드 실패: ' + uploadResult.message);\n+                            return; // 이미지 업로드 실패 시 전체 제출 중단\n+                        }\n+                    } else {\n+                        const errorText = await uploadResponse.text();\n+                        console.error('이미지 업로드 실패:', errorText);\n+                        alert('이미지 업로드를 실패하였습니다.');\n+                        return; // 이미지 업로드 실패 시 전체 제출 중단\n+                    }\n+                } catch (error) {\n+                    console.error('이미지 업로드 중 오류:', error);\n+                    alert('이미지 업로드 중 오류가 발생했습니다.');\n+                    return; // 이미지 업로드 실패 시 전체 제출 중단\n+                }\n+            }\n+\n+            // 3. 전송\n+            const actionUrl = isNew ? '/hospitals/new' : '/hospitals/edit';\n+\n+            try {\n+                const response = await fetch(actionUrl, {\n+                    method: 'POST',\n+                    headers: {\n+                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n+                        },\n+                    body: formData\n+                });\n+\n+                if (response.ok) {\n+                    const result = await response.json();\n+                    alert('병원 정보가 성공적으로 제출되었습니다!');\n+                    window.location.href = '/hospitals';\n+                } else {\n+                    const errorText = await response.text();\n+                    console.error('제출 실패:', errorText);\n+                    alert('제출에 실패했습니다: ' + errorText);\n+                }\n+            } catch (error) {\n+                console.error('제출 중 오류:', error);\n+                alert('제출 중 오류가 발생했습니다.');\n+            }\n+        });\n+    });\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+  // 잼민이 버전\n+//   document.addEventListener('DOMContentLoaded', function() {\n+//     const submitAllBtn = document.getElementById('submitAllBtn');\n+//     const generalDataForm = document.getElementById('generalDataForm');\n+//     const fileUploadForm = document.getElementById('fileUploadForm'); // fileUploadForm 참조 추가\n+//     const hospitalId = '[[${hospitalForm.hospitalId}]]'; // Thymeleaf 변수 사용\n+\n+//     submitAllBtn.addEventListener('click', async function(event) {\n+//       event.preventDefault(); // 기본 폼 제출 방지\n+\n+//       const formData = new FormData(generalDataForm); // generalDataForm의 데이터로 FormData 초기화\n+//       const fileInput = fileUploadForm.querySelector('#fileInput'); // fileUploadForm에서 fileInput 가져오기\n+//       if (fileInput && fileInput.files && fileInput.files[0]) {\n+//         formData.append('thumbnailImageFile', fileInput.files[0]);\n+//       }\n+\n+//       // 폼 액션 URL 결정\n+//       const actionUrl = hospitalId === 'null' ? '/hospitals/new' : '/hospitals/edit';\n+\n+//       try {\n+//         const response = await fetch(actionUrl, {\n+//                                                     method: 'POST',\n+//                                                     body: formData\n+//                                                 });\n+\n+//         if (response.ok) {\n+//           const result = await response.json(); // 또는 response.text()\n+//           console.log('Submission successful:', result);\n+//           alert('병원 정보가 성공적으로 제출되었습니다!');\n+//           // 성공 후 리다이렉트 또는 다른 작업 수행\n+//           window.location.href = '/hospitals'; // 예시: 병원 목록 페이지로 이동\n+//         } else {\n+//           const errorText = await response.text();\n+//           console.error('Submission failed:', response.status, errorText);\n+//           alert('병원 정보 제출에 실패했습니다: ' + errorText);\n+//         }\n+//       } catch (error) {\n+//         console.error('Error during submission:', error);\n+//         alert('병원 정보 제출 중 오류가 발생했습니다.');\n+//       }\n+//     });\n+//   });\n+</script>\n+\n+\n+    <th:block th:replace=\"~{/fragments/footer :: footer}\"></th:block>\n+    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q\" crossorigin=\"anonymous\"></script>\n+</body>\n+</html>\n\\ No newline at end of file\n"
                },
                {
                    "date": 1751990554969,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,301 @@\n+<!DOCTYPE html>\n+<html lang=\"ko\" xmlns:th=\"http://www.thymeleaf.org\" xmlns:sec=\"http://www.thymeleaf.org/thymeleaf-extras-springsecurity5\">\n+<head>\n+    <meta charset=\"UTF-8\">\n+    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n+    <meta name=\"_csrf\" th:content=\"${_csrf.token}\" />\n+    <meta name=\"_csrf_header\" th:content=\"${_csrf.headerName}\" />\n+\n+    <title>병원 등록</title>\n+    <!-- Bootstrap CSS -->\n+    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\">\n+    <!-- Font Awesome CSS -->\n+    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css\">\n+    <link rel=\"stylesheet\" th:href=\"@{/css/hospital_style.css}\">\n+</head>\n+<body>\n+    <th:block th:replace=\"~{/fragments/header :: header}\"></th:block>\n+    <div class=\"hospital-main-container\">\n+        <!-- 상단 로고 -->\n+        <div class=\"logo-container\">\n+            <div class=\"logo\">\n+                <img th:src=\"@{/img/hosp_logo.png}\" alt=\"병원 아이콘\" class=\"logo-icon\">\n+            </div>\n+        </div>\n+\n+        <!-- 메인 컨텐츠 -->\n+        <div class=\"main-content d-flex flex-column justify-content-between align-items-center\">\n+                        <!-- Hidden form for multipart file upload  잼민이버전-->\n+            <!-- <form id=\"fileUploadForm\" style=\"display: none;\" enctype=\"multipart/form-data\">\n+                <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" onchange=\"previewImage(event)\">\n+            </form> -->\n+\n+            <!-- 채찍피티 버전 -->\n+            <div class=\"d-flex justify-content-between align-items-start gap-5\">\n+\n+                <form id=\"imageForm\" enctype=\"multipart/form-data\">\n+                    <div class=\"image-upload-section\">\n+                        <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n+                            <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n+                        </div>\n+                        <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" style=\"display: none;\" onchange=\"previewImage(event)\">\n+                    </div>\n+                </form>\n+\n+\n+                <!-- Main form for general data -->\n+                <form id=\"generalDataForm\" th:object=\"${hospitalForm}\">\n+                    <input type=\"hidden\" id=\"hospitalId\" th:field=\"*{hospitalId}\" />\n+                    <!-- <input type=\"hidden\" id=\"csrfTokenGeneral\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" /> -->\n+\n+                    <div class=\"form-container\">\n+                        <!-- <div class=\"image-upload-section\">\n+                            <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n+                                <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n+                            </div>\n+                        </div> -->\n+\n+                        <div class=\"form-section\">\n+                            <div class=\"form-group\">\n+                                <label for=\"name\">병원 이름</label>\n+                                <input type=\"text\" id=\"name\" th:field=\"*{name}\" placeholder=\"병원 이름을 작성하세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"address\">병원 주소</label>\n+                                <input type=\"text\" id=\"address\" th:field=\"*{address}\" placeholder=\"주소를 입력해 주세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"homepage\">홈페이지</label>\n+                                <input type=\"url\" id=\"homepage\" th:field=\"*{homepage}\" placeholder=\"홈페이지 주소를 입력해 주세요\">\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"phone\">대표번호</label>\n+                                <input type=\"tel\" id=\"phone\" th:field=\"*{phone}\" placeholder=\"병원 전화번호를 입력하세요\" required>\n+                            </div>\n+\n+                            <div class=\"form-group\">\n+                                <label for=\"email\">이메일</label>\n+                                <input type=\"email\" id=\"email\" th:field=\"*{email}\" placeholder=\"이메일 주소를 입력하세요\">\n+                            </div>\n+                            <div class=\"form-group\">\n+                                <label for=\"hosp-introduce\">병원 소개</label>\n+                                <textarea type=\"text\" id=\"hosp-introduce\" th:field=\"*{email}\" placeholder=\"간단한 소개글을 작성해 주세요\" required rows=\"4\" style=\"resize: none;\"></textarea>\n+                            </div>\n+                        </div>\n+                    </div>\n+                </form>\n+                <div class=\"d-flex flex-column gap-3\" style=\"flex-grow: 1;\">\n+                    <form id=\"checkSpecialForm\" th:object=\"${hospitalForm}\" class=\"d-flex flex-nowrap\">\n+                        <div class=\"form-group d-flex flex-nowrap\">\n+                            <label>진료 과목</label>\n+                            <div class=\"checkbox-group\">\n+                                <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n+                                    <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\n+                                    <label th:for=\"'spec-' + ${spec.specialtyId}\" th:text=\"${spec.category}\"></label>\n+                                </div>\n+                            </div>\n+                        </div>\n+                    </form>\n+                    <form id=\"checkAnimalForm\" th:object=\"${hospitalForm}\">\n+                        <div class=\"form-group\">\n+                            <label>진료 가능 동물</label>\n+                            <div class=\"category-group\">\n+                                <label th:each=\"animal : ${animalList}\" class=\"category-item\">\n+                                    <input type=\"checkbox\" name=\"category\" th:field=\"*{animalIds}\" th:value=\"${animal.animalId}\" th:id=\"'animal-' + ${animal.animalId}\">\n+                                    <span th:for=\"'animal-' + ${animal.animalId}\" th:text=\"${animal.species}\"></span>\n+                                </label>\n+                            </div>\n+                        </div>\n+                    </form>\n+                </div>\n+            </div>\n+        </div>\n+\n+            <!-- 삭제 form -->\n+            <div sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">\n+                <form id=\"deleteForm\" th:action=\"@{/hospitals/delete/{id}(id=${hospitalForm.hospitalId})}\" method=\"post\" style=\"display: none;\">\n+                    <input type=\"hidden\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" />\n+                </form>\n+            </div>\n+\n+            <div class=\"d-flex justify-content-center gap-2 mt-4\">\n+                <button type=\"button\" class=\"btn btn-secondary\" onclick=\"history.back()\">취소</button>\n+                <button type=\"button\" id=\"submitAllBtn\" class=\"btn btn-primary\" th:text=\"${hospitalForm.hospitalId != null ? '수정' : '등록'}\"></button>\n+                <button type=\"button\" id=\"deleteBtn\" class=\"btn btn-danger\" sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">삭제</button>\n+            </div>\n+        </div>\n+\n+\n+<script>\n+  function previewImage(event) {\n+    const input = event.target;\n+    const reader = new FileReader();\n+\n+    reader.onload = function () {\n+      const preview = document.getElementById('preview');\n+      preview.src = reader.result;\n+    };\n+\n+    if (input.files && input.files[0]) {\n+      reader.readAsDataURL(input.files[0]);\n+    }\n+  }\n+\n+\n+  // 채찍피티 버전\n+    document.addEventListener('DOMContentLoaded', function () {\n+        const submitAllBtn = document.getElementById('submitAllBtn');\n+        const imageForm = document.getElementById('imageForm');\n+        const generalDataForm = document.getElementById('generalDataForm');\n+        // const hospitalId = '[[${hospitalForm.hospitalId}]]';\n+        const hospitalId = document.getElementById('hospitalId')?.value;\n+        const isNew = !hospitalId || hospitalId === 'null' || hospitalId === '';\n+\n+        const csrfToken = document.querySelector('meta[name=\"_csrf\"]').content;\n+        const csrfHeader = document.querySelector('meta[name=\"_csrf_header\"]').content;\n+\n+        const deleteBtn = document.getElementById('deleteBtn');\n+        if (deleteBtn) {\n+            deleteBtn.addEventListener('click', function() {\n+                if (confirm('정말로 이 병원을 삭제하시겠습니까?')) {\n+                    document.getElementById('deleteForm').submit();\n+                }\n+            });\n+        }\n+\n+        submitAllBtn.addEventListener('click', async function (event) {\n+            event.preventDefault();\n+\n+            const formData = new FormData();\n+\n+            // 1. 일반 입력값 병합\n+            const generalFormData = new FormData(generalDataForm);\n+            for (const [key, value] of generalFormData.entries()) {\n+                formData.append(key, value);\n+            }\n+\n+            // 2. 이미지 파일 업로드 및 URL 병합\n+            const imageFileInput = imageForm.querySelector('#fileInput');\n+            if (imageFileInput && imageFileInput.files.length > 0) {\n+                const imageUploadFormData = new FormData();\n+                imageUploadFormData.append('image', imageFileInput.files[0]);\n+\n+                try {\n+                    const uploadResponse = await fetch('/upload/image', {\n+                        method: 'POST',\n+                        headers: {\n+                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n+                        },\n+                        body: imageUploadFormData\n+                    });\n+\n+                    if (uploadResponse.ok) {\n+                        const uploadResult = await uploadResponse.json();\n+                        if (uploadResult.success === 1) {\n+                            formData.append('thumbnailImageUrl', uploadResult.imageUrl);\n+                        } else {\n+                            alert('이미지 업로드 실패: ' + uploadResult.message);\n+                            return; // 이미지 업로드 실패 시 전체 제출 중단\n+                        }\n+                    } else {\n+                        const errorText = await uploadResponse.text();\n+                        console.error('이미지 업로드 실패:', errorText);\n+                        alert('이미지 업로드를 실패하였습니다.');\n+                        return; // 이미지 업로드 실패 시 전체 제출 중단\n+                    }\n+                } catch (error) {\n+                    console.error('이미지 업로드 중 오류:', error);\n+                    alert('이미지 업로드 중 오류가 발생했습니다.');\n+                    return; // 이미지 업로드 실패 시 전체 제출 중단\n+                }\n+            }\n+\n+            // 3. 전송\n+            const actionUrl = isNew ? '/hospitals/new' : '/hospitals/edit';\n+\n+            try {\n+                const response = await fetch(actionUrl, {\n+                    method: 'POST',\n+                    headers: {\n+                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n+                        },\n+                    body: formData\n+                });\n+\n+                if (response.ok) {\n+                    const result = await response.json();\n+                    alert('병원 정보가 성공적으로 제출되었습니다!');\n+                    window.location.href = '/hospitals';\n+                } else {\n+                    const errorText = await response.text();\n+                    console.error('제출 실패:', errorText);\n+                    alert('제출에 실패했습니다: ' + errorText);\n+                }\n+            } catch (error) {\n+                console.error('제출 중 오류:', error);\n+                alert('제출 중 오류가 발생했습니다.');\n+            }\n+        });\n+    });\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+  // 잼민이 버전\n+//   document.addEventListener('DOMContentLoaded', function() {\n+//     const submitAllBtn = document.getElementById('submitAllBtn');\n+//     const generalDataForm = document.getElementById('generalDataForm');\n+//     const fileUploadForm = document.getElementById('fileUploadForm'); // fileUploadForm 참조 추가\n+//     const hospitalId = '[[${hospitalForm.hospitalId}]]'; // Thymeleaf 변수 사용\n+\n+//     submitAllBtn.addEventListener('click', async function(event) {\n+//       event.preventDefault(); // 기본 폼 제출 방지\n+\n+//       const formData = new FormData(generalDataForm); // generalDataForm의 데이터로 FormData 초기화\n+//       const fileInput = fileUploadForm.querySelector('#fileInput'); // fileUploadForm에서 fileInput 가져오기\n+//       if (fileInput && fileInput.files && fileInput.files[0]) {\n+//         formData.append('thumbnailImageFile', fileInput.files[0]);\n+//       }\n+\n+//       // 폼 액션 URL 결정\n+//       const actionUrl = hospitalId === 'null' ? '/hospitals/new' : '/hospitals/edit';\n+\n+//       try {\n+//         const response = await fetch(actionUrl, {\n+//                                                     method: 'POST',\n+//                                                     body: formData\n+//                                                 });\n+\n+//         if (response.ok) {\n+//           const result = await response.json(); // 또는 response.text()\n+//           console.log('Submission successful:', result);\n+//           alert('병원 정보가 성공적으로 제출되었습니다!');\n+//           // 성공 후 리다이렉트 또는 다른 작업 수행\n+//           window.location.href = '/hospitals'; // 예시: 병원 목록 페이지로 이동\n+//         } else {\n+//           const errorText = await response.text();\n+//           console.error('Submission failed:', response.status, errorText);\n+//           alert('병원 정보 제출에 실패했습니다: ' + errorText);\n+//         }\n+//       } catch (error) {\n+//         console.error('Error during submission:', error);\n+//         alert('병원 정보 제출 중 오류가 발생했습니다.');\n+//       }\n+//     });\n+//   });\n+</script>\n+\n+\n+    <th:block th:replace=\"~{/fragments/footer :: footer}\"></th:block>\n+    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q\" crossorigin=\"anonymous\"></script>\n+</body>\n+</html>\n\\ No newline at end of file\n"
                },
                {
                    "date": 1751990616672,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -88,9 +88,9 @@\n                     </div>\n                 </form>\n                 <div class=\"d-flex flex-column gap-3\" style=\"flex-grow: 1;\">\n                     <form id=\"checkSpecialForm\" th:object=\"${hospitalForm}\" class=\"d-flex flex-nowrap\">\n-                        <div class=\"form-group d-flex flex-nowrap\">\n+                        <div class=\"form-group d-flex flex-column flex-nowrap\">\n                             <label>진료 과목</label>\n                             <div class=\"checkbox-group\">\n                                 <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n                                     <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\n"
                },
                {
                    "date": 1751990758578,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -87,9 +87,9 @@\n                         </div>\n                     </div>\n                 </form>\n                 <div class=\"d-flex flex-column gap-3\" style=\"flex-grow: 1;\">\n-                    <form id=\"checkSpecialForm\" th:object=\"${hospitalForm}\" class=\"d-flex flex-nowrap\">\n+                    <form id=\"checkSpecialForm\" th:object=\"${hospitalForm}\" class=\"d-flex flex-column flex-nowrap\">\n                         <div class=\"form-group d-flex flex-column flex-nowrap\">\n                             <label>진료 과목</label>\n                             <div class=\"checkbox-group\">\n                                 <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n"
                },
                {
                    "date": 1751991339123,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -149,8 +149,10 @@\n     document.addEventListener('DOMContentLoaded', function () {\n         const submitAllBtn = document.getElementById('submitAllBtn');\n         const imageForm = document.getElementById('imageForm');\n         const generalDataForm = document.getElementById('generalDataForm');\n+        const checkSpecialForm = document.getElementById('checkSpecialForm');\n+        const checkAnimalForm = document.getElementById('checkAnimalForm');\n         // const hospitalId = '[[${hospitalForm.hospitalId}]]';\n         const hospitalId = document.getElementById('hospitalId')?.value;\n         const isNew = !hospitalId || hospitalId === 'null' || hospitalId === '';\n \n@@ -170,613 +172,23 @@\n             event.preventDefault();\n \n             const formData = new FormData();\n \n-            // 1. 일반 입력값 병합\n+            // 1. 일반 데이터 병합\n             const generalFormData = new FormData(generalDataForm);\n             for (const [key, value] of generalFormData.entries()) {\n                 formData.append(key, value);\n             }\n \n-            // 2. 이미지 파일 업로드 및 URL 병합\n-            const imageFileInput = imageForm.querySelector('#fileInput');\n-            if (imageFileInput && imageFileInput.files.length > 0) {\n-                const imageUploadFormData = new FormData();\n-                imageUploadFormData.append('image', imageFileInput.files[0]);\n-\n-                try {\n-                    const uploadResponse = await fetch('/upload/image', {\n-                        method: 'POST',\n-                        headers: {\n-                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n-                        },\n-                        body: imageUploadFormData\n-                    });\n-\n-                    if (uploadResponse.ok) {\n-                        const uploadResult = await uploadResponse.json();\n-                        if (uploadResult.success === 1) {\n-                            formData.append('thumbnailImageUrl', uploadResult.imageUrl);\n-                        } else {\n-                            alert('이미지 업로드 실패: ' + uploadResult.message);\n-                            return; // 이미지 업로드 실패 시 전체 제출 중단\n-                        }\n-                    } else {\n-                        const errorText = await uploadResponse.text();\n-                        console.error('이미지 업로드 실패:', errorText);\n-                        alert('이미지 업로드를 실패하였습니다.');\n-                        return; // 이미지 업로드 실패 시 전체 제출 중단\n-                    }\n-                } catch (error) {\n-                    console.error('이미지 업로드 중 오류:', error);\n-                    alert('이미지 업로드 중 오류가 발생했습니다.');\n-                    return; // 이미지 업로드 실패 시 전체 제출 중단\n-                }\n-            }\n-\n-            // 3. 전송\n-            const actionUrl = isNew ? '/hospitals/new' : '/hospitals/edit';\n-\n-            try {\n-                const response = await fetch(actionUrl, {\n-                    method: 'POST',\n-                    headers: {\n-                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n-                        },\n-                    body: formData\n-                });\n-\n-                if (response.ok) {\n-                    const result = await response.json();\n-                    alert('병원 정보가 성공적으로 제출되었습니다!');\n-                    window.location.href = '/hospitals';\n-                } else {\n-                    const errorText = await response.text();\n-                    console.error('제출 실패:', errorText);\n-                    alert('제출에 실패했습니다: ' + errorText);\n-                }\n-            } catch (error) {\n-                console.error('제출 중 오류:', error);\n-                alert('제출 중 오류가 발생했습니다.');\n-            }\n-        });\n-    });\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-  // 잼민이 버전\n-//   document.addEventListener('DOMContentLoaded', function() {\n-//     const submitAllBtn = document.getElementById('submitAllBtn');\n-//     const generalDataForm = document.getElementById('generalDataForm');\n-//     const fileUploadForm = document.getElementById('fileUploadForm'); // fileUploadForm 참조 추가\n-//     const hospitalId = '[[${hospitalForm.hospitalId}]]'; // Thymeleaf 변수 사용\n-\n-//     submitAllBtn.addEventListener('click', async function(event) {\n-//       event.preventDefault(); // 기본 폼 제출 방지\n-\n-//       const formData = new FormData(generalDataForm); // generalDataForm의 데이터로 FormData 초기화\n-//       const fileInput = fileUploadForm.querySelector('#fileInput'); // fileUploadForm에서 fileInput 가져오기\n-//       if (fileInput && fileInput.files && fileInput.files[0]) {\n-//         formData.append('thumbnailImageFile', fileInput.files[0]);\n-//       }\n-\n-//       // 폼 액션 URL 결정\n-//       const actionUrl = hospitalId === 'null' ? '/hospitals/new' : '/hospitals/edit';\n-\n-//       try {\n-//         const response = await fetch(actionUrl, {\n-//                                                     method: 'POST',\n-//                                                     body: formData\n-//                                                 });\n-\n-//         if (response.ok) {\n-//           const result = await response.json(); // 또는 response.text()\n-//           console.log('Submission successful:', result);\n-//           alert('병원 정보가 성공적으로 제출되었습니다!');\n-//           // 성공 후 리다이렉트 또는 다른 작업 수행\n-//           window.location.href = '/hospitals'; // 예시: 병원 목록 페이지로 이동\n-//         } else {\n-//           const errorText = await response.text();\n-//           console.error('Submission failed:', response.status, errorText);\n-//           alert('병원 정보 제출에 실패했습니다: ' + errorText);\n-//         }\n-//       } catch (error) {\n-//         console.error('Error during submission:', error);\n-//         alert('병원 정보 제출 중 오류가 발생했습니다.');\n-//       }\n-//     });\n-//   });\n-</script>\n-\n-\n-    <th:block th:replace=\"~{/fragments/footer :: footer}\"></th:block>\n-    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q\" crossorigin=\"anonymous\"></script>\n-</body>\n-</html>\n-<!DOCTYPE html>\n-<html lang=\"ko\" xmlns:th=\"http://www.thymeleaf.org\" xmlns:sec=\"http://www.thymeleaf.org/thymeleaf-extras-springsecurity5\">\n-<head>\n-    <meta charset=\"UTF-8\">\n-    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n-    <meta name=\"_csrf\" th:content=\"${_csrf.token}\" />\n-    <meta name=\"_csrf_header\" th:content=\"${_csrf.headerName}\" />\n-\n-    <title>병원 등록</title>\n-    <!-- Bootstrap CSS -->\n-    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\">\n-    <!-- Font Awesome CSS -->\n-    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css\">\n-    <link rel=\"stylesheet\" th:href=\"@{/css/hospital_style.css}\">\n-</head>\n-<body>\n-    <th:block th:replace=\"~{/fragments/header :: header}\"></th:block>\n-    <div class=\"hospital-main-container\">\n-        <!-- 상단 로고 -->\n-        <div class=\"logo-container\">\n-            <div class=\"logo\">\n-                <img th:src=\"@{/img/hosp_logo.png}\" alt=\"병원 아이콘\" class=\"logo-icon\">\n-            </div>\n-        </div>\n-\n-        <!-- 메인 컨텐츠 -->\n-        <div class=\"main-content d-flex flex-column align-items-center\">\n-                        <!-- Hidden form for multipart file upload  잼민이버전-->\n-            <!-- <form id=\"fileUploadForm\" style=\"display: none;\" enctype=\"multipart/form-data\">\n-                <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" onchange=\"previewImage(event)\">\n-            </form> -->\n-\n-            <!-- 채찍피티 버전 -->\n-            <div class=\"d-flex justify-content-between align-items-start gap-5\">\n-\n-                <form id=\"imageForm\" enctype=\"multipart/form-data\">\n-                    <div class=\"image-upload-section\">\n-                        <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n-                            <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n-                        </div>\n-                        <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" style=\"display: none;\" onchange=\"previewImage(event)\">\n-                    </div>\n-                </form>\n-\n-\n-                <!-- Main form for general data -->\n-                <form id=\"generalDataForm\" th:object=\"${hospitalForm}\">\n-                    <input type=\"hidden\" id=\"hospitalId\" th:field=\"*{hospitalId}\" />\n-                    <!-- <input type=\"hidden\" id=\"csrfTokenGeneral\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" /> -->\n-\n-                    <div class=\"form-container\">\n-                        <!-- <div class=\"image-upload-section\">\n-                            <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n-                                <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n-                            </div>\n-                        </div> -->\n-\n-                        <div class=\"form-section\">\n-                            <div class=\"form-group\">\n-                                <label for=\"name\">병원 이름</label>\n-                                <input type=\"text\" id=\"name\" th:field=\"*{name}\" placeholder=\"병원 이름을 작성하세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"address\">병원 주소</label>\n-                                <input type=\"text\" id=\"address\" th:field=\"*{address}\" placeholder=\"주소를 입력해 주세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"homepage\">홈페이지</label>\n-                                <input type=\"url\" id=\"homepage\" th:field=\"*{homepage}\" placeholder=\"홈페이지 주소를 입력해 주세요\">\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"phone\">대표번호</label>\n-                                <input type=\"tel\" id=\"phone\" th:field=\"*{phone}\" placeholder=\"병원 전화번호를 입력하세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"email\">이메일</label>\n-                                <input type=\"email\" id=\"email\" th:field=\"*{email}\" placeholder=\"이메일 주소를 입력하세요\">\n-                            </div>\n-                            <div class=\"form-group\">\n-                                <label for=\"hosp-introduce\">병원 소개</label>\n-                                <textarea type=\"text\" id=\"hosp-introduce\" th:field=\"*{email}\" placeholder=\"간단한 소개글을 작성해 주세요\" required rows=\"4\" style=\"resize: none;\"></textarea>\n-                            </div>\n-                        </div>\n-                    </div>\n-                </form>\n-                <div class=\"d-flex flex-column gap-3\" style=\"flex-grow: 1;\">\n-                    <form id=\"checkSpecialForm\" th:object=\"${hospitalForm}\" class=\"d-flex flex-nowrap\">\n-                        <div class=\"form-group d-flex flex-nowrap\">\n-                            <label>진료 과목</label>\n-                            <div class=\"checkbox-group\">\n-                                <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n-                                    <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\n-                                    <label th:for=\"'spec-' + ${spec.specialtyId}\" th:text=\"${spec.category}\"></label>\n-                                </div>\n-                            </div>\n-                        </div>\n-                    </form>\n-                    <form id=\"checkAnimalForm\" th:object=\"${hospitalForm}\">\n-                        <div class=\"form-group\">\n-                            <label>진료 가능 동물</label>\n-                            <div class=\"category-group\">\n-                                <label th:each=\"animal : ${animalList}\" class=\"category-item\">\n-                                    <input type=\"checkbox\" name=\"category\" th:field=\"*{animalIds}\" th:value=\"${animal.animalId}\" th:id=\"'animal-' + ${animal.animalId}\">\n-                                    <span th:for=\"'animal-' + ${animal.animalId}\" th:text=\"${animal.species}\"></span>\n-                                </label>\n-                            </div>\n-                        </div>\n-                    </form>\n-                </div>\n-            </div>\n-        </div>\n-\n-            <!-- 삭제 form -->\n-            <div sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">\n-                <form id=\"deleteForm\" th:action=\"@{/hospitals/delete/{id}(id=${hospitalForm.hospitalId})}\" method=\"post\" style=\"display: none;\">\n-                    <input type=\"hidden\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" />\n-                </form>\n-            </div>\n-\n-            <div class=\"d-flex justify-content-center gap-2 mt-4\">\n-                <button type=\"button\" class=\"btn btn-secondary\" onclick=\"history.back()\">취소</button>\n-                <button type=\"button\" id=\"submitAllBtn\" class=\"btn btn-primary\" th:text=\"${hospitalForm.hospitalId != null ? '수정' : '등록'}\"></button>\n-                <button type=\"button\" id=\"deleteBtn\" class=\"btn btn-danger\" sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">삭제</button>\n-            </div>\n-        </div>\n-\n-\n-<script>\n-  function previewImage(event) {\n-    const input = event.target;\n-    const reader = new FileReader();\n-\n-    reader.onload = function () {\n-      const preview = document.getElementById('preview');\n-      preview.src = reader.result;\n-    };\n-\n-    if (input.files && input.files[0]) {\n-      reader.readAsDataURL(input.files[0]);\n-    }\n-  }\n-\n-\n-  // 채찍피티 버전\n-    document.addEventListener('DOMContentLoaded', function () {\n-        const submitAllBtn = document.getElementById('submitAllBtn');\n-        const imageForm = document.getElementById('imageForm');\n-        const generalDataForm = document.getElementById('generalDataForm');\n-        // const hospitalId = '[[${hospitalForm.hospitalId}]]';\n-        const hospitalId = document.getElementById('hospitalId')?.value;\n-        const isNew = !hospitalId || hospitalId === 'null' || hospitalId === '';\n-\n-        const csrfToken = document.querySelector('meta[name=\"_csrf\"]').content;\n-        const csrfHeader = document.querySelector('meta[name=\"_csrf_header\"]').content;\n-\n-        const deleteBtn = document.getElementById('deleteBtn');\n-        if (deleteBtn) {\n-            deleteBtn.addEventListener('click', function() {\n-                if (confirm('정말로 이 병원을 삭제하시겠습니까?')) {\n-                    document.getElementById('deleteForm').submit();\n-                }\n-            });\n-        }\n-\n-        submitAllBtn.addEventListener('click', async function (event) {\n-            event.preventDefault();\n-\n-            const formData = new FormData();\n-\n-            // 1. 일반 입력값 병합\n-            const generalFormData = new FormData(generalDataForm);\n-            for (const [key, value] of generalFormData.entries()) {\n+            // 2. 진료 과목 데이터 병합\n+            const specialFormData = new FormData(checkSpecialForm);\n+            for (const [key, value] of specialFormData.entries()) {\n                 formData.append(key, value);\n             }\n \n-            // 2. 이미지 파일 업로드 및 URL 병합\n-            const imageFileInput = imageForm.querySelector('#fileInput');\n-            if (imageFileInput && imageFileInput.files.length > 0) {\n-                const imageUploadFormData = new FormData();\n-                imageUploadFormData.append('image', imageFileInput.files[0]);\n-\n-                try {\n-                    const uploadResponse = await fetch('/upload/image', {\n-                        method: 'POST',\n-                        headers: {\n-                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n-                        },\n-                        body: imageUploadFormData\n-                    });\n-\n-                    if (uploadResponse.ok) {\n-                        const uploadResult = await uploadResponse.json();\n-                        if (uploadResult.success === 1) {\n-                            formData.append('thumbnailImageUrl', uploadResult.imageUrl);\n-                        } else {\n-                            alert('이미지 업로드 실패: ' + uploadResult.message);\n-                            return; // 이미지 업로드 실패 시 전체 제출 중단\n-                        }\n-                    } else {\n-                        const errorText = await uploadResponse.text();\n-                        console.error('이미지 업로드 실패:', errorText);\n-                        alert('이미지 업로드를 실패하였습니다.');\n-                        return; // 이미지 업로드 실패 시 전체 제출 중단\n-                    }\n-                } catch (error) {\n-                    console.error('이미지 업로드 중 오류:', error);\n-                    alert('이미지 업로드 중 오류가 발생했습니다.');\n-                    return; // 이미지 업로드 실패 시 전체 제출 중단\n-                }\n-            }\n-\n-            // 3. 전송\n-            const actionUrl = isNew ? '/hospitals/new' : '/hospitals/edit';\n-\n-            try {\n-                const response = await fetch(actionUrl, {\n-                    method: 'POST',\n-                    headers: {\n-                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n-                        },\n-                    body: formData\n-                });\n-\n-                if (response.ok) {\n-                    const result = await response.json();\n-                    alert('병원 정보가 성공적으로 제출되었습니다!');\n-                    window.location.href = '/hospitals';\n-                } else {\n-                    const errorText = await response.text();\n-                    console.error('제출 실패:', errorText);\n-                    alert('제출에 실패했습니다: ' + errorText);\n-                }\n-            } catch (error) {\n-                console.error('제출 중 오류:', error);\n-                alert('제출 중 오류가 발생했습니다.');\n-            }\n-        });\n-    });\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-  // 잼민이 버전\n-//   document.addEventListener('DOMContentLoaded', function() {\n-//     const submitAllBtn = document.getElementById('submitAllBtn');\n-//     const generalDataForm = document.getElementById('generalDataForm');\n-//     const fileUploadForm = document.getElementById('fileUploadForm'); // fileUploadForm 참조 추가\n-//     const hospitalId = '[[${hospitalForm.hospitalId}]]'; // Thymeleaf 변수 사용\n-\n-//     submitAllBtn.addEventListener('click', async function(event) {\n-//       event.preventDefault(); // 기본 폼 제출 방지\n-\n-//       const formData = new FormData(generalDataForm); // generalDataForm의 데이터로 FormData 초기화\n-//       const fileInput = fileUploadForm.querySelector('#fileInput'); // fileUploadForm에서 fileInput 가져오기\n-//       if (fileInput && fileInput.files && fileInput.files[0]) {\n-//         formData.append('thumbnailImageFile', fileInput.files[0]);\n-//       }\n-\n-//       // 폼 액션 URL 결정\n-//       const actionUrl = hospitalId === 'null' ? '/hospitals/new' : '/hospitals/edit';\n-\n-//       try {\n-//         const response = await fetch(actionUrl, {\n-//                                                     method: 'POST',\n-//                                                     body: formData\n-//                                                 });\n-\n-//         if (response.ok) {\n-//           const result = await response.json(); // 또는 response.text()\n-//           console.log('Submission successful:', result);\n-//           alert('병원 정보가 성공적으로 제출되었습니다!');\n-//           // 성공 후 리다이렉트 또는 다른 작업 수행\n-//           window.location.href = '/hospitals'; // 예시: 병원 목록 페이지로 이동\n-//         } else {\n-//           const errorText = await response.text();\n-//           console.error('Submission failed:', response.status, errorText);\n-//           alert('병원 정보 제출에 실패했습니다: ' + errorText);\n-//         }\n-//       } catch (error) {\n-//         console.error('Error during submission:', error);\n-//         alert('병원 정보 제출 중 오류가 발생했습니다.');\n-//       }\n-//     });\n-//   });\n-</script>\n-\n-\n-    <th:block th:replace=\"~{/fragments/footer :: footer}\"></th:block>\n-    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q\" crossorigin=\"anonymous\"></script>\n-</body>\n-</html>\n-<!DOCTYPE html>\n-<html lang=\"ko\" xmlns:th=\"http://www.thymeleaf.org\" xmlns:sec=\"http://www.thymeleaf.org/thymeleaf-extras-springsecurity5\">\n-<head>\n-    <meta charset=\"UTF-8\">\n-    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n-    <meta name=\"_csrf\" th:content=\"${_csrf.token}\" />\n-    <meta name=\"_csrf_header\" th:content=\"${_csrf.headerName}\" />\n-\n-    <title>병원 등록</title>\n-    <!-- Bootstrap CSS -->\n-    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\">\n-    <!-- Font Awesome CSS -->\n-    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css\">\n-    <link rel=\"stylesheet\" th:href=\"@{/css/hospital_style.css}\">\n-</head>\n-<body>\n-    <th:block th:replace=\"~{/fragments/header :: header}\"></th:block>\n-    <div class=\"hospital-main-container\">\n-        <!-- 상단 로고 -->\n-        <div class=\"logo-container\">\n-            <div class=\"logo\">\n-                <img th:src=\"@{/img/hosp_logo.png}\" alt=\"병원 아이콘\" class=\"logo-icon\">\n-            </div>\n-        </div>\n-\n-        <!-- 메인 컨텐츠 -->\n-        <div class=\"main-content d-flex flex-column align-items-center\">\n-                        <!-- Hidden form for multipart file upload  잼민이버전-->\n-            <!-- <form id=\"fileUploadForm\" style=\"display: none;\" enctype=\"multipart/form-data\">\n-                <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" onchange=\"previewImage(event)\">\n-            </form> -->\n-\n-            <!-- 채찍피티 버전 -->\n-            <div class=\"d-flex justify-content-between align-items-start gap-5\">\n-\n-                <form id=\"imageForm\" enctype=\"multipart/form-data\">\n-                    <div class=\"image-upload-section\">\n-                        <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n-                            <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n-                        </div>\n-                        <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" style=\"display: none;\" onchange=\"previewImage(event)\">\n-                    </div>\n-                </form>\n-\n-\n-                <!-- Main form for general data -->\n-                <form id=\"generalDataForm\" th:object=\"${hospitalForm}\">\n-                    <input type=\"hidden\" id=\"hospitalId\" th:field=\"*{hospitalId}\" />\n-                    <!-- <input type=\"hidden\" id=\"csrfTokenGeneral\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" /> -->\n-\n-                    <div class=\"form-container\">\n-                        <!-- <div class=\"image-upload-section\">\n-                            <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n-                                <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n-                            </div>\n-                        </div> -->\n-\n-                        <div class=\"form-section\">\n-                            <div class=\"form-group\">\n-                                <label for=\"name\">병원 이름</label>\n-                                <input type=\"text\" id=\"name\" th:field=\"*{name}\" placeholder=\"병원 이름을 작성하세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"address\">병원 주소</label>\n-                                <input type=\"text\" id=\"address\" th:field=\"*{address}\" placeholder=\"주소를 입력해 주세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"homepage\">홈페이지</label>\n-                                <input type=\"url\" id=\"homepage\" th:field=\"*{homepage}\" placeholder=\"홈페이지 주소를 입력해 주세요\">\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"phone\">대표번호</label>\n-                                <input type=\"tel\" id=\"phone\" th:field=\"*{phone}\" placeholder=\"병원 전화번호를 입력하세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"email\">이메일</label>\n-                                <input type=\"email\" id=\"email\" th:field=\"*{email}\" placeholder=\"이메일 주소를 입력하세요\">\n-                            </div>\n-                            <div class=\"form-group\">\n-                                <label for=\"hosp-introduce\">병원 소개</label>\n-                                <textarea type=\"text\" id=\"hosp-introduce\" th:field=\"*{email}\" placeholder=\"간단한 소개글을 작성해 주세요\" required rows=\"4\" style=\"resize: none;\"></textarea>\n-                            </div>\n-                        </div>\n-                    </div>\n-                </form>\n-                <div class=\"d-flex flex-column gap-3\" style=\"flex-grow: 1;\">\n-                    <form id=\"checkSpecialForm\" th:object=\"${hospitalForm}\" class=\"d-flex flex-nowrap\">\n-                        <div class=\"form-group\">\n-                            <label>진료 과목</label>\n-                            <div class=\"checkbox-group\">\n-                                <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n-                                    <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\n-                                    <label th:for=\"'spec-' + ${spec.specialtyId}\" th:text=\"${spec.category}\"></label>\n-                                </div>\n-                            </div>\n-                        </div>\n-                    </form>\n-                    <form id=\"checkAnimalForm\" th:object=\"${hospitalForm}\">\n-                        <div class=\"form-group\">\n-                            <label>진료 가능 동물</label>\n-                            <div class=\"category-group\">\n-                                <label th:each=\"animal : ${animalList}\" class=\"category-item\">\n-                                    <input type=\"checkbox\" name=\"category\" th:field=\"*{animalIds}\" th:value=\"${animal.animalId}\" th:id=\"'animal-' + ${animal.animalId}\">\n-                                    <span th:for=\"'animal-' + ${animal.animalId}\" th:text=\"${animal.species}\"></span>\n-                                </label>\n-                            </div>\n-                        </div>\n-                    </form>\n-                </div>\n-            </div>\n-        </div>\n-\n-            <!-- 삭제 form -->\n-            <div sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">\n-                <form id=\"deleteForm\" th:action=\"@{/hospitals/delete/{id}(id=${hospitalForm.hospitalId})}\" method=\"post\" style=\"display: none;\">\n-                    <input type=\"hidden\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" />\n-                </form>\n-            </div>\n-\n-            <div class=\"d-flex justify-content-center gap-2 mt-4\">\n-                <button type=\"button\" class=\"btn btn-secondary\" onclick=\"history.back()\">취소</button>\n-                <button type=\"button\" id=\"submitAllBtn\" class=\"btn btn-primary\" th:text=\"${hospitalForm.hospitalId != null ? '수정' : '등록'}\"></button>\n-                <button type=\"button\" id=\"deleteBtn\" class=\"btn btn-danger\" sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">삭제</button>\n-            </div>\n-        </div>\n-\n-\n-<script>\n-  function previewImage(event) {\n-    const input = event.target;\n-    const reader = new FileReader();\n-\n-    reader.onload = function () {\n-      const preview = document.getElementById('preview');\n-      preview.src = reader.result;\n-    };\n-\n-    if (input.files && input.files[0]) {\n-      reader.readAsDataURL(input.files[0]);\n-    }\n-  }\n-\n-\n-  // 채찍피티 버전\n-    document.addEventListener('DOMContentLoaded', function () {\n-        const submitAllBtn = document.getElementById('submitAllBtn');\n-        const imageForm = document.getElementById('imageForm');\n-        const generalDataForm = document.getElementById('generalDataForm');\n-        // const hospitalId = '[[${hospitalForm.hospitalId}]]';\n-        const hospitalId = document.getElementById('hospitalId')?.value;\n-        const isNew = !hospitalId || hospitalId === 'null' || hospitalId === '';\n-\n-        const csrfToken = document.querySelector('meta[name=\"_csrf\"]').content;\n-        const csrfHeader = document.querySelector('meta[name=\"_csrf_header\"]').content;\n-\n-        const deleteBtn = document.getElementById('deleteBtn');\n-        if (deleteBtn) {\n-            deleteBtn.addEventListener('click', function() {\n-                if (confirm('정말로 이 병원을 삭제하시겠습니까?')) {\n-                    document.getElementById('deleteForm').submit();\n-                }\n-            });\n-        }\n-\n-        submitAllBtn.addEventListener('click', async function (event) {\n-            event.preventDefault();\n-\n-            const formData = new FormData();\n-\n-            // 1. 일반 입력값 병합\n-            const generalFormData = new FormData(generalDataForm);\n-            for (const [key, value] of generalFormData.entries()) {\n+            // 3. 진료 동물 데이터 병합\n+            const animalFormData = new FormData(checkAnimalForm);\n+            for (const [key, value] of animalFormData.entries()) {\n                 formData.append(key, value);\n             }\n \n             // 2. 이미지 파일 업로드 및 URL 병합\n@@ -899,908 +311,5 @@\n \n     <th:block th:replace=\"~{/fragments/footer :: footer}\"></th:block>\n     <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q\" crossorigin=\"anonymous\"></script>\n </body>\n-</html>\n-<!DOCTYPE html>\n-<html lang=\"ko\" xmlns:th=\"http://www.thymeleaf.org\" xmlns:sec=\"http://www.thymeleaf.org/thymeleaf-extras-springsecurity5\">\n-<head>\n-    <meta charset=\"UTF-8\">\n-    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n-    <meta name=\"_csrf\" th:content=\"${_csrf.token}\" />\n-    <meta name=\"_csrf_header\" th:content=\"${_csrf.headerName}\" />\n-\n-    <title>병원 등록</title>\n-    <!-- Bootstrap CSS -->\n-    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\">\n-    <!-- Font Awesome CSS -->\n-    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css\">\n-    <link rel=\"stylesheet\" th:href=\"@{/css/hospital_style.css}\">\n-</head>\n-<body>\n-    <th:block th:replace=\"~{/fragments/header :: header}\"></th:block>\n-    <div class=\"hospital-main-container\">\n-        <!-- 상단 로고 -->\n-        <div class=\"logo-container\">\n-            <div class=\"logo\">\n-                <img th:src=\"@{/img/hosp_logo.png}\" alt=\"병원 아이콘\" class=\"logo-icon\">\n-            </div>\n-        </div>\n-\n-        <!-- 메인 컨텐츠 -->\n-        <div class=\"main-content d-flex flex-column align-items-center\">\n-                        <!-- Hidden form for multipart file upload  잼민이버전-->\n-            <!-- <form id=\"fileUploadForm\" style=\"display: none;\" enctype=\"multipart/form-data\">\n-                <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" onchange=\"previewImage(event)\">\n-            </form> -->\n-\n-            <!-- 채찍피티 버전 -->\n-            <div class=\"d-flex justify-content-between align-items-start\">\n-\n-                <form id=\"imageForm\" enctype=\"multipart/form-data\">\n-                    <div class=\"image-upload-section\">\n-                        <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n-                            <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n-                        </div>\n-                        <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" style=\"display: none;\" onchange=\"previewImage(event)\">\n-                    </div>\n-                </form>\n-\n-\n-                <!-- Main form for general data -->\n-                <form id=\"generalDataForm\" th:object=\"${hospitalForm}\">\n-                    <input type=\"hidden\" id=\"hospitalId\" th:field=\"*{hospitalId}\" />\n-                    <!-- <input type=\"hidden\" id=\"csrfTokenGeneral\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" /> -->\n-\n-                    <div class=\"form-container\">\n-                        <!-- <div class=\"image-upload-section\">\n-                            <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n-                                <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n-                            </div>\n-                        </div> -->\n-\n-                        <div class=\"form-section\">\n-                            <div class=\"form-group\">\n-                                <label for=\"name\">병원 이름</label>\n-                                <input type=\"text\" id=\"name\" th:field=\"*{name}\" placeholder=\"병원 이름을 작성하세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"address\">병원 주소</label>\n-                                <input type=\"text\" id=\"address\" th:field=\"*{address}\" placeholder=\"주소를 입력해 주세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"homepage\">홈페이지</label>\n-                                <input type=\"url\" id=\"homepage\" th:field=\"*{homepage}\" placeholder=\"홈페이지 주소를 입력해 주세요\">\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"phone\">대표번호</label>\n-                                <input type=\"tel\" id=\"phone\" th:field=\"*{phone}\" placeholder=\"병원 전화번호를 입력하세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"email\">이메일</label>\n-                                <input type=\"email\" id=\"email\" th:field=\"*{email}\" placeholder=\"이메일 주소를 입력하세요\">\n-                            </div>\n-                            <div class=\"form-group\">\n-                                <label for=\"hosp-introduce\">병원 소개</label>\n-                                <textarea type=\"text\" id=\"hosp-introduce\" th:field=\"*{email}\" placeholder=\"간단한 소개글을 작성해 주세요\" required rows=\"4\" style=\"resize: none;\"></textarea>\n-                            </div>\n-                        </div>\n-                    </div>\n-                </form>\n-                <div class=\"d-flex flex-column gap-3\" style=\"flex-grow: 1;\">\n-                    <form id=\"checkSpecialForm\" th:object=\"${hospitalForm}\" class=\"d-flex flex-nowrap\">\n-                        <div class=\"form-group\">\n-                            <label>진료 과목</label>\n-                            <div class=\"checkbox-group\">\n-                                <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n-                                    <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\n-                                    <label th:for=\"'spec-' + ${spec.specialtyId}\" th:text=\"${spec.category}\"></label>\n-                                </div>\n-                            </div>\n-                        </div>\n-                    </form>\n-                    <form id=\"checkAnimalForm\" th:object=\"${hospitalForm}\">\n-                        <div class=\"form-group\">\n-                            <label>진료 가능 동물</label>\n-                            <div class=\"category-group\">\n-                                <label th:each=\"animal : ${animalList}\" class=\"category-item\">\n-                                    <input type=\"checkbox\" name=\"category\" th:field=\"*{animalIds}\" th:value=\"${animal.animalId}\" th:id=\"'animal-' + ${animal.animalId}\">\n-                                    <span th:for=\"'animal-' + ${animal.animalId}\" th:text=\"${animal.species}\"></span>\n-                                </label>\n-                            </div>\n-                        </div>\n-                    </form>\n-                </div>\n-            </div>\n-        </div>\n-\n-            <!-- 삭제 form -->\n-            <div sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">\n-                <form id=\"deleteForm\" th:action=\"@{/hospitals/delete/{id}(id=${hospitalForm.hospitalId})}\" method=\"post\" style=\"display: none;\">\n-                    <input type=\"hidden\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" />\n-                </form>\n-            </div>\n-\n-            <div class=\"d-flex justify-content-center gap-2 mt-4\">\n-                <button type=\"button\" class=\"btn btn-secondary\" onclick=\"history.back()\">취소</button>\n-                <button type=\"button\" id=\"submitAllBtn\" class=\"btn btn-primary\" th:text=\"${hospitalForm.hospitalId != null ? '수정' : '등록'}\"></button>\n-                <button type=\"button\" id=\"deleteBtn\" class=\"btn btn-danger\" sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">삭제</button>\n-            </div>\n-        </div>\n-\n-\n-<script>\n-  function previewImage(event) {\n-    const input = event.target;\n-    const reader = new FileReader();\n-\n-    reader.onload = function () {\n-      const preview = document.getElementById('preview');\n-      preview.src = reader.result;\n-    };\n-\n-    if (input.files && input.files[0]) {\n-      reader.readAsDataURL(input.files[0]);\n-    }\n-  }\n-\n-\n-  // 채찍피티 버전\n-    document.addEventListener('DOMContentLoaded', function () {\n-        const submitAllBtn = document.getElementById('submitAllBtn');\n-        const imageForm = document.getElementById('imageForm');\n-        const generalDataForm = document.getElementById('generalDataForm');\n-        // const hospitalId = '[[${hospitalForm.hospitalId}]]';\n-        const hospitalId = document.getElementById('hospitalId')?.value;\n-        const isNew = !hospitalId || hospitalId === 'null' || hospitalId === '';\n-\n-        const csrfToken = document.querySelector('meta[name=\"_csrf\"]').content;\n-        const csrfHeader = document.querySelector('meta[name=\"_csrf_header\"]').content;\n-\n-        const deleteBtn = document.getElementById('deleteBtn');\n-        if (deleteBtn) {\n-            deleteBtn.addEventListener('click', function() {\n-                if (confirm('정말로 이 병원을 삭제하시겠습니까?')) {\n-                    document.getElementById('deleteForm').submit();\n-                }\n-            });\n-        }\n-\n-        submitAllBtn.addEventListener('click', async function (event) {\n-            event.preventDefault();\n-\n-            const formData = new FormData();\n-\n-            // 1. 일반 입력값 병합\n-            const generalFormData = new FormData(generalDataForm);\n-            for (const [key, value] of generalFormData.entries()) {\n-                formData.append(key, value);\n-            }\n-\n-            // 2. 이미지 파일 업로드 및 URL 병합\n-            const imageFileInput = imageForm.querySelector('#fileInput');\n-            if (imageFileInput && imageFileInput.files.length > 0) {\n-                const imageUploadFormData = new FormData();\n-                imageUploadFormData.append('image', imageFileInput.files[0]);\n-\n-                try {\n-                    const uploadResponse = await fetch('/upload/image', {\n-                        method: 'POST',\n-                        headers: {\n-                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n-                        },\n-                        body: imageUploadFormData\n-                    });\n-\n-                    if (uploadResponse.ok) {\n-                        const uploadResult = await uploadResponse.json();\n-                        if (uploadResult.success === 1) {\n-                            formData.append('thumbnailImageUrl', uploadResult.imageUrl);\n-                        } else {\n-                            alert('이미지 업로드 실패: ' + uploadResult.message);\n-                            return; // 이미지 업로드 실패 시 전체 제출 중단\n-                        }\n-                    } else {\n-                        const errorText = await uploadResponse.text();\n-                        console.error('이미지 업로드 실패:', errorText);\n-                        alert('이미지 업로드를 실패하였습니다.');\n-                        return; // 이미지 업로드 실패 시 전체 제출 중단\n-                    }\n-                } catch (error) {\n-                    console.error('이미지 업로드 중 오류:', error);\n-                    alert('이미지 업로드 중 오류가 발생했습니다.');\n-                    return; // 이미지 업로드 실패 시 전체 제출 중단\n-                }\n-            }\n-\n-            // 3. 전송\n-            const actionUrl = isNew ? '/hospitals/new' : '/hospitals/edit';\n-\n-            try {\n-                const response = await fetch(actionUrl, {\n-                    method: 'POST',\n-                    headers: {\n-                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n-                        },\n-                    body: formData\n-                });\n-\n-                if (response.ok) {\n-                    const result = await response.json();\n-                    alert('병원 정보가 성공적으로 제출되었습니다!');\n-                    window.location.href = '/hospitals';\n-                } else {\n-                    const errorText = await response.text();\n-                    console.error('제출 실패:', errorText);\n-                    alert('제출에 실패했습니다: ' + errorText);\n-                }\n-            } catch (error) {\n-                console.error('제출 중 오류:', error);\n-                alert('제출 중 오류가 발생했습니다.');\n-            }\n-        });\n-    });\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-  // 잼민이 버전\n-//   document.addEventListener('DOMContentLoaded', function() {\n-//     const submitAllBtn = document.getElementById('submitAllBtn');\n-//     const generalDataForm = document.getElementById('generalDataForm');\n-//     const fileUploadForm = document.getElementById('fileUploadForm'); // fileUploadForm 참조 추가\n-//     const hospitalId = '[[${hospitalForm.hospitalId}]]'; // Thymeleaf 변수 사용\n-\n-//     submitAllBtn.addEventListener('click', async function(event) {\n-//       event.preventDefault(); // 기본 폼 제출 방지\n-\n-//       const formData = new FormData(generalDataForm); // generalDataForm의 데이터로 FormData 초기화\n-//       const fileInput = fileUploadForm.querySelector('#fileInput'); // fileUploadForm에서 fileInput 가져오기\n-//       if (fileInput && fileInput.files && fileInput.files[0]) {\n-//         formData.append('thumbnailImageFile', fileInput.files[0]);\n-//       }\n-\n-//       // 폼 액션 URL 결정\n-//       const actionUrl = hospitalId === 'null' ? '/hospitals/new' : '/hospitals/edit';\n-\n-//       try {\n-//         const response = await fetch(actionUrl, {\n-//                                                     method: 'POST',\n-//                                                     body: formData\n-//                                                 });\n-\n-//         if (response.ok) {\n-//           const result = await response.json(); // 또는 response.text()\n-//           console.log('Submission successful:', result);\n-//           alert('병원 정보가 성공적으로 제출되었습니다!');\n-//           // 성공 후 리다이렉트 또는 다른 작업 수행\n-//           window.location.href = '/hospitals'; // 예시: 병원 목록 페이지로 이동\n-//         } else {\n-//           const errorText = await response.text();\n-//           console.error('Submission failed:', response.status, errorText);\n-//           alert('병원 정보 제출에 실패했습니다: ' + errorText);\n-//         }\n-//       } catch (error) {\n-//         console.error('Error during submission:', error);\n-//         alert('병원 정보 제출 중 오류가 발생했습니다.');\n-//       }\n-//     });\n-//   });\n-</script>\n-\n-\n-    <th:block th:replace=\"~{/fragments/footer :: footer}\"></th:block>\n-    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q\" crossorigin=\"anonymous\"></script>\n-</body>\n-</html>\n-<!DOCTYPE html>\n-<html lang=\"ko\" xmlns:th=\"http://www.thymeleaf.org\" xmlns:sec=\"http://www.thymeleaf.org/thymeleaf-extras-springsecurity5\">\n-<head>\n-    <meta charset=\"UTF-8\">\n-    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n-    <meta name=\"_csrf\" th:content=\"${_csrf.token}\" />\n-    <meta name=\"_csrf_header\" th:content=\"${_csrf.headerName}\" />\n-\n-    <title>병원 등록</title>\n-    <!-- Bootstrap CSS -->\n-    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\">\n-    <!-- Font Awesome CSS -->\n-    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css\">\n-    <link rel=\"stylesheet\" th:href=\"@{/css/hospital_style.css}\">\n-</head>\n-<body>\n-    <th:block th:replace=\"~{/fragments/header :: header}\"></th:block>\n-    <div class=\"hospital-main-container\">\n-        <!-- 상단 로고 -->\n-        <div class=\"logo-container\">\n-            <div class=\"logo\">\n-                <img th:src=\"@{/img/hosp_logo.png}\" alt=\"병원 아이콘\" class=\"logo-icon\">\n-            </div>\n-        </div>\n-\n-        <!-- 메인 컨텐츠 -->\n-        <div class=\"main-content d-flex flex-column\">\n-                        <!-- Hidden form for multipart file upload  잼민이버전-->\n-            <!-- <form id=\"fileUploadForm\" style=\"display: none;\" enctype=\"multipart/form-data\">\n-                <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" onchange=\"previewImage(event)\">\n-            </form> -->\n-\n-            <!-- 채찍피티 버전 -->\n-            <div class=\"d-flex justify-content-between align-items-start gap-6\">\n-\n-                <form id=\"imageForm\" enctype=\"multipart/form-data\">\n-                    <div class=\"image-upload-section\">\n-                        <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n-                            <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n-                        </div>\n-                        <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" style=\"display: none;\" onchange=\"previewImage(event)\">\n-                    </div>\n-                </form>\n-\n-\n-                <!-- Main form for general data -->\n-                <form id=\"generalDataForm\" th:object=\"${hospitalForm}\">\n-                    <input type=\"hidden\" id=\"hospitalId\" th:field=\"*{hospitalId}\" />\n-                    <!-- <input type=\"hidden\" id=\"csrfTokenGeneral\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" /> -->\n-\n-                    <div class=\"form-container\">\n-                        <!-- <div class=\"image-upload-section\">\n-                            <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n-                                <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n-                            </div>\n-                        </div> -->\n-\n-                        <div class=\"form-section\">\n-                            <div class=\"form-group\">\n-                                <label for=\"name\">병원 이름</label>\n-                                <input type=\"text\" id=\"name\" th:field=\"*{name}\" placeholder=\"병원 이름을 작성하세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"address\">병원 주소</label>\n-                                <input type=\"text\" id=\"address\" th:field=\"*{address}\" placeholder=\"주소를 입력해 주세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"homepage\">홈페이지</label>\n-                                <input type=\"url\" id=\"homepage\" th:field=\"*{homepage}\" placeholder=\"홈페이지 주소를 입력해 주세요\">\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"phone\">대표번호</label>\n-                                <input type=\"tel\" id=\"phone\" th:field=\"*{phone}\" placeholder=\"병원 전화번호를 입력하세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"email\">이메일</label>\n-                                <input type=\"email\" id=\"email\" th:field=\"*{email}\" placeholder=\"이메일 주소를 입력하세요\">\n-                            </div>\n-                            <div class=\"form-group\">\n-                                <label for=\"hosp-introduce\">병원 소개</label>\n-                                <textarea type=\"text\" id=\"hosp-introduce\" th:field=\"*{email}\" placeholder=\"간단한 소개글을 작성해 주세요\" required rows=\"4\" style=\"resize: none;\"></textarea>\n-                            </div>\n-                        </div>\n-                    </div>\n-                </form>\n-                <div class=\"d-flex flex-column gap-3\" style=\"flex-grow: 1;\">\n-                    <form id=\"checkSpecialForm\" th:object=\"${hospitalForm}\" class=\"d-flex flex-nowrap\">\n-                        <div class=\"form-group\">\n-                            <label>진료 과목</label>\n-                            <div class=\"checkbox-group\">\n-                                <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n-                                    <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\n-                                    <label th:for=\"'spec-' + ${spec.specialtyId}\" th:text=\"${spec.category}\"></label>\n-                                </div>\n-                            </div>\n-                        </div>\n-                    </form>\n-                    <form id=\"checkAnimalForm\" th:object=\"${hospitalForm}\">\n-                        <div class=\"form-group\">\n-                            <label>진료 가능 동물</label>\n-                            <div class=\"category-group\">\n-                                <label th:each=\"animal : ${animalList}\" class=\"category-item\">\n-                                    <input type=\"checkbox\" name=\"category\" th:field=\"*{animalIds}\" th:value=\"${animal.animalId}\" th:id=\"'animal-' + ${animal.animalId}\">\n-                                    <span th:for=\"'animal-' + ${animal.animalId}\" th:text=\"${animal.species}\"></span>\n-                                </label>\n-                            </div>\n-                        </div>\n-                    </form>\n-                </div>\n-            </div>\n-        </div>\n-\n-            <!-- 삭제 form -->\n-            <div sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">\n-                <form id=\"deleteForm\" th:action=\"@{/hospitals/delete/{id}(id=${hospitalForm.hospitalId})}\" method=\"post\" style=\"display: none;\">\n-                    <input type=\"hidden\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" />\n-                </form>\n-            </div>\n-\n-            <div class=\"d-flex justify-content-center gap-2 mt-4\">\n-                <button type=\"button\" class=\"btn btn-secondary\" onclick=\"history.back()\">취소</button>\n-                <button type=\"button\" id=\"submitAllBtn\" class=\"btn btn-primary\" th:text=\"${hospitalForm.hospitalId != null ? '수정' : '등록'}\"></button>\n-                <button type=\"button\" id=\"deleteBtn\" class=\"btn btn-danger\" sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">삭제</button>\n-            </div>\n-        </div>\n-\n-\n-<script>\n-  function previewImage(event) {\n-    const input = event.target;\n-    const reader = new FileReader();\n-\n-    reader.onload = function () {\n-      const preview = document.getElementById('preview');\n-      preview.src = reader.result;\n-    };\n-\n-    if (input.files && input.files[0]) {\n-      reader.readAsDataURL(input.files[0]);\n-    }\n-  }\n-\n-\n-  // 채찍피티 버전\n-    document.addEventListener('DOMContentLoaded', function () {\n-        const submitAllBtn = document.getElementById('submitAllBtn');\n-        const imageForm = document.getElementById('imageForm');\n-        const generalDataForm = document.getElementById('generalDataForm');\n-        // const hospitalId = '[[${hospitalForm.hospitalId}]]';\n-        const hospitalId = document.getElementById('hospitalId')?.value;\n-        const isNew = !hospitalId || hospitalId === 'null' || hospitalId === '';\n-\n-        const csrfToken = document.querySelector('meta[name=\"_csrf\"]').content;\n-        const csrfHeader = document.querySelector('meta[name=\"_csrf_header\"]').content;\n-\n-        const deleteBtn = document.getElementById('deleteBtn');\n-        if (deleteBtn) {\n-            deleteBtn.addEventListener('click', function() {\n-                if (confirm('정말로 이 병원을 삭제하시겠습니까?')) {\n-                    document.getElementById('deleteForm').submit();\n-                }\n-            });\n-        }\n-\n-        submitAllBtn.addEventListener('click', async function (event) {\n-            event.preventDefault();\n-\n-            const formData = new FormData();\n-\n-            // 1. 일반 입력값 병합\n-            const generalFormData = new FormData(generalDataForm);\n-            for (const [key, value] of generalFormData.entries()) {\n-                formData.append(key, value);\n-            }\n-\n-            // 2. 이미지 파일 업로드 및 URL 병합\n-            const imageFileInput = imageForm.querySelector('#fileInput');\n-            if (imageFileInput && imageFileInput.files.length > 0) {\n-                const imageUploadFormData = new FormData();\n-                imageUploadFormData.append('image', imageFileInput.files[0]);\n-\n-                try {\n-                    const uploadResponse = await fetch('/upload/image', {\n-                        method: 'POST',\n-                        headers: {\n-                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n-                        },\n-                        body: imageUploadFormData\n-                    });\n-\n-                    if (uploadResponse.ok) {\n-                        const uploadResult = await uploadResponse.json();\n-                        if (uploadResult.success === 1) {\n-                            formData.append('thumbnailImageUrl', uploadResult.imageUrl);\n-                        } else {\n-                            alert('이미지 업로드 실패: ' + uploadResult.message);\n-                            return; // 이미지 업로드 실패 시 전체 제출 중단\n-                        }\n-                    } else {\n-                        const errorText = await uploadResponse.text();\n-                        console.error('이미지 업로드 실패:', errorText);\n-                        alert('이미지 업로드를 실패하였습니다.');\n-                        return; // 이미지 업로드 실패 시 전체 제출 중단\n-                    }\n-                } catch (error) {\n-                    console.error('이미지 업로드 중 오류:', error);\n-                    alert('이미지 업로드 중 오류가 발생했습니다.');\n-                    return; // 이미지 업로드 실패 시 전체 제출 중단\n-                }\n-            }\n-\n-            // 3. 전송\n-            const actionUrl = isNew ? '/hospitals/new' : '/hospitals/edit';\n-\n-            try {\n-                const response = await fetch(actionUrl, {\n-                    method: 'POST',\n-                    headers: {\n-                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n-                        },\n-                    body: formData\n-                });\n-\n-                if (response.ok) {\n-                    const result = await response.json();\n-                    alert('병원 정보가 성공적으로 제출되었습니다!');\n-                    window.location.href = '/hospitals';\n-                } else {\n-                    const errorText = await response.text();\n-                    console.error('제출 실패:', errorText);\n-                    alert('제출에 실패했습니다: ' + errorText);\n-                }\n-            } catch (error) {\n-                console.error('제출 중 오류:', error);\n-                alert('제출 중 오류가 발생했습니다.');\n-            }\n-        });\n-    });\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-  // 잼민이 버전\n-//   document.addEventListener('DOMContentLoaded', function() {\n-//     const submitAllBtn = document.getElementById('submitAllBtn');\n-//     const generalDataForm = document.getElementById('generalDataForm');\n-//     const fileUploadForm = document.getElementById('fileUploadForm'); // fileUploadForm 참조 추가\n-//     const hospitalId = '[[${hospitalForm.hospitalId}]]'; // Thymeleaf 변수 사용\n-\n-//     submitAllBtn.addEventListener('click', async function(event) {\n-//       event.preventDefault(); // 기본 폼 제출 방지\n-\n-//       const formData = new FormData(generalDataForm); // generalDataForm의 데이터로 FormData 초기화\n-//       const fileInput = fileUploadForm.querySelector('#fileInput'); // fileUploadForm에서 fileInput 가져오기\n-//       if (fileInput && fileInput.files && fileInput.files[0]) {\n-//         formData.append('thumbnailImageFile', fileInput.files[0]);\n-//       }\n-\n-//       // 폼 액션 URL 결정\n-//       const actionUrl = hospitalId === 'null' ? '/hospitals/new' : '/hospitals/edit';\n-\n-//       try {\n-//         const response = await fetch(actionUrl, {\n-//                                                     method: 'POST',\n-//                                                     body: formData\n-//                                                 });\n-\n-//         if (response.ok) {\n-//           const result = await response.json(); // 또는 response.text()\n-//           console.log('Submission successful:', result);\n-//           alert('병원 정보가 성공적으로 제출되었습니다!');\n-//           // 성공 후 리다이렉트 또는 다른 작업 수행\n-//           window.location.href = '/hospitals'; // 예시: 병원 목록 페이지로 이동\n-//         } else {\n-//           const errorText = await response.text();\n-//           console.error('Submission failed:', response.status, errorText);\n-//           alert('병원 정보 제출에 실패했습니다: ' + errorText);\n-//         }\n-//       } catch (error) {\n-//         console.error('Error during submission:', error);\n-//         alert('병원 정보 제출 중 오류가 발생했습니다.');\n-//       }\n-//     });\n-//   });\n-</script>\n-\n-\n-    <th:block th:replace=\"~{/fragments/footer :: footer}\"></th:block>\n-    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q\" crossorigin=\"anonymous\"></script>\n-</body>\n-</html>\n-<!DOCTYPE html>\n-<html lang=\"ko\" xmlns:th=\"http://www.thymeleaf.org\" xmlns:sec=\"http://www.thymeleaf.org/thymeleaf-extras-springsecurity5\">\n-<head>\n-    <meta charset=\"UTF-8\">\n-    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n-    <meta name=\"_csrf\" th:content=\"${_csrf.token}\" />\n-    <meta name=\"_csrf_header\" th:content=\"${_csrf.headerName}\" />\n-\n-    <title>병원 등록</title>\n-    <!-- Bootstrap CSS -->\n-    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\">\n-    <!-- Font Awesome CSS -->\n-    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css\">\n-    <link rel=\"stylesheet\" th:href=\"@{/css/hospital_style.css}\">\n-</head>\n-<body>\n-    <th:block th:replace=\"~{/fragments/header :: header}\"></th:block>\n-    <div class=\"hospital-main-container\">\n-        <!-- 상단 로고 -->\n-        <div class=\"logo-container\">\n-            <div class=\"logo\">\n-                <img th:src=\"@{/img/hosp_logo.png}\" alt=\"병원 아이콘\" class=\"logo-icon\">\n-            </div>\n-        </div>\n-\n-        <!-- 메인 컨텐츠 -->\n-        <div class=\"main-content d-flex flex-column align-items-center\">\n-                        <!-- Hidden form for multipart file upload  잼민이버전-->\n-            <!-- <form id=\"fileUploadForm\" style=\"display: none;\" enctype=\"multipart/form-data\">\n-                <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" onchange=\"previewImage(event)\">\n-            </form> -->\n-\n-            <!-- 채찍피티 버전 -->\n-            <div class=\"d-flex justify-content-between align-items-start gap-6\">\n-\n-                <form id=\"imageForm\" enctype=\"multipart/form-data\">\n-                    <div class=\"image-upload-section\">\n-                        <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n-                            <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n-                        </div>\n-                        <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" style=\"display: none;\" onchange=\"previewImage(event)\">\n-                    </div>\n-                </form>\n-\n-\n-                <!-- Main form for general data -->\n-                <form id=\"generalDataForm\" th:object=\"${hospitalForm}\">\n-                    <input type=\"hidden\" id=\"hospitalId\" th:field=\"*{hospitalId}\" />\n-                    <!-- <input type=\"hidden\" id=\"csrfTokenGeneral\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" /> -->\n-\n-                    <div class=\"form-container\">\n-                        <!-- <div class=\"image-upload-section\">\n-                            <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n-                                <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n-                            </div>\n-                        </div> -->\n-\n-                        <div class=\"form-section\">\n-                            <div class=\"form-group\">\n-                                <label for=\"name\">병원 이름</label>\n-                                <input type=\"text\" id=\"name\" th:field=\"*{name}\" placeholder=\"병원 이름을 작성하세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"address\">병원 주소</label>\n-                                <input type=\"text\" id=\"address\" th:field=\"*{address}\" placeholder=\"주소를 입력해 주세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"homepage\">홈페이지</label>\n-                                <input type=\"url\" id=\"homepage\" th:field=\"*{homepage}\" placeholder=\"홈페이지 주소를 입력해 주세요\">\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"phone\">대표번호</label>\n-                                <input type=\"tel\" id=\"phone\" th:field=\"*{phone}\" placeholder=\"병원 전화번호를 입력하세요\" required>\n-                            </div>\n-\n-                            <div class=\"form-group\">\n-                                <label for=\"email\">이메일</label>\n-                                <input type=\"email\" id=\"email\" th:field=\"*{email}\" placeholder=\"이메일 주소를 입력하세요\">\n-                            </div>\n-                            <div class=\"form-group\">\n-                                <label for=\"hosp-introduce\">병원 소개</label>\n-                                <textarea type=\"text\" id=\"hosp-introduce\" th:field=\"*{email}\" placeholder=\"간단한 소개글을 작성해 주세요\" required rows=\"4\" style=\"resize: none;\"></textarea>\n-                            </div>\n-                        </div>\n-                    </div>\n-                </form>\n-                <div class=\"d-flex flex-column gap-3\" style=\"flex-grow: 1;\">\n-                    <form id=\"checkSpecialForm\" th:object=\"${hospitalForm}\" class=\"d-flex flex-nowrap\">\n-                        <div class=\"form-group\">\n-                            <label>진료 과목</label>\n-                            <div class=\"checkbox-group\">\n-                                <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n-                                    <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\n-                                    <label th:for=\"'spec-' + ${spec.specialtyId}\" th:text=\"${spec.category}\"></label>\n-                                </div>\n-                            </div>\n-                        </div>\n-                    </form>\n-                    <form id=\"checkAnimalForm\" th:object=\"${hospitalForm}\">\n-                        <div class=\"form-group\">\n-                            <label>진료 가능 동물</label>\n-                            <div class=\"category-group\">\n-                                <label th:each=\"animal : ${animalList}\" class=\"category-item\">\n-                                    <input type=\"checkbox\" name=\"category\" th:field=\"*{animalIds}\" th:value=\"${animal.animalId}\" th:id=\"'animal-' + ${animal.animalId}\">\n-                                    <span th:for=\"'animal-' + ${animal.animalId}\" th:text=\"${animal.species}\"></span>\n-                                </label>\n-                            </div>\n-                        </div>\n-                    </form>\n-                </div>\n-            </div>\n-        </div>\n-\n-            <!-- 삭제 form -->\n-            <div sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">\n-                <form id=\"deleteForm\" th:action=\"@{/hospitals/delete/{id}(id=${hospitalForm.hospitalId})}\" method=\"post\" style=\"display: none;\">\n-                    <input type=\"hidden\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" />\n-                </form>\n-            </div>\n-\n-            <div class=\"d-flex justify-content-center gap-2 mt-4\">\n-                <button type=\"button\" class=\"btn btn-secondary\" onclick=\"history.back()\">취소</button>\n-                <button type=\"button\" id=\"submitAllBtn\" class=\"btn btn-primary\" th:text=\"${hospitalForm.hospitalId != null ? '수정' : '등록'}\"></button>\n-                <button type=\"button\" id=\"deleteBtn\" class=\"btn btn-danger\" sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">삭제</button>\n-            </div>\n-        </div>\n-\n-\n-<script>\n-  function previewImage(event) {\n-    const input = event.target;\n-    const reader = new FileReader();\n-\n-    reader.onload = function () {\n-      const preview = document.getElementById('preview');\n-      preview.src = reader.result;\n-    };\n-\n-    if (input.files && input.files[0]) {\n-      reader.readAsDataURL(input.files[0]);\n-    }\n-  }\n-\n-\n-  // 채찍피티 버전\n-    document.addEventListener('DOMContentLoaded', function () {\n-        const submitAllBtn = document.getElementById('submitAllBtn');\n-        const imageForm = document.getElementById('imageForm');\n-        const generalDataForm = document.getElementById('generalDataForm');\n-        // const hospitalId = '[[${hospitalForm.hospitalId}]]';\n-        const hospitalId = document.getElementById('hospitalId')?.value;\n-        const isNew = !hospitalId || hospitalId === 'null' || hospitalId === '';\n-\n-        const csrfToken = document.querySelector('meta[name=\"_csrf\"]').content;\n-        const csrfHeader = document.querySelector('meta[name=\"_csrf_header\"]').content;\n-\n-        const deleteBtn = document.getElementById('deleteBtn');\n-        if (deleteBtn) {\n-            deleteBtn.addEventListener('click', function() {\n-                if (confirm('정말로 이 병원을 삭제하시겠습니까?')) {\n-                    document.getElementById('deleteForm').submit();\n-                }\n-            });\n-        }\n-\n-        submitAllBtn.addEventListener('click', async function (event) {\n-            event.preventDefault();\n-\n-            const formData = new FormData();\n-\n-            // 1. 일반 입력값 병합\n-            const generalFormData = new FormData(generalDataForm);\n-            for (const [key, value] of generalFormData.entries()) {\n-                formData.append(key, value);\n-            }\n-\n-            // 2. 이미지 파일 업로드 및 URL 병합\n-            const imageFileInput = imageForm.querySelector('#fileInput');\n-            if (imageFileInput && imageFileInput.files.length > 0) {\n-                const imageUploadFormData = new FormData();\n-                imageUploadFormData.append('image', imageFileInput.files[0]);\n-\n-                try {\n-                    const uploadResponse = await fetch('/upload/image', {\n-                        method: 'POST',\n-                        headers: {\n-                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n-                        },\n-                        body: imageUploadFormData\n-                    });\n-\n-                    if (uploadResponse.ok) {\n-                        const uploadResult = await uploadResponse.json();\n-                        if (uploadResult.success === 1) {\n-                            formData.append('thumbnailImageUrl', uploadResult.imageUrl);\n-                        } else {\n-                            alert('이미지 업로드 실패: ' + uploadResult.message);\n-                            return; // 이미지 업로드 실패 시 전체 제출 중단\n-                        }\n-                    } else {\n-                        const errorText = await uploadResponse.text();\n-                        console.error('이미지 업로드 실패:', errorText);\n-                        alert('이미지 업로드를 실패하였습니다.');\n-                        return; // 이미지 업로드 실패 시 전체 제출 중단\n-                    }\n-                } catch (error) {\n-                    console.error('이미지 업로드 중 오류:', error);\n-                    alert('이미지 업로드 중 오류가 발생했습니다.');\n-                    return; // 이미지 업로드 실패 시 전체 제출 중단\n-                }\n-            }\n-\n-            // 3. 전송\n-            const actionUrl = isNew ? '/hospitals/new' : '/hospitals/edit';\n-\n-            try {\n-                const response = await fetch(actionUrl, {\n-                    method: 'POST',\n-                    headers: {\n-                            [csrfHeader]: csrfToken // CSRF 토큰 헤더 추가\n-                        },\n-                    body: formData\n-                });\n-\n-                if (response.ok) {\n-                    const result = await response.json();\n-                    alert('병원 정보가 성공적으로 제출되었습니다!');\n-                    window.location.href = '/hospitals';\n-                } else {\n-                    const errorText = await response.text();\n-                    console.error('제출 실패:', errorText);\n-                    alert('제출에 실패했습니다: ' + errorText);\n-                }\n-            } catch (error) {\n-                console.error('제출 중 오류:', error);\n-                alert('제출 중 오류가 발생했습니다.');\n-            }\n-        });\n-    });\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-  // 잼민이 버전\n-//   document.addEventListener('DOMContentLoaded', function() {\n-//     const submitAllBtn = document.getElementById('submitAllBtn');\n-//     const generalDataForm = document.getElementById('generalDataForm');\n-//     const fileUploadForm = document.getElementById('fileUploadForm'); // fileUploadForm 참조 추가\n-//     const hospitalId = '[[${hospitalForm.hospitalId}]]'; // Thymeleaf 변수 사용\n-\n-//     submitAllBtn.addEventListener('click', async function(event) {\n-//       event.preventDefault(); // 기본 폼 제출 방지\n-\n-//       const formData = new FormData(generalDataForm); // generalDataForm의 데이터로 FormData 초기화\n-//       const fileInput = fileUploadForm.querySelector('#fileInput'); // fileUploadForm에서 fileInput 가져오기\n-//       if (fileInput && fileInput.files && fileInput.files[0]) {\n-//         formData.append('thumbnailImageFile', fileInput.files[0]);\n-//       }\n-\n-//       // 폼 액션 URL 결정\n-//       const actionUrl = hospitalId === 'null' ? '/hospitals/new' : '/hospitals/edit';\n-\n-//       try {\n-//         const response = await fetch(actionUrl, {\n-//                                                     method: 'POST',\n-//                                                     body: formData\n-//                                                 });\n-\n-//         if (response.ok) {\n-//           const result = await response.json(); // 또는 response.text()\n-//           console.log('Submission successful:', result);\n-//           alert('병원 정보가 성공적으로 제출되었습니다!');\n-//           // 성공 후 리다이렉트 또는 다른 작업 수행\n-//           window.location.href = '/hospitals'; // 예시: 병원 목록 페이지로 이동\n-//         } else {\n-//           const errorText = await response.text();\n-//           console.error('Submission failed:', response.status, errorText);\n-//           alert('병원 정보 제출에 실패했습니다: ' + errorText);\n-//         }\n-//       } catch (error) {\n-//         console.error('Error during submission:', error);\n-//         alert('병원 정보 제출 중 오류가 발생했습니다.');\n-//       }\n-//     });\n-//   });\n-</script>\n-\n-\n-    <th:block th:replace=\"~{/fragments/footer :: footer}\"></th:block>\n-    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q\" crossorigin=\"anonymous\"></script>\n-</body>\n </html>\n\\ No newline at end of file\n"
                },
                {
                    "date": 1751991414379,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -90,8 +90,9 @@\n                 <div class=\"d-flex flex-column gap-3\" style=\"flex-grow: 1;\">\n                     <form id=\"checkSpecialForm\" th:object=\"${hospitalForm}\" class=\"d-flex flex-column flex-nowrap\">\n                         <div class=\"form-group d-flex flex-column flex-nowrap\">\n                             <label>진료 과목</label>\n+                            <!-- TODO : 이 폼 DB 수정할것 외과 내과 안과 치과 네개만 넣자! 이거 수정하려면 다수정해야해.. 힘내 내일의 나야 ㅋ -->\n                             <div class=\"checkbox-group\">\n                                 <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n                                     <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\n                                     <label th:for=\"'spec-' + ${spec.specialtyId}\" th:text=\"${spec.category}\"></label>\n"
                }
            ],
            "date": 1751903779627,
            "name": "Commit-0",
            "content": "<!DOCTYPE html>\n<html lang=\"ko\" xmlns:th=\"http://www.thymeleaf.org\" xmlns:sec=\"http://www.thymeleaf.org/thymeleaf-extras-springsecurity5\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>병원 등록</title>\n    <!-- Bootstrap CSS -->\n    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH\" crossorigin=\"anonymous\">\n    <!-- Font Awesome CSS -->\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css\">\n    <link rel=\"stylesheet\" th:href=\"@{/css/hospital_style.css}\">\n</head>\n<body>\n    <th:block th:replace=\"~{/fragments/header :: header}\"></th:block>\n    <div class=\"hospital-main-container\">\n        <!-- 상단 로고 -->\n        <div class=\"logo-container\">\n            <div class=\"logo\">\n                <img th:src=\"@{/img/hosp_logo.png}\" alt=\"병원 아이콘\" class=\"logo-icon\">\n            </div>\n        </div>\n\n        <!-- 메인 컨텐츠 -->\n        <div class=\"main-content\">\n            <form th:action=\"${hospitalForm.hospitalId == null ? '/hospitals/new' : '/hospitals/edit'}\" method=\"post\" th:object=\"${hospitalForm}\" enctype=\"multipart/form-data\">\n                <input type=\"hidden\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" />\n                <div class=\"form-container\">\n                    <div class=\"image-upload-section\">\n                        <div class=\"image-upload-area\" onclick=\"document.getElementById('fileInput').click();\">\n                                <img id=\"preview\" src=\"/img/default-thumbnail.png\" alt=\"이미지를 업로드하세요\" />\n                            </div>\n                            <input type=\"file\" id=\"fileInput\" name=\"thumbnailImageFile\" accept=\"image/*\" style=\"display: none;\" onchange=\"previewImage(event)\">\n                    </div>\n\n                <div class=\"form-section\">\n\n                        <div class=\"form-group\">\n                            <label for=\"name\">병원 이름</label>\n                            <input type=\"text\" id=\"name\" th:field=\"*{name}\" placeholder=\"병원 이름을 작성하세요\" required>\n                        </div>\n\n                        <div class=\"form-group\">\n                            <label>진료 과목</label>\n                            <div class=\"checkbox-group\">\n                                <div th:each=\"spec : ${specialtyList}\" class=\"checkbox-item\">\n                                    <input type=\"checkbox\" th:field=\"*{specialtyIds}\" th:value=\"${spec.specialtyId}\" th:id=\"'spec-' + ${spec.specialtyId}\">\n                                    <label th:for=\"'spec-' + ${spec.specialtyId}\" th:text=\"${spec.category}\"></label>\n                                </div>\n                            </div>\n                        </div>\n\n                        <div class=\"form-group\">\n                            <label>진료 가능 동물</label>\n                            <div class=\"checkbox-group\">\n                                <div th:each=\"animal : ${animalList}\" class=\"checkbox-item\">\n                                    <input type=\"checkbox\" th:field=\"*{animalIds}\" th:value=\"${animal.animalId}\" th:id=\"'animal-' + ${animal.animalId}\">\n                                    <label th:for=\"'animal-' + ${animal.animalId}\" th:text=\"${animal.species}\"></label>\n                                </div>\n                            </div>\n                        </div>\n\n                        <div class=\"form-group\">\n                            <label for=\"address\">병원 주소</label>\n                            <input type=\"text\" id=\"address\" th:field=\"*{address}\" placeholder=\"주소를 입력해 주세요\" required>\n                        </div>\n\n                        <div class=\"form-group\">\n                            <label for=\"homepage\">홈페이지</label>\n                            <input type=\"url\" id=\"homepage\" th:field=\"*{homepage}\" placeholder=\"홈페이지 주소를 입력해 주세요\">\n                        </div>\n\n                        <div class=\"form-group\">\n                            <label for=\"phone\">대표번호</label>\n                            <input type=\"tel\" id=\"phone\" th:field=\"*{phone}\" placeholder=\"병원 전화번호를 입력하세요\" required>\n                        </div>\n\n                        <div class=\"form-group\">\n                            <label for=\"email\">이메일</label>\n                            <input type=\"email\" id=\"email\" th:field=\"*{email}\" placeholder=\"이메일 주소를 입력하세요\">\n                        </div>\n\n                        <div class=\"form-group\">\n                            <label>카테고리</label>\n                            <div class=\"category-group\">\n                                <label class=\"category-item\">\n                                    <input type=\"checkbox\" name=\"category\" value=\"포유류\">\n                                    <span>포유류</span>\n                                </label>\n                                <label class=\"category-item\">\n                                    <input type=\"checkbox\" name=\"category\" value=\"파충류\">\n                                    <span>파충류</span>\n                                </label>\n                                <label class=\"category-item\">\n                                    <input type=\"checkbox\" name=\"category\" value=\"조류\">\n                                    <span>조류</span>\n                                </label>\n                                <label class=\"category-item\">\n                                    <input type=\"checkbox\" name=\"category\" value=\"절지류\">\n                                    <span>절지류</span>\n                                </label>\n                                <label class=\"category-item\">\n                                    <input type=\"checkbox\" name=\"category\" value=\"설치류\">\n                                    <span>설치류</span>\n                                </label>\n                            </div>\n                        </div>\n\n                        <div class=\"button-group\">\n                            <button type=\"button\" class=\"btn btn-cancel\" onclick=\"history.back()\">취소하기</button>\n                            <button type=\"submit\" class=\"btn btn-submit\" th:text=\"${hospitalForm.hospitalId != null ? '수정하기' : '등록하기'}\"></button>\n                        </div>\n                    </form>\n\n                    <div sec:authorize=\"hasAuthority('ROLE_ADMIN')\" th:if=\"${hospitalForm.hospitalId != null}\">\n                        <form th:action=\"@{/hospitals/delete/{id}(id=${hospitalForm.hospitalId})}\" method=\"post\" onsubmit=\"return confirm('정말로 이 병원을 삭제하시겠습니까?');\" style=\"margin-top: 10px;\">\n                            <input type=\"hidden\" th:name=\"${_csrf.parameterName}\" th:value=\"${_csrf.token}\" />\n                            <button type=\"submit\" class=\"btn btn-danger\">삭제하기</button>\n                        </form>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n\n\n<script>\n  function previewImage(event) {\n    const input = event.target;\n    const reader = new FileReader();\n\n    reader.onload = function () {\n      const preview = document.getElementById('preview');\n      preview.src = reader.result;\n    };\n\n    if (input.files && input.files[0]) {\n      reader.readAsDataURL(input.files[0]);\n    }\n  }\n</script>\n\n\n    <th:block th:replace=\"~{/fragments/footer :: footer}\"></th:block>\n    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q\" crossorigin=\"anonymous\"></script>\n</body>\n</html>"
        }
    ]
}